[0m12:04:02.824652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b579674a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b57984ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b57bb8bc0>]}


============================== 12:04:02.833892 | 03083920-7820-483a-9ff0-425c08187fcd ==============================
[0m12:04:02.833892 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:04:02.836149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:04:02.851694 [info ] [MainThread]: dbt version: 1.9.0
[0m12:04:02.853446 [info ] [MainThread]: python version: 3.12.4
[0m12:04:02.854782 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:04:02.856312 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:04:02.864240 [error] [MainThread]: Encountered an error:
cannot access local variable 'summary_message' where it is not associated with a value
[0m12:04:02.867296 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 414, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/debug.py", line 201, in _load_profile
    profile_names, summary_message = self._choose_profile_names()
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/debug.py", line 276, in _choose_profile_names
    return profiles, summary_message
                     ^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'summary_message' where it is not associated with a value

[0m12:04:02.870502 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.07509056, "process_in_blocks": "0", "process_kernel_time": 0.160177, "process_mem_max_rss": "86976", "process_out_blocks": "1464", "process_user_time": 1.88208}
[0m12:04:02.872673 [debug] [MainThread]: Command `dbt debug` failed at 12:04:02.872455 after 0.08 seconds
[0m12:04:02.874325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b57a4cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b57ab5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b57916180>]}
[0m12:04:02.876035 [debug] [MainThread]: Flushing usage events
[0m12:04:11.346323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:53.710742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1641b81b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163fb65af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163fb66d50>]}


============================== 12:07:53.715864 | b577e5b8-fbf5-495b-97b6-2699e0501882 ==============================
[0m12:07:53.715864 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:07:53.717855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:53.728852 [info ] [MainThread]: dbt version: 1.9.0
[0m12:07:53.733915 [info ] [MainThread]: python version: 3.12.4
[0m12:07:53.736782 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:07:53.741654 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:07:53.861281 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:07:53.863196 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:07:53.864893 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:07:53.866563 [info ] [MainThread]: adapter type: postgres
[0m12:07:53.868974 [info ] [MainThread]: adapter version: 1.9.0
[0m12:07:53.880811 [info ] [MainThread]: Configuration:
[0m12:07:53.882622 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:07:53.884445 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m12:07:53.886205 [info ] [MainThread]: Required dependencies:
[0m12:07:53.888103 [debug] [MainThread]: Executing "git --help"
[0m12:07:53.894755 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:07:53.899588 [debug] [MainThread]: STDERR: "b''"
[0m12:07:53.902767 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:07:53.905237 [info ] [MainThread]: Connection:
[0m12:07:53.907770 [info ] [MainThread]:   host: localhost
[0m12:07:53.912091 [info ] [MainThread]:   port: 5433
[0m12:07:53.915016 [info ] [MainThread]:   user: ingest_user
[0m12:07:53.917445 [info ] [MainThread]:   database: ingest_db
[0m12:07:53.920140 [info ] [MainThread]:   schema: public
[0m12:07:53.923230 [info ] [MainThread]:   connect_timeout: 10
[0m12:07:53.925901 [info ] [MainThread]:   role: None
[0m12:07:53.928107 [info ] [MainThread]:   search_path: None
[0m12:07:53.930108 [info ] [MainThread]:   keepalives_idle: 0
[0m12:07:53.931833 [info ] [MainThread]:   sslmode: None
[0m12:07:53.933728 [info ] [MainThread]:   sslcert: None
[0m12:07:53.941935 [info ] [MainThread]:   sslkey: None
[0m12:07:53.944424 [info ] [MainThread]:   sslrootcert: None
[0m12:07:53.946305 [info ] [MainThread]:   application_name: dbt
[0m12:07:53.948303 [info ] [MainThread]:   retries: 1
[0m12:07:53.950398 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:07:54.041622 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:07:54.074597 [debug] [MainThread]: Using postgres connection "debug"
[0m12:07:54.076265 [debug] [MainThread]: On debug: select 1 as id
[0m12:07:54.077671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:54.079630 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m12:07:54.081117 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:07:54.082432 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:07:54.083682 [debug] [MainThread]: On debug: No close available on handle
[0m12:07:54.085077 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:07:54.086785 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:07:54.088238 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  dbt_project.yml does not parse to a dictionary


[0m12:07:54.089731 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:07:54.092462 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5336589, "process_in_blocks": "0", "process_kernel_time": 0.138829, "process_mem_max_rss": "96456", "process_out_blocks": "24", "process_user_time": 2.459267}
[0m12:07:54.094593 [debug] [MainThread]: Command `dbt debug` failed at 12:07:54.094294 after 0.54 seconds
[0m12:07:54.096590 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:07:54.098292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163edda480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163f10ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163f3e69f0>]}
[0m12:07:54.100201 [debug] [MainThread]: Flushing usage events
[0m12:07:58.777430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:13.709629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98d6d09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98d2a94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98d7eb080>]}


============================== 12:08:13.719824 | 3faad7d2-3447-4226-9341-cc3c88d4bb4b ==============================
[0m12:08:13.719824 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:08:13.723222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:08:13.741913 [info ] [MainThread]: dbt version: 1.9.0
[0m12:08:13.743996 [info ] [MainThread]: python version: 3.12.4
[0m12:08:13.745933 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:08:13.747504 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:08:13.842166 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:08:13.844191 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:08:13.845559 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:08:13.847399 [info ] [MainThread]: adapter type: postgres
[0m12:08:13.848794 [info ] [MainThread]: adapter version: 1.9.0
[0m12:08:13.858879 [info ] [MainThread]: Configuration:
[0m12:08:13.860783 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:08:13.862415 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m12:08:13.864034 [info ] [MainThread]: Required dependencies:
[0m12:08:13.865878 [debug] [MainThread]: Executing "git --help"
[0m12:08:13.869915 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:08:13.873038 [debug] [MainThread]: STDERR: "b''"
[0m12:08:13.874636 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:08:13.877048 [info ] [MainThread]: Connection:
[0m12:08:13.879794 [info ] [MainThread]:   host: localhost
[0m12:08:13.882066 [info ] [MainThread]:   port: 5433
[0m12:08:13.886928 [info ] [MainThread]:   user: ingest_user
[0m12:08:13.888555 [info ] [MainThread]:   database: ingest_db
[0m12:08:13.890653 [info ] [MainThread]:   schema: public
[0m12:08:13.893076 [info ] [MainThread]:   connect_timeout: 10
[0m12:08:13.895510 [info ] [MainThread]:   role: None
[0m12:08:13.897918 [info ] [MainThread]:   search_path: None
[0m12:08:13.900522 [info ] [MainThread]:   keepalives_idle: 0
[0m12:08:13.903003 [info ] [MainThread]:   sslmode: None
[0m12:08:13.905301 [info ] [MainThread]:   sslcert: None
[0m12:08:13.907373 [info ] [MainThread]:   sslkey: None
[0m12:08:13.909164 [info ] [MainThread]:   sslrootcert: None
[0m12:08:13.910901 [info ] [MainThread]:   application_name: dbt
[0m12:08:13.912669 [info ] [MainThread]:   retries: 1
[0m12:08:13.914656 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:08:14.045275 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:08:14.080935 [debug] [MainThread]: Using postgres connection "debug"
[0m12:08:14.082542 [debug] [MainThread]: On debug: select 1 as id
[0m12:08:14.083976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:14.086222 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m12:08:14.088279 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:08:14.089756 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:08:14.090869 [debug] [MainThread]: On debug: No close available on handle
[0m12:08:14.091947 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:08:14.093454 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:08:14.095071 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  dbt_project.yml does not parse to a dictionary


[0m12:08:14.096582 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:08:14.099703 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6775317, "process_in_blocks": "0", "process_kernel_time": 0.122169, "process_mem_max_rss": "96268", "process_out_blocks": "0", "process_user_time": 2.372129}
[0m12:08:14.102429 [debug] [MainThread]: Command `dbt debug` failed at 12:08:14.101971 after 0.68 seconds
[0m12:08:14.104148 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:08:14.105441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98cec45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98d5b9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98cc53950>]}
[0m12:08:14.106963 [debug] [MainThread]: Flushing usage events
[0m12:08:21.196918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:28.007934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff886acff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8883fa4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff886a04bc0>]}


============================== 12:11:28.017380 | 9460c89a-40e2-417d-b9b5-0bea8de6affd ==============================
[0m12:11:28.017380 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:11:28.021479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:11:28.040723 [info ] [MainThread]: dbt version: 1.9.0
[0m12:11:28.044032 [info ] [MainThread]: python version: 3.12.4
[0m12:11:28.048108 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:11:28.050235 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:11:28.177082 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:11:28.179185 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:11:28.181050 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:11:28.183465 [info ] [MainThread]: adapter type: postgres
[0m12:11:28.186962 [info ] [MainThread]: adapter version: 1.9.0
[0m12:11:28.362969 [info ] [MainThread]: Configuration:
[0m12:11:28.365299 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:11:28.367277 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:11:28.368826 [info ] [MainThread]: Required dependencies:
[0m12:11:28.370460 [debug] [MainThread]: Executing "git --help"
[0m12:11:28.374090 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:11:28.376501 [debug] [MainThread]: STDERR: "b''"
[0m12:11:28.378664 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:11:28.380990 [info ] [MainThread]: Connection:
[0m12:11:28.382670 [info ] [MainThread]:   host: localhost
[0m12:11:28.384101 [info ] [MainThread]:   port: 5433
[0m12:11:28.385546 [info ] [MainThread]:   user: ingest_user
[0m12:11:28.387034 [info ] [MainThread]:   database: ingest_db
[0m12:11:28.388655 [info ] [MainThread]:   schema: public
[0m12:11:28.390286 [info ] [MainThread]:   connect_timeout: 10
[0m12:11:28.391927 [info ] [MainThread]:   role: None
[0m12:11:28.393283 [info ] [MainThread]:   search_path: None
[0m12:11:28.395183 [info ] [MainThread]:   keepalives_idle: 0
[0m12:11:28.396926 [info ] [MainThread]:   sslmode: None
[0m12:11:28.398604 [info ] [MainThread]:   sslcert: None
[0m12:11:28.400123 [info ] [MainThread]:   sslkey: None
[0m12:11:28.401592 [info ] [MainThread]:   sslrootcert: None
[0m12:11:28.403129 [info ] [MainThread]:   application_name: dbt
[0m12:11:28.404545 [info ] [MainThread]:   retries: 1
[0m12:11:28.406006 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:11:28.472113 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:11:28.515134 [debug] [MainThread]: Using postgres connection "debug"
[0m12:11:28.518982 [debug] [MainThread]: On debug: select 1 as id
[0m12:11:28.522746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:28.528774 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m12:11:28.535613 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:11:28.540826 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:11:28.548159 [debug] [MainThread]: On debug: No close available on handle
[0m12:11:28.555114 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:11:28.562185 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:11:28.568396 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:11:28.589185 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.7842959, "process_in_blocks": "0", "process_kernel_time": 0.138987, "process_mem_max_rss": "99664", "process_out_blocks": "0", "process_user_time": 2.422354}
[0m12:11:28.594211 [debug] [MainThread]: Command `dbt debug` failed at 12:11:28.593724 after 0.79 seconds
[0m12:11:28.597978 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:11:28.601717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff888530470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff886855fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff886855910>]}
[0m12:11:28.605104 [debug] [MainThread]: Flushing usage events
[0m12:11:30.134054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:42.878265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbee05700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc0571c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbec376b0>]}


============================== 12:11:42.883718 | 4d5ea620-875a-44ab-97c0-f04375da4d36 ==============================
[0m12:11:42.883718 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:11:42.885758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:11:42.900628 [info ] [MainThread]: dbt version: 1.9.0
[0m12:11:42.902393 [info ] [MainThread]: python version: 3.12.4
[0m12:11:42.904087 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:11:42.905912 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:11:42.998739 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:11:43.000730 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:11:43.002616 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:11:43.004230 [info ] [MainThread]: adapter type: postgres
[0m12:11:43.005430 [info ] [MainThread]: adapter version: 1.9.0
[0m12:11:43.203021 [info ] [MainThread]: Configuration:
[0m12:11:43.206272 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:11:43.209508 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:11:43.212393 [info ] [MainThread]: Required dependencies:
[0m12:11:43.214435 [debug] [MainThread]: Executing "git --help"
[0m12:11:43.217745 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:11:43.219905 [debug] [MainThread]: STDERR: "b''"
[0m12:11:43.222150 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:11:43.223622 [info ] [MainThread]: Connection:
[0m12:11:43.225970 [info ] [MainThread]:   host: localhost
[0m12:11:43.228189 [info ] [MainThread]:   port: 5433
[0m12:11:43.230879 [info ] [MainThread]:   user: ingest_user
[0m12:11:43.234719 [info ] [MainThread]:   database: ingest_db
[0m12:11:43.237472 [info ] [MainThread]:   schema: public
[0m12:11:43.239198 [info ] [MainThread]:   connect_timeout: 10
[0m12:11:43.240944 [info ] [MainThread]:   role: None
[0m12:11:43.242600 [info ] [MainThread]:   search_path: None
[0m12:11:43.244291 [info ] [MainThread]:   keepalives_idle: 0
[0m12:11:43.245738 [info ] [MainThread]:   sslmode: None
[0m12:11:43.247585 [info ] [MainThread]:   sslcert: None
[0m12:11:43.249130 [info ] [MainThread]:   sslkey: None
[0m12:11:43.250667 [info ] [MainThread]:   sslrootcert: None
[0m12:11:43.252301 [info ] [MainThread]:   application_name: dbt
[0m12:11:43.253635 [info ] [MainThread]:   retries: 1
[0m12:11:43.255393 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:11:43.324111 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:11:43.368417 [debug] [MainThread]: Using postgres connection "debug"
[0m12:11:43.372761 [debug] [MainThread]: On debug: select 1 as id
[0m12:11:43.377520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:43.385323 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m12:11:43.392077 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:11:43.397810 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:11:43.406246 [debug] [MainThread]: On debug: No close available on handle
[0m12:11:43.410061 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:11:43.413242 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:11:43.416154 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:11:43.424998 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.78194004, "process_in_blocks": "0", "process_kernel_time": 0.178958, "process_mem_max_rss": "99828", "process_out_blocks": "0", "process_user_time": 2.714207}
[0m12:11:43.427875 [debug] [MainThread]: Command `dbt debug` failed at 12:11:43.427599 after 0.79 seconds
[0m12:11:43.430105 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:11:43.432905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbee05700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbe802ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbec36930>]}
[0m12:11:43.435181 [debug] [MainThread]: Flushing usage events
[0m12:11:46.585613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:57.278189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce3f47f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce3d7ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce66ddb20>]}


============================== 12:12:57.289413 | ffdc4d30-6f2d-419a-9db7-45ff89c50420 ==============================
[0m12:12:57.289413 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:12:57.293750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:57.318405 [info ] [MainThread]: dbt version: 1.9.0
[0m12:12:57.321656 [info ] [MainThread]: python version: 3.12.4
[0m12:12:57.325979 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:12:57.330015 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:12:57.438069 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:12:57.440077 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:12:57.441738 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:12:57.443557 [info ] [MainThread]: adapter type: postgres
[0m12:12:57.445134 [info ] [MainThread]: adapter version: 1.9.0
[0m12:12:57.596010 [info ] [MainThread]: Configuration:
[0m12:12:57.598582 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:12:57.600866 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:12:57.602709 [info ] [MainThread]: Required dependencies:
[0m12:12:57.605432 [debug] [MainThread]: Executing "git --help"
[0m12:12:57.608679 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:12:57.610452 [debug] [MainThread]: STDERR: "b''"
[0m12:12:57.612172 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:12:57.613953 [info ] [MainThread]: Connection:
[0m12:12:57.617005 [info ] [MainThread]:   host: postgres_ingest
[0m12:12:57.619375 [info ] [MainThread]:   port: 5433
[0m12:12:57.622228 [info ] [MainThread]:   user: ingest_user
[0m12:12:57.624779 [info ] [MainThread]:   database: ingest_db
[0m12:12:57.626269 [info ] [MainThread]:   schema: public
[0m12:12:57.629053 [info ] [MainThread]:   connect_timeout: 10
[0m12:12:57.631040 [info ] [MainThread]:   role: None
[0m12:12:57.633480 [info ] [MainThread]:   search_path: None
[0m12:12:57.635059 [info ] [MainThread]:   keepalives_idle: 0
[0m12:12:57.638610 [info ] [MainThread]:   sslmode: None
[0m12:12:57.640429 [info ] [MainThread]:   sslcert: None
[0m12:12:57.642442 [info ] [MainThread]:   sslkey: None
[0m12:12:57.644670 [info ] [MainThread]:   sslrootcert: None
[0m12:12:57.646223 [info ] [MainThread]:   application_name: dbt
[0m12:12:57.647595 [info ] [MainThread]:   retries: 1
[0m12:12:57.649568 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:12:57.721816 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:12:57.753239 [debug] [MainThread]: Using postgres connection "debug"
[0m12:12:57.756696 [debug] [MainThread]: On debug: select 1 as id
[0m12:12:57.758719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:57.762652 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres_ingest" (172.18.0.3), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m12:12:57.765452 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:12:57.766833 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:12:57.768472 [debug] [MainThread]: On debug: No close available on handle
[0m12:12:57.769866 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:12:57.771845 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:12:57.774065 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "postgres_ingest" (172.18.0.3), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:12:57.779868 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.7573964, "process_in_blocks": "0", "process_kernel_time": 0.150052, "process_mem_max_rss": "99704", "process_out_blocks": "0", "process_user_time": 2.310805}
[0m12:12:57.782013 [debug] [MainThread]: Command `dbt debug` failed at 12:12:57.781834 after 0.76 seconds
[0m12:12:57.783636 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:12:57.785658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce3a4f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce43a67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbce3d35130>]}
[0m12:12:57.787241 [debug] [MainThread]: Flushing usage events
[0m12:12:59.324786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:56.984499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94e133680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94dda7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94f7f6900>]}


============================== 12:13:56.997719 | 7f5cf886-50ea-4ca7-8e14-5d9f95c2ab7c ==============================
[0m12:13:56.997719 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:13:57.002699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:13:57.023187 [info ] [MainThread]: dbt version: 1.9.0
[0m12:13:57.026026 [info ] [MainThread]: python version: 3.12.4
[0m12:13:57.027706 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:13:57.029307 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:13:57.133065 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:13:57.135050 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:13:57.137282 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:13:57.139771 [info ] [MainThread]: adapter type: postgres
[0m12:13:57.141598 [info ] [MainThread]: adapter version: 1.9.0
[0m12:13:57.318049 [info ] [MainThread]: Configuration:
[0m12:13:57.320815 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:13:57.323362 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:13:57.325244 [info ] [MainThread]: Required dependencies:
[0m12:13:57.328488 [debug] [MainThread]: Executing "git --help"
[0m12:13:57.334677 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:13:57.336248 [debug] [MainThread]: STDERR: "b''"
[0m12:13:57.337455 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:13:57.338972 [info ] [MainThread]: Connection:
[0m12:13:57.341760 [info ] [MainThread]:   host: postgres_ingest
[0m12:13:57.343624 [info ] [MainThread]:   port: 5432
[0m12:13:57.345490 [info ] [MainThread]:   user: ingest_user
[0m12:13:57.347457 [info ] [MainThread]:   database: ingest_db
[0m12:13:57.349521 [info ] [MainThread]:   schema: public
[0m12:13:57.351727 [info ] [MainThread]:   connect_timeout: 10
[0m12:13:57.353631 [info ] [MainThread]:   role: None
[0m12:13:57.355769 [info ] [MainThread]:   search_path: None
[0m12:13:57.358139 [info ] [MainThread]:   keepalives_idle: 0
[0m12:13:57.360280 [info ] [MainThread]:   sslmode: None
[0m12:13:57.361936 [info ] [MainThread]:   sslcert: None
[0m12:13:57.363876 [info ] [MainThread]:   sslkey: None
[0m12:13:57.365420 [info ] [MainThread]:   sslrootcert: None
[0m12:13:57.367500 [info ] [MainThread]:   application_name: dbt
[0m12:13:57.369302 [info ] [MainThread]:   retries: 1
[0m12:13:57.371274 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:13:57.448535 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:13:57.479968 [debug] [MainThread]: Using postgres connection "debug"
[0m12:13:57.482660 [debug] [MainThread]: On debug: select 1 as id
[0m12:13:57.485213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:57.497642 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m12:13:57.503727 [debug] [MainThread]: On debug: Close
[0m12:13:57.508354 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:13:57.512354 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:13:57.522965 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.87213916, "process_in_blocks": "0", "process_kernel_time": 0.099214, "process_mem_max_rss": "101908", "process_out_blocks": "0", "process_user_time": 2.192643}
[0m12:13:57.526628 [debug] [MainThread]: Command `dbt debug` succeeded at 12:13:57.526180 after 0.88 seconds
[0m12:13:57.529228 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:13:57.531888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94dc18a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94bdb7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd94e30fda0>]}
[0m12:13:57.535101 [debug] [MainThread]: Flushing usage events
[0m12:14:00.256220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:30.852692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fc2e27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fc2e0140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fc5b35c0>]}


============================== 12:17:30.861587 | 449cf8b2-5cd6-4529-ba22-c4c88db60ae7 ==============================
[0m12:17:30.861587 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:17:30.864152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:17:31.153490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '449cf8b2-5cd6-4529-ba22-c4c88db60ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fa575f70>]}
[0m12:17:31.263390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '449cf8b2-5cd6-4529-ba22-c4c88db60ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fa4a4080>]}
[0m12:17:31.266007 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:17:31.336663 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m12:17:31.339801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6546952, "process_in_blocks": "0", "process_kernel_time": 0.110429, "process_mem_max_rss": "93696", "process_out_blocks": "0", "process_user_time": 2.208583}
[0m12:17:31.342089 [debug] [MainThread]: Command `dbt run` failed at 12:17:31.341790 after 0.66 seconds
[0m12:17:31.344199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fc1b06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fa642ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7fbdc7f50>]}
[0m12:17:31.346265 [debug] [MainThread]: Flushing usage events
[0m12:17:32.428091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:53.616700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0931d4b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f093246f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0931904b60>]}


============================== 12:17:53.622062 | 3b4aee90-d394-47d8-a4db-c13414dd1fa0 ==============================
[0m12:17:53.622062 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:17:53.624298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:53.874403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b4aee90-d394-47d8-a4db-c13414dd1fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09321915e0>]}
[0m12:17:53.972970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b4aee90-d394-47d8-a4db-c13414dd1fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09315e3d10>]}
[0m12:17:53.975668 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:17:54.045793 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m12:17:54.048407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5918674, "process_in_blocks": "0", "process_kernel_time": 0.131059, "process_mem_max_rss": "93856", "process_out_blocks": "0", "process_user_time": 2.096952}
[0m12:17:54.051293 [debug] [MainThread]: Command `dbt run` failed at 12:17:54.051101 after 0.60 seconds
[0m12:17:54.053201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0931c3a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09315b7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0932193680>]}
[0m12:17:54.054943 [debug] [MainThread]: Flushing usage events
[0m12:17:55.776412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:14.365150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7522a054f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7522eb1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752449c650>]}


============================== 12:18:14.375022 | e7c3434e-63fb-4241-a0f6-0037964caee9 ==============================
[0m12:18:14.375022 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:18:14.377714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m12:18:14.547723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7c3434e-63fb-4241-a0f6-0037964caee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7522f240e0>]}
[0m12:18:14.566135 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zrn942_8'
[0m12:18:14.567616 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:18:14.927088 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:18:14.936679 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:18:15.336722 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:18:15.437298 [info ] [MainThread]: Updating lock file in file path: /dbt/package-lock.yml
[0m12:18:15.530555 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wcdquekf'
[0m12:18:15.546190 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:18:31.079349 [info ] [MainThread]: Installed from version 1.3.0
[0m12:18:31.089033 [info ] [MainThread]: Up to date!
[0m12:18:31.101659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e7c3434e-63fb-4241-a0f6-0037964caee9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752234b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7522f5eea0>]}
[0m12:18:31.112622 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 16.931217, "process_in_blocks": "0", "process_kernel_time": 0.810563, "process_mem_max_rss": "89332", "process_out_blocks": "176", "process_user_time": 2.087202}
[0m12:18:31.119336 [debug] [MainThread]: Command `dbt deps` succeeded at 12:18:31.118735 after 16.94 seconds
[0m12:18:31.125151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75227dc560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752276a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7522367800>]}
[0m12:18:31.131332 [debug] [MainThread]: Flushing usage events
[0m12:18:34.280419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:10.943931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a415eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a5bc8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a43c4ef0>]}


============================== 12:19:10.949462 | eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f ==============================
[0m12:19:10.949462 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:19:10.951592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:19:11.288457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a4764ad0>]}
[0m12:19:11.385279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a244bcb0>]}
[0m12:19:11.388509 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:19:11.521203 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:19:11.568046 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:19:11.576070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a40fd550>]}
[0m12:19:15.942314 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'green_tripdata_summary_2019' in the 'models' section of file 'models/marts/schema.yml'
[0m12:19:16.399090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a249a3f0>]}
[0m12:19:16.879243 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:19:16.917745 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:19:17.036817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a07d7dd0>]}
[0m12:19:17.043830 [info ] [MainThread]: Found 4 models, 3 data tests, 1 seed, 12 sources, 551 macros
[0m12:19:17.054699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a21c3ad0>]}
[0m12:19:17.071321 [info ] [MainThread]: 
[0m12:19:17.077420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:17.090221 [info ] [MainThread]: 
[0m12:19:17.100462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:19:17.132975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:19:17.188380 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:19:17.190625 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:19:17.192341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:17.203641 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m12:19:17.207978 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:19:17.215505 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:19:17.218537 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:19:17.220954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:17.231285 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m12:19:17.234617 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:19:17.239864 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:19:17.242087 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:19:17.244190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:17.255449 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m12:19:17.258706 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:19:17.261420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now create_ingest_db_public_staging)
[0m12:19:17.263373 [debug] [ThreadPool]: Creating schema "database: "ingest_db"
schema: "public_staging"
"
[0m12:19:17.272263 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_staging"
[0m12:19:17.274331 [debug] [ThreadPool]: On create_ingest_db_public_staging: BEGIN
[0m12:19:17.276279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:17.286047 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:19:17.288544 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_staging"
[0m12:19:17.290157 [debug] [ThreadPool]: On create_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_ingest_db_public_staging"} */
create schema if not exists "public_staging"
[0m12:19:17.299344 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m12:19:17.302539 [debug] [ThreadPool]: On create_ingest_db_public_staging: COMMIT
[0m12:19:17.305200 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_staging"
[0m12:19:17.307799 [debug] [ThreadPool]: On create_ingest_db_public_staging: COMMIT
[0m12:19:17.313405 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m12:19:17.316158 [debug] [ThreadPool]: On create_ingest_db_public_staging: Close
[0m12:19:17.319009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ingest_db_public_staging, now create_ingest_db_public_marts)
[0m12:19:17.320792 [debug] [ThreadPool]: Creating schema "database: "ingest_db"
schema: "public_marts"
"
[0m12:19:17.325336 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_marts"
[0m12:19:17.327245 [debug] [ThreadPool]: On create_ingest_db_public_marts: BEGIN
[0m12:19:17.328744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:17.338657 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:19:17.340929 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_marts"
[0m12:19:17.342891 [debug] [ThreadPool]: On create_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_ingest_db_public_marts"} */
create schema if not exists "public_marts"
[0m12:19:17.345262 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m12:19:17.347224 [debug] [ThreadPool]: On create_ingest_db_public_marts: COMMIT
[0m12:19:17.348693 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_marts"
[0m12:19:17.350515 [debug] [ThreadPool]: On create_ingest_db_public_marts: COMMIT
[0m12:19:17.353751 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m12:19:17.355906 [debug] [ThreadPool]: On create_ingest_db_public_marts: Close
[0m12:19:17.359713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ingest_db_public_marts, now create_ingest_db_public_public)
[0m12:19:17.362562 [debug] [ThreadPool]: Creating schema "database: "ingest_db"
schema: "public_public"
"
[0m12:19:17.366674 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_public"
[0m12:19:17.368341 [debug] [ThreadPool]: On create_ingest_db_public_public: BEGIN
[0m12:19:17.370142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:17.377975 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:19:17.380831 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_public"
[0m12:19:17.382852 [debug] [ThreadPool]: On create_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_ingest_db_public_public"} */
create schema if not exists "public_public"
[0m12:19:17.385514 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:19:17.388401 [debug] [ThreadPool]: On create_ingest_db_public_public: COMMIT
[0m12:19:17.390327 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_public"
[0m12:19:17.392053 [debug] [ThreadPool]: On create_ingest_db_public_public: COMMIT
[0m12:19:17.395990 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m12:19:17.397922 [debug] [ThreadPool]: On create_ingest_db_public_public: Close
[0m12:19:17.402184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ingest_db_public_public, now list_ingest_db_public_staging)
[0m12:19:17.412566 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:19:17.414650 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:19:17.416516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:17.424521 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:19:17.426188 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:19:17.428408 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:19:17.436742 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m12:19:17.440135 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:19:17.442510 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:19:17.445413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m12:19:17.451128 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:19:17.454417 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:19:17.458238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:17.481538 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m12:19:17.488331 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:19:17.494479 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:19:17.510294 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.010 seconds
[0m12:19:17.522235 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:19:17.528741 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:19:17.534476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m12:19:17.552584 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:19:17.556395 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:19:17.560146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:17.578202 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m12:19:17.581683 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:19:17.584888 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:19:17.593756 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m12:19:17.602397 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:19:17.607256 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:19:17.611881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_public)
[0m12:19:17.619327 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m12:19:17.621979 [debug] [ThreadPool]: On list_ingest_db_public_public: BEGIN
[0m12:19:17.624342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:17.638209 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:19:17.641280 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m12:19:17.643934 [debug] [ThreadPool]: On list_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m12:19:17.652768 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m12:19:17.658853 [debug] [ThreadPool]: On list_ingest_db_public_public: ROLLBACK
[0m12:19:17.663480 [debug] [ThreadPool]: On list_ingest_db_public_public: Close
[0m12:19:17.682886 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:17.688951 [debug] [MainThread]: On master: BEGIN
[0m12:19:17.695947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:17.729902 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m12:19:17.733043 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:17.739194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:19:17.810474 [debug] [MainThread]: SQL status: SELECT 12 in 0.065 seconds
[0m12:19:17.818070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a4c87500>]}
[0m12:19:17.820585 [debug] [MainThread]: On master: ROLLBACK
[0m12:19:17.823320 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:17.825652 [debug] [MainThread]: On master: BEGIN
[0m12:19:17.828619 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:19:17.832251 [debug] [MainThread]: On master: COMMIT
[0m12:19:17.834380 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:17.836928 [debug] [MainThread]: On master: COMMIT
[0m12:19:17.839921 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:19:17.842377 [debug] [MainThread]: On master: Close
[0m12:19:17.854557 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata
[0m12:19:17.858725 [info ] [Thread-1 (]: 1 of 4 START sql view model public_public.marts_green_tripdata ................. [RUN]
[0m12:19:17.865385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_public, now model.my_dbt_project.marts_green_tripdata)
[0m12:19:17.868081 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata
[0m12:19:17.882100 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata"
[0m12:19:17.938449 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata
[0m12:19:17.985100 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata"
[0m12:19:18.028934 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata"
[0m12:19:18.030273 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata: BEGIN
[0m12:19:18.031329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:18.038615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:19:18.040704 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata"
[0m12:19:18.042259 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata"} */

  create view "ingest_db"."public_public"."marts_green_tripdata__dbt_tmp"
    
    
  as (
    -- Placeholder SQL file: marts_green_tripdata.sql
  );
[0m12:19:18.045366 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:19:18.047336 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata: ROLLBACK
[0m12:19:18.049700 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata: Close
[0m12:19:18.055372 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata (models/marts/marts_green_tripdata.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata.sql
[0m12:19:18.058902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a01b7d40>]}
[0m12:19:18.061108 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public_public.marts_green_tripdata ........ [[31mERROR[0m in 0.19s]
[0m12:19:18.062645 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata
[0m12:19:18.063899 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata
[0m12:19:18.064557 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata (models/marts/marts_green_tripdata.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata.sql.
[0m12:19:18.065829 [info ] [Thread-1 (]: 2 of 4 START sql view model public_public.staging_green_tripdata ............... [RUN]
[0m12:19:18.068944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.marts_green_tripdata, now model.my_dbt_project.staging_green_tripdata)
[0m12:19:18.070349 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata
[0m12:19:18.076134 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata"
[0m12:19:18.099634 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata
[0m12:19:18.104691 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata"
[0m12:19:18.130361 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata"
[0m12:19:18.132220 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata: BEGIN
[0m12:19:18.133864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:18.150060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:19:18.155261 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata"
[0m12:19:18.160127 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata"} */

  create view "ingest_db"."public_public"."staging_green_tripdata__dbt_tmp"
    
    
  as (
    -- Placeholder SQL file: staging_green_tripdata.sql
  );
[0m12:19:18.164882 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:19:18.167600 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata: ROLLBACK
[0m12:19:18.170322 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata: Close
[0m12:19:18.175743 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata (models/staging/staging_green_tripdata.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata.sql
[0m12:19:18.177970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a218de20>]}
[0m12:19:18.180235 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public_public.staging_green_tripdata ...... [[31mERROR[0m in 0.11s]
[0m12:19:18.182452 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata
[0m12:19:18.184320 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:19:18.184924 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata (models/staging/staging_green_tripdata.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata.sql.
[0m12:19:18.186584 [info ] [Thread-1 (]: 3 of 4 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:19:18.190893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:19:18.193413 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:19:18.200171 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:19:18.220957 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:19:18.227745 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:19:18.249502 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:19:18.251819 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:19:18.254622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:18.264310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:19:18.266755 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:19:18.269792 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }}
)

select * from combined
  );
[0m12:19:18.273332 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                         ^

[0m12:19:18.276349 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m12:19:18.279784 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:19:18.285118 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:19:18.300863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eef5d7d8-1e2d-466e-9c29-d3f3bf9a2f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a1f80f80>]}
[0m12:19:18.304112 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.11s]
[0m12:19:18.306700 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:19:18.309459 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m12:19:18.312051 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:19:18.314141 [info ] [Thread-1 (]: 4 of 4 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m12:19:18.316412 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:19:18.319680 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:18.321486 [debug] [MainThread]: On master: BEGIN
[0m12:19:18.323278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:18.333740 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:19:18.336846 [debug] [MainThread]: On master: COMMIT
[0m12:19:18.339308 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:18.341733 [debug] [MainThread]: On master: COMMIT
[0m12:19:18.344782 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:19:18.347973 [debug] [MainThread]: On master: Close
[0m12:19:18.351446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:18.355225 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m12:19:18.358063 [info ] [MainThread]: 
[0m12:19:18.361559 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m12:19:18.368582 [debug] [MainThread]: Command end result
[0m12:19:18.540953 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:19:18.551079 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:19:18.565686 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:19:18.567195 [info ] [MainThread]: 
[0m12:19:18.568843 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:19:18.570701 [info ] [MainThread]: 
[0m12:19:18.572740 [error] [MainThread]:   Database Error in model marts_green_tripdata (models/marts/marts_green_tripdata.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata.sql
[0m12:19:18.574598 [info ] [MainThread]: 
[0m12:19:18.577053 [error] [MainThread]:   Database Error in model staging_green_tripdata (models/staging/staging_green_tripdata.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata.sql
[0m12:19:18.579655 [info ] [MainThread]: 
[0m12:19:18.583345 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:19:18.585526 [info ] [MainThread]: 
[0m12:19:18.587550 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m12:19:18.591484 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.819527, "process_in_blocks": "0", "process_kernel_time": 0.405558, "process_mem_max_rss": "114376", "process_out_blocks": "112", "process_user_time": 6.316569}
[0m12:19:18.594174 [debug] [MainThread]: Command `dbt run` failed at 12:19:18.593896 after 7.82 seconds
[0m12:19:18.595593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a48bb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a3fe3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a00191c0>]}
[0m12:19:18.596911 [debug] [MainThread]: Flushing usage events
[0m12:19:20.278697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:26.385570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5533e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55436f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb550fcbc0>]}


============================== 12:21:26.408118 | 2eab98cd-c205-4749-91fa-dde3b7022cc7 ==============================
[0m12:21:26.408118 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:21:26.416623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:26.753651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eab98cd-c205-4749-91fa-dde3b7022cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5569f740>]}
[0m12:21:26.836100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eab98cd-c205-4749-91fa-dde3b7022cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb550d1970>]}
[0m12:21:26.838505 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:21:27.033611 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:21:32.845921 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m12:21:32.847133 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/marts/marts_green_tripdata.sql
[0m12:21:32.848245 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models/staging/staging_green_tripdata.sql
[0m12:21:32.987199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eab98cd-c205-4749-91fa-dde3b7022cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb53604110>]}
[0m12:21:33.199552 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:21:33.239964 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:21:33.285672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eab98cd-c205-4749-91fa-dde3b7022cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb531c26c0>]}
[0m12:21:33.288094 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 551 macros
[0m12:21:33.290559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eab98cd-c205-4749-91fa-dde3b7022cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb533de9f0>]}
[0m12:21:33.295689 [info ] [MainThread]: 
[0m12:21:33.297842 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:33.300427 [info ] [MainThread]: 
[0m12:21:33.303289 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:21:33.312529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:21:33.360231 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:21:33.362747 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:21:33.365710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:33.379606 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m12:21:33.383268 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:21:33.389717 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:21:33.391819 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:21:33.393614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:33.401975 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m12:21:33.406663 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:21:33.410266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m12:21:33.418945 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:21:33.422010 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:21:33.426202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:33.438636 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:21:33.441236 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:21:33.442976 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:21:33.447404 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.003 seconds
[0m12:21:33.451111 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:21:33.453247 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:21:33.456449 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m12:21:33.466393 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:21:33.468330 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:21:33.470546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:33.480283 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:21:33.482313 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:21:33.484129 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:21:33.489186 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:21:33.492374 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:21:33.494601 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:21:33.497097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m12:21:33.502972 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:21:33.504977 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:21:33.506835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:33.514420 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:21:33.516299 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:21:33.518097 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:21:33.522230 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:21:33.525568 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:21:33.527860 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:21:33.535770 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:33.537926 [debug] [MainThread]: On master: BEGIN
[0m12:21:33.539494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:33.547564 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:21:33.549550 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:33.551245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:21:33.563324 [debug] [MainThread]: SQL status: SELECT 12 in 0.010 seconds
[0m12:21:33.569394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eab98cd-c205-4749-91fa-dde3b7022cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb536059a0>]}
[0m12:21:33.571264 [debug] [MainThread]: On master: ROLLBACK
[0m12:21:33.573507 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:33.575239 [debug] [MainThread]: On master: BEGIN
[0m12:21:33.577968 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:21:33.580222 [debug] [MainThread]: On master: COMMIT
[0m12:21:33.582629 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:33.585009 [debug] [MainThread]: On master: COMMIT
[0m12:21:33.587255 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:21:33.589371 [debug] [MainThread]: On master: Close
[0m12:21:33.593369 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:21:33.595561 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:21:33.598019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:21:33.600229 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:21:33.616615 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:21:33.644539 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:21:33.694237 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:21:33.716229 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:21:33.718475 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:21:33.720611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:33.728957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:21:33.731124 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:21:33.732992 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }}
)

select * from combined
  );
[0m12:21:33.735654 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                         ^

[0m12:21:33.737643 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m12:21:33.739822 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:21:33.745587 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:21:33.749835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eab98cd-c205-4749-91fa-dde3b7022cc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb55ac2300>]}
[0m12:21:33.752540 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.15s]
[0m12:21:33.755448 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:21:33.757189 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m12:21:33.760072 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:21:33.761320 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m12:21:33.762756 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:21:33.765243 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:33.766578 [debug] [MainThread]: On master: BEGIN
[0m12:21:33.767859 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:33.776966 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:21:33.779093 [debug] [MainThread]: On master: COMMIT
[0m12:21:33.780869 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:33.782471 [debug] [MainThread]: On master: COMMIT
[0m12:21:33.784275 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:21:33.786224 [debug] [MainThread]: On master: Close
[0m12:21:33.787835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:33.788949 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m12:21:33.790235 [info ] [MainThread]: 
[0m12:21:33.792781 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m12:21:33.794827 [debug] [MainThread]: Command end result
[0m12:21:33.893341 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:21:33.914194 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:21:33.952269 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:21:33.958643 [info ] [MainThread]: 
[0m12:21:33.967063 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:21:33.979997 [info ] [MainThread]: 
[0m12:21:33.990246 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:21:33.999794 [info ] [MainThread]: 
[0m12:21:34.006835 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:21:34.015178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.80883, "process_in_blocks": "0", "process_kernel_time": 0.385871, "process_mem_max_rss": "108868", "process_out_blocks": "0", "process_user_time": 3.146339}
[0m12:21:34.022101 [debug] [MainThread]: Command `dbt run` failed at 12:21:34.021328 after 7.82 seconds
[0m12:21:34.026877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5523f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb558f4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb558f4c50>]}
[0m12:21:34.031025 [debug] [MainThread]: Flushing usage events
[0m12:21:35.202289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:36.352548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce7b5ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce6634f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce6a44a70>]}


============================== 12:27:36.358162 | 3338fdaa-e2c6-47c8-9e9a-09950e5a6b4d ==============================
[0m12:27:36.358162 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:27:36.359747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:27:36.375029 [info ] [MainThread]: dbt version: 1.9.0
[0m12:27:36.376388 [info ] [MainThread]: python version: 3.12.4
[0m12:27:36.377494 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:27:36.378441 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:27:36.467951 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:27:36.471635 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:27:36.475181 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:27:36.478272 [info ] [MainThread]: adapter type: postgres
[0m12:27:36.480303 [info ] [MainThread]: adapter version: 1.9.0
[0m12:27:36.803330 [info ] [MainThread]: Configuration:
[0m12:27:36.805528 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:27:36.807487 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:27:36.809017 [info ] [MainThread]: Required dependencies:
[0m12:27:36.810632 [debug] [MainThread]: Executing "git --help"
[0m12:27:36.814400 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:27:36.816314 [debug] [MainThread]: STDERR: "b''"
[0m12:27:36.818554 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:27:36.820356 [info ] [MainThread]: Connection:
[0m12:27:36.822596 [info ] [MainThread]:   host: postgres_ingest
[0m12:27:36.824339 [info ] [MainThread]:   port: 5432
[0m12:27:36.826162 [info ] [MainThread]:   user: ingest_user
[0m12:27:36.827580 [info ] [MainThread]:   database: ingest_db
[0m12:27:36.828831 [info ] [MainThread]:   schema: public
[0m12:27:36.830311 [info ] [MainThread]:   connect_timeout: 10
[0m12:27:36.831805 [info ] [MainThread]:   role: None
[0m12:27:36.833048 [info ] [MainThread]:   search_path: None
[0m12:27:36.835635 [info ] [MainThread]:   keepalives_idle: 0
[0m12:27:36.838080 [info ] [MainThread]:   sslmode: None
[0m12:27:36.840452 [info ] [MainThread]:   sslcert: None
[0m12:27:36.842926 [info ] [MainThread]:   sslkey: None
[0m12:27:36.844619 [info ] [MainThread]:   sslrootcert: None
[0m12:27:36.846531 [info ] [MainThread]:   application_name: dbt
[0m12:27:36.848102 [info ] [MainThread]:   retries: 1
[0m12:27:36.850083 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:27:36.922793 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:27:36.952745 [debug] [MainThread]: Using postgres connection "debug"
[0m12:27:36.954897 [debug] [MainThread]: On debug: select 1 as id
[0m12:27:36.956317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:36.967043 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m12:27:36.969977 [debug] [MainThread]: On debug: Close
[0m12:27:36.972173 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:27:36.974646 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:27:36.980196 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9540821, "process_in_blocks": "0", "process_kernel_time": 0.299429, "process_mem_max_rss": "101996", "process_out_blocks": "0", "process_user_time": 2.934411}
[0m12:27:36.982048 [debug] [MainThread]: Command `dbt debug` succeeded at 12:27:36.981852 after 0.96 seconds
[0m12:27:36.983306 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:27:36.984493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce64d6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce628ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce628cd40>]}
[0m12:27:36.985983 [debug] [MainThread]: Flushing usage events
[0m12:27:38.027847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:53.513693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe254a94c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe255410080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe254a978f0>]}


============================== 12:27:53.519445 | 60200aa8-a6c5-48cd-a163-885a5f5ac29b ==============================
[0m12:27:53.519445 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:27:53.521060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:27:53.788834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60200aa8-a6c5-48cd-a163-885a5f5ac29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe253e7ed20>]}
[0m12:27:53.890007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60200aa8-a6c5-48cd-a163-885a5f5ac29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe253eacf80>]}
[0m12:27:53.892869 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:27:54.032689 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:27:54.238148 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:27:54.240113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60200aa8-a6c5-48cd-a163-885a5f5ac29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25226ba40>]}
[0m12:27:58.977072 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'green_tripdata_summary_2019' in the 'models' section of file 'models/marts/schema.yml'
[0m12:27:59.339722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m12:27:59.369068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60200aa8-a6c5-48cd-a163-885a5f5ac29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25082ce30>]}
[0m12:27:59.684592 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:27:59.776913 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:27:59.913541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60200aa8-a6c5-48cd-a163-885a5f5ac29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe252187e60>]}
[0m12:27:59.916320 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 551 macros
[0m12:27:59.920100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60200aa8-a6c5-48cd-a163-885a5f5ac29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2521f30e0>]}
[0m12:27:59.926825 [info ] [MainThread]: 
[0m12:27:59.929956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:59.932795 [info ] [MainThread]: 
[0m12:27:59.935790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:27:59.949153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:28:00.011695 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:28:00.017126 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:28:00.020206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:00.031252 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m12:28:00.034998 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:28:00.041086 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:28:00.044374 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:28:00.047134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:00.056673 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m12:28:00.059951 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:28:00.064443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m12:28:00.075607 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:28:00.079894 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:28:00.082229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:00.091730 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:28:00.094070 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:28:00.096060 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:28:00.101124 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.003 seconds
[0m12:28:00.105738 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:28:00.109081 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:28:00.112044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m12:28:00.121538 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:28:00.124123 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:28:00.125883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:00.137422 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:28:00.140200 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:28:00.142608 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:28:00.149209 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:28:00.152369 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:28:00.154817 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:28:00.157335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m12:28:00.162035 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:28:00.163978 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:28:00.165668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:00.173204 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:28:00.175427 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:28:00.177896 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:28:00.184023 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:28:00.187764 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:28:00.190496 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:28:00.202998 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:00.205605 [debug] [MainThread]: On master: BEGIN
[0m12:28:00.208761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:00.221806 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:28:00.225064 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:00.228633 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:00.242525 [debug] [MainThread]: SQL status: SELECT 12 in 0.010 seconds
[0m12:28:00.251367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60200aa8-a6c5-48cd-a163-885a5f5ac29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe253d5f200>]}
[0m12:28:00.255289 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:00.260358 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:00.265502 [debug] [MainThread]: On master: BEGIN
[0m12:28:00.272579 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:28:00.277855 [debug] [MainThread]: On master: COMMIT
[0m12:28:00.284302 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:00.289777 [debug] [MainThread]: On master: COMMIT
[0m12:28:00.297111 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:28:00.302974 [debug] [MainThread]: On master: Close
[0m12:28:00.318225 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:28:00.323890 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:28:00.332175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:28:00.344404 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:28:00.383610 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:28:00.424721 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:28:00.518820 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:28:00.555233 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:28:00.558809 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:28:00.562674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:00.590426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m12:28:00.595073 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:28:00.598886 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }}
)

select * from combined
  );
[0m12:28:00.602949 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                         ^

[0m12:28:00.605783 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m12:28:00.608570 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:28:00.615638 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:28:00.620155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60200aa8-a6c5-48cd-a163-885a5f5ac29b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe25235e1e0>]}
[0m12:28:00.627619 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.29s]
[0m12:28:00.632204 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:28:00.635880 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m12:28:00.644132 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:28:00.649660 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m12:28:00.654219 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:28:00.669051 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:00.674374 [debug] [MainThread]: On master: BEGIN
[0m12:28:00.679623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:00.692913 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:28:00.696282 [debug] [MainThread]: On master: COMMIT
[0m12:28:00.698954 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:00.701092 [debug] [MainThread]: On master: COMMIT
[0m12:28:00.703263 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:00.705309 [debug] [MainThread]: On master: Close
[0m12:28:00.708937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:00.713133 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m12:28:00.715359 [info ] [MainThread]: 
[0m12:28:00.721296 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m12:28:00.727598 [debug] [MainThread]: Command end result
[0m12:28:00.966212 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:28:01.043254 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:28:01.119436 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:28:01.129038 [info ] [MainThread]: 
[0m12:28:01.140192 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:28:01.150834 [info ] [MainThread]: 
[0m12:28:01.161143 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:28:01.170092 [info ] [MainThread]: 
[0m12:28:01.179924 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:28:01.195205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.8168364, "process_in_blocks": "0", "process_kernel_time": 0.269722, "process_mem_max_rss": "114684", "process_out_blocks": "0", "process_user_time": 6.603216}
[0m12:28:01.201334 [debug] [MainThread]: Command `dbt run` failed at 12:28:01.201011 after 7.82 seconds
[0m12:28:01.203488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe253e3cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2522e83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe253db21e0>]}
[0m12:28:01.207426 [debug] [MainThread]: Flushing usage events
[0m12:28:02.357337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:37.253533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd478436990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47856cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47828b5f0>]}


============================== 12:29:37.262002 | 2830d34d-302f-4659-94a7-92e0c9e55aa7 ==============================
[0m12:29:37.262002 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:29:37.265570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:37.659500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2830d34d-302f-4659-94a7-92e0c9e55aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd477958bc0>]}
[0m12:29:37.754919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2830d34d-302f-4659-94a7-92e0c9e55aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd477c3b2f0>]}
[0m12:29:37.757248 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:29:37.939012 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:29:44.811508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:44.813064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:44.821964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m12:29:44.904171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2830d34d-302f-4659-94a7-92e0c9e55aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd476135550>]}
[0m12:29:45.352794 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:29:45.383657 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:29:45.468782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2830d34d-302f-4659-94a7-92e0c9e55aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd475cbb710>]}
[0m12:29:45.476016 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 551 macros
[0m12:29:45.484538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2830d34d-302f-4659-94a7-92e0c9e55aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd475c6be00>]}
[0m12:29:45.507447 [info ] [MainThread]: 
[0m12:29:45.515429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:45.523421 [info ] [MainThread]: 
[0m12:29:45.532671 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:45.546398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:29:45.602283 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:29:45.605296 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:29:45.607472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:45.617372 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m12:29:45.621274 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:29:45.627004 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:29:45.629209 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:29:45.631943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:45.649768 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m12:29:45.658642 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:29:45.677931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_staging)
[0m12:29:45.698971 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:29:45.704531 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:29:45.709079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:45.734979 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m12:29:45.741982 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:29:45.749164 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:29:45.769886 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m12:29:45.783084 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:29:45.791492 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:29:45.799456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m12:29:45.819899 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:29:45.827237 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:29:45.835115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:45.872545 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m12:29:45.880597 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:29:45.888809 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:29:45.909294 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m12:29:45.925503 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:29:45.932609 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:29:45.940422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public)
[0m12:29:45.948239 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:29:45.951743 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:29:45.955903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:45.982416 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m12:29:45.989266 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:29:45.994297 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:29:46.009806 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.011 seconds
[0m12:29:46.026044 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:29:46.038420 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:29:46.072449 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:46.076078 [debug] [MainThread]: On master: BEGIN
[0m12:29:46.079818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:46.106526 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m12:29:46.109724 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:46.112787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:29:46.138921 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m12:29:46.144611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2830d34d-302f-4659-94a7-92e0c9e55aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4784370b0>]}
[0m12:29:46.150695 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:46.158891 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:46.164422 [debug] [MainThread]: On master: BEGIN
[0m12:29:46.173311 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:29:46.179437 [debug] [MainThread]: On master: COMMIT
[0m12:29:46.186164 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:46.192784 [debug] [MainThread]: On master: COMMIT
[0m12:29:46.200694 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:29:46.207868 [debug] [MainThread]: On master: Close
[0m12:29:46.227104 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:29:46.236492 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:29:46.250738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:29:46.259353 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:29:46.295668 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:29:46.336608 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:29:46.444815 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:29:46.494671 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:29:46.501932 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:29:46.504853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:46.524765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m12:29:46.531132 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:29:46.536323 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }}
)

select * from combined
  );
[0m12:29:46.541140 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                         ^

[0m12:29:46.544301 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m12:29:46.547588 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:29:46.557314 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:29:46.562299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2830d34d-302f-4659-94a7-92e0c9e55aa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd475cd5580>]}
[0m12:29:46.565166 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.31s]
[0m12:29:46.568437 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:29:46.571352 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m12:29:46.575809 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:29:46.577940 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m12:29:46.580453 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:29:46.586369 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:46.588623 [debug] [MainThread]: On master: BEGIN
[0m12:29:46.590737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:46.601710 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:29:46.603617 [debug] [MainThread]: On master: COMMIT
[0m12:29:46.605100 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:46.606344 [debug] [MainThread]: On master: COMMIT
[0m12:29:46.608289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:46.610059 [debug] [MainThread]: On master: Close
[0m12:29:46.611712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:46.612963 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m12:29:46.614591 [info ] [MainThread]: 
[0m12:29:46.616237 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m12:29:46.620968 [debug] [MainThread]: Command end result
[0m12:29:46.788331 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:29:46.843555 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:29:46.914354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:29:46.921501 [info ] [MainThread]: 
[0m12:29:46.932952 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:29:46.944017 [info ] [MainThread]: 
[0m12:29:46.963763 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:29:46.974413 [info ] [MainThread]: 
[0m12:29:46.992258 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:29:46.997793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.921409, "process_in_blocks": "0", "process_kernel_time": 0.446842, "process_mem_max_rss": "110144", "process_out_blocks": "0", "process_user_time": 3.869248}
[0m12:29:47.000895 [debug] [MainThread]: Command `dbt run` failed at 12:29:47.000526 after 9.92 seconds
[0m12:29:47.003435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4785a8c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4785abdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd47608d670>]}
[0m12:29:47.006499 [debug] [MainThread]: Flushing usage events
[0m12:29:48.229456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:16.004189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffe8414f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffe841280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffe8417f0>]}


============================== 12:32:16.011071 | 05249e94-e655-4238-ab64-b26f541715dd ==============================
[0m12:32:16.011071 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:32:16.012894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:32:16.268629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05249e94-e655-4238-ab64-b26f541715dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffe786b70>]}
[0m12:32:16.357576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05249e94-e655-4238-ab64-b26f541715dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fff3c73b0>]}
[0m12:32:16.359570 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:32:16.472223 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:32:18.560407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:18.563208 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/schema.yml
[0m12:32:18.832012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m12:32:18.858634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05249e94-e655-4238-ab64-b26f541715dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffd01c680>]}
[0m12:32:19.071297 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:32:19.098242 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:32:19.141858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05249e94-e655-4238-ab64-b26f541715dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffcd9f3e0>]}
[0m12:32:19.144829 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 551 macros
[0m12:32:19.146905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05249e94-e655-4238-ab64-b26f541715dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffce3ce90>]}
[0m12:32:19.151688 [info ] [MainThread]: 
[0m12:32:19.154133 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:19.156944 [info ] [MainThread]: 
[0m12:32:19.159699 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:32:19.170005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:32:19.229249 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:32:19.231554 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:32:19.233456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:19.258636 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.025 seconds
[0m12:32:19.270242 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:32:19.282376 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:32:19.287869 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:32:19.293665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:19.316652 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m12:32:19.320329 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:32:19.325299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m12:32:19.336235 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:32:19.337834 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:32:19.339035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:19.347879 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:32:19.349720 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:32:19.351023 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:32:19.355125 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m12:32:19.358557 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:32:19.360298 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:32:19.362110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m12:32:19.370204 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:32:19.371590 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:32:19.372732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:19.379513 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:32:19.381140 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:32:19.382252 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:32:19.385976 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:32:19.388665 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:32:19.390214 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:32:19.391753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m12:32:19.395536 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:32:19.397196 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:32:19.398251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:19.404951 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:32:19.406662 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:32:19.408105 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:32:19.411991 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:32:19.414758 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:32:19.417015 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:32:19.424997 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:19.427249 [debug] [MainThread]: On master: BEGIN
[0m12:32:19.428899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:19.437880 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:32:19.439924 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:19.441720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:32:19.453148 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m12:32:19.456098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05249e94-e655-4238-ab64-b26f541715dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff7e07920>]}
[0m12:32:19.457513 [debug] [MainThread]: On master: ROLLBACK
[0m12:32:19.459133 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:19.460433 [debug] [MainThread]: On master: BEGIN
[0m12:32:19.462230 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:32:19.463804 [debug] [MainThread]: On master: COMMIT
[0m12:32:19.465167 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:19.466732 [debug] [MainThread]: On master: COMMIT
[0m12:32:19.468884 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:32:19.471031 [debug] [MainThread]: On master: Close
[0m12:32:19.475470 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:32:19.478188 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:32:19.480366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:32:19.482413 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:32:19.500111 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:32:19.522173 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:32:19.584027 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:32:19.601970 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:32:19.606060 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:32:19.608583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:19.616824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:32:19.618434 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:32:19.619722 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }}
)

select * from combined
  );
[0m12:32:19.621352 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                         ^

[0m12:32:19.622525 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m12:32:19.624062 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:32:19.629517 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:32:19.633496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05249e94-e655-4238-ab64-b26f541715dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff6405130>]}
[0m12:32:19.636252 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.15s]
[0m12:32:19.639708 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:32:19.643128 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m12:32:19.646281 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:32:19.648381 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m12:32:19.651335 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:32:19.657004 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:19.659327 [debug] [MainThread]: On master: BEGIN
[0m12:32:19.661676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:32:19.684303 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m12:32:19.688574 [debug] [MainThread]: On master: COMMIT
[0m12:32:19.694165 [debug] [MainThread]: Using postgres connection "master"
[0m12:32:19.700509 [debug] [MainThread]: On master: COMMIT
[0m12:32:19.707594 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:32:19.713316 [debug] [MainThread]: On master: Close
[0m12:32:19.717811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:19.720477 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m12:32:19.722574 [info ] [MainThread]: 
[0m12:32:19.725211 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m12:32:19.730457 [debug] [MainThread]: Command end result
[0m12:32:19.823405 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:32:19.839744 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:32:19.864352 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:32:19.870705 [info ] [MainThread]: 
[0m12:32:19.877075 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:32:19.883402 [info ] [MainThread]: 
[0m12:32:19.889957 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:32:19.895941 [info ] [MainThread]: 
[0m12:32:19.902243 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:32:19.908106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.037198, "process_in_blocks": "0", "process_kernel_time": 0.160478, "process_mem_max_rss": "109652", "process_out_blocks": "0", "process_user_time": 3.269755}
[0m12:32:19.912882 [debug] [MainThread]: Command `dbt run` failed at 12:32:19.912176 after 4.04 seconds
[0m12:32:19.916736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffe8425a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffe8417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffce3d730>]}
[0m12:32:19.919714 [debug] [MainThread]: Flushing usage events
[0m12:32:20.959623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:26.641200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3954e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3954d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3954cb00>]}


============================== 12:37:26.658012 | 3daaba80-ac34-4ccf-8c32-69438ba1dfdd ==============================
[0m12:37:26.658012 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:37:26.664380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:26.955591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3daaba80-ac34-4ccf-8c32-69438ba1dfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc39584f20>]}
[0m12:37:27.056308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3daaba80-ac34-4ccf-8c32-69438ba1dfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc38ff7bf0>]}
[0m12:37:27.059029 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:37:27.167918 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:37:27.401970 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:37:27.404485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3daaba80-ac34-4ccf-8c32-69438ba1dfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3954c080>]}
[0m12:37:32.603808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m12:37:32.632791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3daaba80-ac34-4ccf-8c32-69438ba1dfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc35a7c320>]}
[0m12:37:32.821922 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:37:32.871660 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:37:33.012962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3daaba80-ac34-4ccf-8c32-69438ba1dfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc373c5970>]}
[0m12:37:33.025530 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 551 macros
[0m12:37:33.033806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3daaba80-ac34-4ccf-8c32-69438ba1dfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc373874d0>]}
[0m12:37:33.053112 [info ] [MainThread]: 
[0m12:37:33.061695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:33.072808 [info ] [MainThread]: 
[0m12:37:33.082942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:37:33.103356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:37:33.165229 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:37:33.167748 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:37:33.169990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:33.180671 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m12:37:33.185063 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:37:33.194898 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:37:33.199519 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:37:33.204508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:33.241838 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.037 seconds
[0m12:37:33.255682 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:37:33.270910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m12:37:33.297527 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:37:33.303146 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:37:33.317101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:33.338461 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m12:37:33.341503 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:37:33.344983 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:37:33.355782 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m12:37:33.360796 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:37:33.364217 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:37:33.367675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m12:37:33.375256 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:37:33.377255 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:37:33.379140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:33.388360 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:37:33.390406 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:37:33.391960 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:37:33.400951 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m12:37:33.414472 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:37:33.417256 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:37:33.420197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m12:37:33.426128 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:37:33.429389 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:37:33.432886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:33.457860 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m12:37:33.463904 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:37:33.469920 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:37:33.488481 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.013 seconds
[0m12:37:33.513573 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:37:33.521391 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:37:33.580417 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:33.588333 [debug] [MainThread]: On master: BEGIN
[0m12:37:33.595374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:33.631759 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:37:33.640303 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:33.646616 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:33.681170 [debug] [MainThread]: SQL status: SELECT 0 in 0.028 seconds
[0m12:37:33.685686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3daaba80-ac34-4ccf-8c32-69438ba1dfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc34a18bf0>]}
[0m12:37:33.688273 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:33.690952 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:33.693222 [debug] [MainThread]: On master: BEGIN
[0m12:37:33.696342 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:37:33.699279 [debug] [MainThread]: On master: COMMIT
[0m12:37:33.701862 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:33.705126 [debug] [MainThread]: On master: COMMIT
[0m12:37:33.709301 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:37:33.712915 [debug] [MainThread]: On master: Close
[0m12:37:33.727801 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:37:33.735347 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:37:33.743204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:37:33.747573 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:37:33.767486 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:37:33.804977 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:37:33.902253 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:37:33.924443 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:37:33.926391 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:37:33.928450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:33.936886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:37:33.939122 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:37:33.941225 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }} union all select * from {{ source('raw', 'green_tripdata_' ~ var('year')) }}
)

select * from combined
  );
[0m12:37:33.944088 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ var('ye...
                         ^

[0m12:37:33.945663 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m12:37:33.947858 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:37:33.952844 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ var('ye...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:37:33.956743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3daaba80-ac34-4ccf-8c32-69438ba1dfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc35a12780>]}
[0m12:37:33.959840 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.21s]
[0m12:37:33.962260 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:37:33.964738 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ var('ye...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m12:37:33.968794 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:37:33.971230 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m12:37:33.973516 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:37:33.977510 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:33.979816 [debug] [MainThread]: On master: BEGIN
[0m12:37:33.982563 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:33.995085 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:37:33.999251 [debug] [MainThread]: On master: COMMIT
[0m12:37:34.001873 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:34.004172 [debug] [MainThread]: On master: COMMIT
[0m12:37:34.007481 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:37:34.010048 [debug] [MainThread]: On master: Close
[0m12:37:34.013086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:34.015058 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m12:37:34.018135 [info ] [MainThread]: 
[0m12:37:34.020120 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m12:37:34.023018 [debug] [MainThread]: Command end result
[0m12:37:34.171888 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:37:34.217994 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:37:34.287094 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:37:34.292700 [info ] [MainThread]: 
[0m12:37:34.298324 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:37:34.302362 [info ] [MainThread]: 
[0m12:37:34.306610 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ var('ye...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:37:34.310150 [info ] [MainThread]: 
[0m12:37:34.313617 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:37:34.318683 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.8945904, "process_in_blocks": "0", "process_kernel_time": 0.323278, "process_mem_max_rss": "116420", "process_out_blocks": "0", "process_user_time": 5.586663}
[0m12:37:34.322213 [debug] [MainThread]: Command `dbt run` failed at 12:37:34.321953 after 7.90 seconds
[0m12:37:34.324143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3954cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc39aa6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc359a0fb0>]}
[0m12:37:34.325982 [debug] [MainThread]: Flushing usage events
[0m12:37:35.630503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:05.791079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa056ffe4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa056f9cf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa056fff6b0>]}


============================== 12:40:05.810002 | 23ba6c2c-0952-4baa-a726-22bb68778c28 ==============================
[0m12:40:05.810002 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:40:05.817393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:40:06.177999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23ba6c2c-0952-4baa-a726-22bb68778c28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0588130b0>]}
[0m12:40:06.282513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23ba6c2c-0952-4baa-a726-22bb68778c28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa057ff8d40>]}
[0m12:40:06.284827 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:40:06.410191 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:40:07.658229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:07.659875 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/union_raw_tables.sql
[0m12:40:08.084947 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.staging_green_tripdata_2019_all' (models/staging/staging_green_tripdata_2019_all.sql) depends on a source named 'raw.green_tripdata_2019' which was not found
[0m12:40:08.087882 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.506368, "process_in_blocks": "0", "process_kernel_time": 0.216103, "process_mem_max_rss": "103664", "process_out_blocks": "0", "process_user_time": 3.202267}
[0m12:40:08.089507 [debug] [MainThread]: Command `dbt run` failed at 12:40:08.089313 after 2.51 seconds
[0m12:40:08.091185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa056f2fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa054df7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0540b4a10>]}
[0m12:40:08.092726 [debug] [MainThread]: Flushing usage events
[0m12:40:09.079749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:47.662816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e285f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e228dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e228ef00>]}


============================== 12:41:47.667839 | bed038a6-6d7d-4aa2-81e0-b855645f5ad1 ==============================
[0m12:41:47.667839 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:41:47.670132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:41:47.953825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bed038a6-6d7d-4aa2-81e0-b855645f5ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e05a7fb0>]}
[0m12:41:48.069911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bed038a6-6d7d-4aa2-81e0-b855645f5ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e1d83950>]}
[0m12:41:48.072975 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:41:48.239821 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:41:48.429743 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:41:48.431319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bed038a6-6d7d-4aa2-81e0-b855645f5ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e0382ab0>]}
[0m12:41:56.351294 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m12:41:56.378644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bed038a6-6d7d-4aa2-81e0-b855645f5ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e02be750>]}
[0m12:41:56.646745 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:41:56.691193 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:41:56.821633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bed038a6-6d7d-4aa2-81e0-b855645f5ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31de930980>]}
[0m12:41:56.839938 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 551 macros
[0m12:41:56.852467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed038a6-6d7d-4aa2-81e0-b855645f5ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e0180440>]}
[0m12:41:56.880314 [info ] [MainThread]: 
[0m12:41:56.889289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:41:56.898292 [info ] [MainThread]: 
[0m12:41:56.908193 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:41:56.942677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:41:57.022045 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:41:57.024063 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:41:57.025900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:57.037002 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m12:41:57.040682 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:41:57.045982 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:41:57.047864 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:41:57.049789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:57.060117 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m12:41:57.063655 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:41:57.069439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m12:41:57.080586 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:41:57.082660 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:41:57.085092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:57.095181 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:41:57.097153 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:41:57.099190 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:41:57.104542 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m12:41:57.112593 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:41:57.115268 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:41:57.118755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m12:41:57.133879 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:41:57.135742 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:41:57.137275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:57.147019 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:41:57.149318 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:41:57.154146 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:41:57.166183 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m12:41:57.170340 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:41:57.172964 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:41:57.176671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m12:41:57.186503 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:41:57.189670 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:41:57.192856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:57.214529 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m12:41:57.219614 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:41:57.225474 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:41:57.243864 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m12:41:57.255750 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:41:57.263337 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:41:57.299160 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.305952 [debug] [MainThread]: On master: BEGIN
[0m12:41:57.314534 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:57.352700 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:41:57.359585 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.366681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:41:57.400914 [debug] [MainThread]: SQL status: SELECT 0 in 0.025 seconds
[0m12:41:57.404090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed038a6-6d7d-4aa2-81e0-b855645f5ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e05ef080>]}
[0m12:41:57.405971 [debug] [MainThread]: On master: ROLLBACK
[0m12:41:57.407992 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.410022 [debug] [MainThread]: On master: BEGIN
[0m12:41:57.412429 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:41:57.414273 [debug] [MainThread]: On master: COMMIT
[0m12:41:57.415853 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.417564 [debug] [MainThread]: On master: COMMIT
[0m12:41:57.419286 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:41:57.420976 [debug] [MainThread]: On master: Close
[0m12:41:57.424564 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:41:57.426721 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:41:57.428331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:41:57.429797 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:41:57.443322 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:41:57.463780 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:41:57.514653 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:41:57.541272 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:41:57.543747 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:41:57.546250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:57.556975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m12:41:57.559455 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:41:57.561624 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }}
)

select * from combined
  );
[0m12:41:57.564768 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                         ^

[0m12:41:57.567750 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m12:41:57.570952 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:41:57.579729 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:41:57.586060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed038a6-6d7d-4aa2-81e0-b855645f5ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31de8c23c0>]}
[0m12:41:57.590883 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.16s]
[0m12:41:57.594460 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:41:57.598350 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m12:41:57.604203 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:41:57.608763 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m12:41:57.612791 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:41:57.617231 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.619778 [debug] [MainThread]: On master: BEGIN
[0m12:41:57.622411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:57.633984 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:41:57.637373 [debug] [MainThread]: On master: COMMIT
[0m12:41:57.640467 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.643266 [debug] [MainThread]: On master: COMMIT
[0m12:41:57.646743 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:41:57.650343 [debug] [MainThread]: On master: Close
[0m12:41:57.654336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:57.657415 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m12:41:57.660984 [info ] [MainThread]: 
[0m12:41:57.663246 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m12:41:57.666002 [debug] [MainThread]: Command end result
[0m12:41:57.841233 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:41:57.899103 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:41:57.970704 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:41:57.991878 [info ] [MainThread]: 
[0m12:41:58.001504 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:41:58.010249 [info ] [MainThread]: 
[0m12:41:58.018852 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:41:58.030720 [info ] [MainThread]: 
[0m12:41:58.042286 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:41:58.054227 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.540031, "process_in_blocks": "0", "process_kernel_time": 0.482374, "process_mem_max_rss": "114904", "process_out_blocks": "0", "process_user_time": 5.959336}
[0m12:41:58.063651 [debug] [MainThread]: Command `dbt run` failed at 12:41:58.062521 after 10.55 seconds
[0m12:41:58.069976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e1e40e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31e228ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31de8aa120>]}
[0m12:41:58.074298 [debug] [MainThread]: Flushing usage events
[0m12:41:59.200980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:35.910251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0ebd5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0e9e3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0ebd7860>]}


============================== 12:42:35.917179 | 49462170-434d-4be6-8b4c-e1bdd429ca2d ==============================
[0m12:42:35.917179 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:42:35.920092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:42:35.934799 [info ] [MainThread]: dbt version: 1.9.0
[0m12:42:35.939941 [info ] [MainThread]: python version: 3.12.4
[0m12:42:35.943364 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:42:35.946031 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:42:36.062775 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:42:36.065146 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:42:36.067312 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:42:36.069094 [info ] [MainThread]: adapter type: postgres
[0m12:42:36.070685 [info ] [MainThread]: adapter version: 1.9.0
[0m12:42:36.313561 [info ] [MainThread]: Configuration:
[0m12:42:36.315547 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:42:36.317281 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:42:36.318804 [info ] [MainThread]: Required dependencies:
[0m12:42:36.320309 [debug] [MainThread]: Executing "git --help"
[0m12:42:36.324453 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:42:36.326247 [debug] [MainThread]: STDERR: "b''"
[0m12:42:36.328344 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:42:36.330180 [info ] [MainThread]: Connection:
[0m12:42:36.332185 [info ] [MainThread]:   host: postgres_ingest
[0m12:42:36.333754 [info ] [MainThread]:   port: 5432
[0m12:42:36.335358 [info ] [MainThread]:   user: ingest_user
[0m12:42:36.336837 [info ] [MainThread]:   database: ingest_db
[0m12:42:36.339277 [info ] [MainThread]:   schema: public
[0m12:42:36.341702 [info ] [MainThread]:   connect_timeout: 10
[0m12:42:36.343231 [info ] [MainThread]:   role: None
[0m12:42:36.344563 [info ] [MainThread]:   search_path: None
[0m12:42:36.345994 [info ] [MainThread]:   keepalives_idle: 0
[0m12:42:36.347312 [info ] [MainThread]:   sslmode: None
[0m12:42:36.349120 [info ] [MainThread]:   sslcert: None
[0m12:42:36.350765 [info ] [MainThread]:   sslkey: None
[0m12:42:36.352610 [info ] [MainThread]:   sslrootcert: None
[0m12:42:36.354291 [info ] [MainThread]:   application_name: dbt
[0m12:42:36.355828 [info ] [MainThread]:   retries: 1
[0m12:42:36.357895 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:36.426914 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:42:36.468601 [debug] [MainThread]: Using postgres connection "debug"
[0m12:42:36.470928 [debug] [MainThread]: On debug: select 1 as id
[0m12:42:36.473323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:36.485596 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m12:42:36.489195 [debug] [MainThread]: On debug: Close
[0m12:42:36.491081 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:42:36.492879 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:42:36.499713 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.73605394, "process_in_blocks": "0", "process_kernel_time": 0.130199, "process_mem_max_rss": "101852", "process_out_blocks": "0", "process_user_time": 2.253459}
[0m12:42:36.502381 [debug] [MainThread]: Command `dbt debug` succeeded at 12:42:36.501826 after 0.74 seconds
[0m12:42:36.504191 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:42:36.505622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0ca82120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0ed1a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce0f32dd00>]}
[0m12:42:36.507557 [debug] [MainThread]: Flushing usage events
[0m12:42:37.732791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:48.988089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfa98b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf9f09520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfa98a240>]}


============================== 12:42:48.993090 | 3f8393f4-7107-4630-84f1-22be4cc3d6b7 ==============================
[0m12:42:48.993090 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:42:48.994971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:42:49.008270 [info ] [MainThread]: dbt version: 1.9.0
[0m12:42:49.010911 [info ] [MainThread]: python version: 3.12.4
[0m12:42:49.013827 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:42:49.015694 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:42:49.123607 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:42:49.125370 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:42:49.127365 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:42:49.128999 [info ] [MainThread]: adapter type: postgres
[0m12:42:49.130343 [info ] [MainThread]: adapter version: 1.9.0
[0m12:42:49.331638 [info ] [MainThread]: Configuration:
[0m12:42:49.333822 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:42:49.335644 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:42:49.338036 [info ] [MainThread]: Required dependencies:
[0m12:42:49.340097 [debug] [MainThread]: Executing "git --help"
[0m12:42:49.343937 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:42:49.346002 [debug] [MainThread]: STDERR: "b''"
[0m12:42:49.347424 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:42:49.349552 [info ] [MainThread]: Connection:
[0m12:42:49.352266 [info ] [MainThread]:   host: postgres_ingest
[0m12:42:49.354001 [info ] [MainThread]:   port: 5432
[0m12:42:49.356143 [info ] [MainThread]:   user: ingest_user
[0m12:42:49.357649 [info ] [MainThread]:   database: ingest_db
[0m12:42:49.359315 [info ] [MainThread]:   schema: public
[0m12:42:49.360818 [info ] [MainThread]:   connect_timeout: 10
[0m12:42:49.362270 [info ] [MainThread]:   role: None
[0m12:42:49.363599 [info ] [MainThread]:   search_path: None
[0m12:42:49.364840 [info ] [MainThread]:   keepalives_idle: 0
[0m12:42:49.366596 [info ] [MainThread]:   sslmode: None
[0m12:42:49.368264 [info ] [MainThread]:   sslcert: None
[0m12:42:49.369826 [info ] [MainThread]:   sslkey: None
[0m12:42:49.371271 [info ] [MainThread]:   sslrootcert: None
[0m12:42:49.372840 [info ] [MainThread]:   application_name: dbt
[0m12:42:49.374552 [info ] [MainThread]:   retries: 1
[0m12:42:49.377443 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:49.447804 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:42:49.495774 [debug] [MainThread]: Using postgres connection "debug"
[0m12:42:49.497520 [debug] [MainThread]: On debug: select 1 as id
[0m12:42:49.499334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:49.510101 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m12:42:49.512953 [debug] [MainThread]: On debug: Close
[0m12:42:49.514667 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:42:49.519090 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:42:49.526176 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.7120644, "process_in_blocks": "0", "process_kernel_time": 0.11149, "process_mem_max_rss": "101744", "process_out_blocks": "0", "process_user_time": 2.179129}
[0m12:42:49.528385 [debug] [MainThread]: Command `dbt debug` succeeded at 12:42:49.528010 after 0.71 seconds
[0m12:42:49.530387 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:42:49.532364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf9f09520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf944b020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cf9dd3620>]}
[0m12:42:49.534088 [debug] [MainThread]: Flushing usage events
[0m12:42:50.731299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:55.789698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fc9b4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fc9b58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd92c3e0>]}


============================== 12:42:55.809364 | 95456422-b1b1-4567-8ab5-77c0b0641518 ==============================
[0m12:42:55.809364 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:42:55.819153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:42:56.261055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95456422-b1b1-4567-8ab5-77c0b0641518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd5459a0>]}
[0m12:42:56.488371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95456422-b1b1-4567-8ab5-77c0b0641518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fcc29df0>]}
[0m12:42:56.491943 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:56.758033 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:43:01.772139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:01.774315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:01.784949 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m12:43:01.892323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95456422-b1b1-4567-8ab5-77c0b0641518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fb045580>]}
[0m12:43:02.115779 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:43:02.130045 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:43:02.173555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95456422-b1b1-4567-8ab5-77c0b0641518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5faeb52b0>]}
[0m12:43:02.176303 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 551 macros
[0m12:43:02.179357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95456422-b1b1-4567-8ab5-77c0b0641518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fb0872c0>]}
[0m12:43:02.185258 [info ] [MainThread]: 
[0m12:43:02.187528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:02.189929 [info ] [MainThread]: 
[0m12:43:02.193569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:02.204821 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:43:02.264326 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:43:02.266979 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:43:02.269382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:02.283075 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m12:43:02.287371 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:43:02.293220 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:43:02.295876 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:43:02.298332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:02.311195 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m12:43:02.314824 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:43:02.320690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m12:43:02.332750 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:43:02.335358 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:43:02.337927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:02.349313 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:43:02.351746 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:43:02.354741 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:43:02.360797 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m12:43:02.365544 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:43:02.368239 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:43:02.371650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m12:43:02.383189 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:43:02.385702 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:43:02.387973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:02.398443 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:43:02.401356 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:43:02.403900 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:43:02.410662 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m12:43:02.414518 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:43:02.417274 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:43:02.420145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m12:43:02.425360 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:43:02.427788 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:43:02.429894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:02.441778 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:43:02.444058 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:43:02.446523 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:43:02.453471 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m12:43:02.457394 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:43:02.460237 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:43:02.470804 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:02.473369 [debug] [MainThread]: On master: BEGIN
[0m12:43:02.475685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:02.486489 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:43:02.488765 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:02.491437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:02.504682 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m12:43:02.508811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95456422-b1b1-4567-8ab5-77c0b0641518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fce97e00>]}
[0m12:43:02.511392 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:02.513552 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:02.515760 [debug] [MainThread]: On master: BEGIN
[0m12:43:02.518801 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:43:02.520860 [debug] [MainThread]: On master: COMMIT
[0m12:43:02.523018 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:02.525373 [debug] [MainThread]: On master: COMMIT
[0m12:43:02.528198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:02.530735 [debug] [MainThread]: On master: Close
[0m12:43:02.536541 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:43:02.539409 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:43:02.542188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:43:02.544480 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:43:02.562289 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:43:02.585768 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:43:02.646766 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:43:02.669716 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:43:02.672370 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:43:02.675270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:02.685429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:43:02.688006 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:43:02.690871 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }}
)

select * from combined
  );
[0m12:43:02.693799 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                         ^

[0m12:43:02.695960 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m12:43:02.698374 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:43:02.705150 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:43:02.710165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95456422-b1b1-4567-8ab5-77c0b0641518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5f9e7cb60>]}
[0m12:43:02.713304 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.17s]
[0m12:43:02.716006 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:43:02.718944 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m12:43:02.723387 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:43:02.726046 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m12:43:02.728668 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:43:02.733900 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:02.736630 [debug] [MainThread]: On master: BEGIN
[0m12:43:02.738968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:02.752265 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:43:02.755974 [debug] [MainThread]: On master: COMMIT
[0m12:43:02.758656 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:02.760921 [debug] [MainThread]: On master: COMMIT
[0m12:43:02.763587 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:02.766019 [debug] [MainThread]: On master: Close
[0m12:43:02.768872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:02.771439 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m12:43:02.774256 [info ] [MainThread]: 
[0m12:43:02.776767 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m12:43:02.780624 [debug] [MainThread]: Command end result
[0m12:43:02.893840 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:43:02.908348 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:43:02.930132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:43:02.932510 [info ] [MainThread]: 
[0m12:43:02.935179 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:43:02.938030 [info ] [MainThread]: 
[0m12:43:02.940575 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:43:02.942797 [info ] [MainThread]: 
[0m12:43:02.945489 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:43:02.949377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.406709, "process_in_blocks": "0", "process_kernel_time": 0.452635, "process_mem_max_rss": "108600", "process_out_blocks": "0", "process_user_time": 3.729323}
[0m12:43:02.953900 [debug] [MainThread]: Command `dbt run` failed at 12:43:02.953067 after 7.41 seconds
[0m12:43:02.957222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd1f9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fd57c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5fcd52420>]}
[0m12:43:02.959920 [debug] [MainThread]: Flushing usage events
[0m12:43:04.125630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:33.487310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a468a9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a471fc530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a46234230>]}


============================== 12:47:33.505762 | a828a9b0-b77d-4d40-81cb-4c421f752fbb ==============================
[0m12:47:33.505762 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:47:33.513487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:34.010628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a828a9b0-b77d-4d40-81cb-4c421f752fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a46373620>]}
[0m12:47:34.126187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a828a9b0-b77d-4d40-81cb-4c421f752fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4446be90>]}
[0m12:47:34.129351 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:34.273505 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:47:42.563272 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:47:42.566524 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/src/schema.yml
[0m12:47:42.927683 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m12:47:42.954194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a828a9b0-b77d-4d40-81cb-4c421f752fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4446bb30>]}
[0m12:47:43.265003 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:47:43.287515 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:47:43.351930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a828a9b0-b77d-4d40-81cb-4c421f752fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a43fd40e0>]}
[0m12:47:43.358403 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 551 macros
[0m12:47:43.368781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a828a9b0-b77d-4d40-81cb-4c421f752fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4421fd70>]}
[0m12:47:43.377631 [info ] [MainThread]: 
[0m12:47:43.382315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:43.407776 [info ] [MainThread]: 
[0m12:47:43.414172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:43.425350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:47:43.475789 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:47:43.478972 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:47:43.483976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:43.507091 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.023 seconds
[0m12:47:43.551131 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:47:43.558166 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:47:43.561207 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:47:43.563946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:43.584917 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.021 seconds
[0m12:47:43.594020 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:47:43.604126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m12:47:43.621868 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:47:43.628146 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:47:43.633695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:43.657781 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m12:47:43.677581 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:47:43.720702 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:47:43.731506 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m12:47:43.741293 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:47:43.749792 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:47:43.763889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m12:47:43.779969 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:47:43.784125 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:47:43.787358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:43.798846 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:47:43.802927 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:47:43.806145 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:47:43.812222 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:47:43.817057 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:47:43.820819 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:47:43.825648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m12:47:43.837063 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:47:43.842710 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:47:43.846485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:43.859567 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:47:43.863529 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:47:43.867239 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:43.877801 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.006 seconds
[0m12:47:43.903827 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:47:43.925889 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:47:44.001110 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:44.005520 [debug] [MainThread]: On master: BEGIN
[0m12:47:44.008616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:44.020930 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:47:44.023808 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:44.026619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:44.038453 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m12:47:44.042761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a828a9b0-b77d-4d40-81cb-4c421f752fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a43fd74d0>]}
[0m12:47:44.045871 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:44.048853 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:44.051265 [debug] [MainThread]: On master: BEGIN
[0m12:47:44.053976 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:47:44.055885 [debug] [MainThread]: On master: COMMIT
[0m12:47:44.057619 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:44.059811 [debug] [MainThread]: On master: COMMIT
[0m12:47:44.072248 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:47:44.075926 [debug] [MainThread]: On master: Close
[0m12:47:44.083478 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:47:44.112970 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:47:44.122074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:47:44.130419 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:47:44.206727 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:47:44.275309 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:47:44.336722 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:47:44.462314 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:47:44.466308 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:47:44.469389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:44.491197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m12:47:44.498009 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:47:44.505550 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }} union all select * from {{ source('raw', 'green_tripdata_' ~ year ~ '_' ~ '%02d'|format(m)) }}
)

select * from combined
  );
[0m12:47:44.514456 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                         ^

[0m12:47:44.519970 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m12:47:44.525661 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:47:44.535553 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:47:44.548239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a828a9b0-b77d-4d40-81cb-4c421f752fbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a431d59a0>]}
[0m12:47:44.560607 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.42s]
[0m12:47:44.570111 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:47:44.573707 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m12:47:44.578381 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:47:44.582073 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m12:47:44.587028 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:47:44.594147 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:44.598173 [debug] [MainThread]: On master: BEGIN
[0m12:47:44.605006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:44.635491 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m12:47:44.643597 [debug] [MainThread]: On master: COMMIT
[0m12:47:44.651852 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:44.657021 [debug] [MainThread]: On master: COMMIT
[0m12:47:44.664260 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:47:44.667542 [debug] [MainThread]: On master: Close
[0m12:47:44.670842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:44.674505 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m12:47:44.677356 [info ] [MainThread]: 
[0m12:47:44.681488 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m12:47:44.686106 [debug] [MainThread]: Command end result
[0m12:47:44.925304 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:47:44.983920 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:47:45.008859 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:47:45.011244 [info ] [MainThread]: 
[0m12:47:45.013872 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:47:45.016302 [info ] [MainThread]: 
[0m12:47:45.018774 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  syntax error at or near "{"
  LINE 10:   select * from {{ source('raw', 'green_tripdata_' ~ year ~ ...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m12:47:45.021465 [info ] [MainThread]: 
[0m12:47:45.024016 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:47:45.027997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.746038, "process_in_blocks": "0", "process_kernel_time": 0.676227, "process_mem_max_rss": "110188", "process_out_blocks": "0", "process_user_time": 4.405722}
[0m12:47:45.031597 [debug] [MainThread]: Command `dbt run` failed at 12:47:45.031131 after 11.75 seconds
[0m12:47:45.034871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a45f38530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a43f2ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a4760a660>]}
[0m12:47:45.037736 [debug] [MainThread]: Flushing usage events
[0m12:47:46.109505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:03.452091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf623eb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf622278f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf62358f80>]}


============================== 12:50:03.464121 | 1bf84842-f96e-413f-bde1-dbd1881e6abf ==============================
[0m12:50:03.464121 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:50:03.471698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:03.489894 [info ] [MainThread]: dbt version: 1.9.0
[0m12:50:03.492551 [info ] [MainThread]: python version: 3.12.4
[0m12:50:03.494618 [info ] [MainThread]: python path: /usr/local/bin/python
[0m12:50:03.496187 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m12:50:03.656219 [info ] [MainThread]: Using profiles dir at /dbt
[0m12:50:03.657873 [info ] [MainThread]: Using profiles.yml file at /dbt/profiles.yml
[0m12:50:03.659575 [info ] [MainThread]: Using dbt_project.yml file at /dbt/dbt_project.yml
[0m12:50:03.661542 [info ] [MainThread]: adapter type: postgres
[0m12:50:03.663055 [info ] [MainThread]: adapter version: 1.9.0
[0m12:50:03.837689 [info ] [MainThread]: Configuration:
[0m12:50:03.839982 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:50:03.843247 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:50:03.845182 [info ] [MainThread]: Required dependencies:
[0m12:50:03.846766 [debug] [MainThread]: Executing "git --help"
[0m12:50:03.850009 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:50:03.851285 [debug] [MainThread]: STDERR: "b''"
[0m12:50:03.853429 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:50:03.855241 [info ] [MainThread]: Connection:
[0m12:50:03.857589 [info ] [MainThread]:   host: postgres_ingest
[0m12:50:03.859541 [info ] [MainThread]:   port: 5432
[0m12:50:03.861819 [info ] [MainThread]:   user: ingest_user
[0m12:50:03.863532 [info ] [MainThread]:   database: ingest_db
[0m12:50:03.866324 [info ] [MainThread]:   schema: public
[0m12:50:03.868793 [info ] [MainThread]:   connect_timeout: 10
[0m12:50:03.870923 [info ] [MainThread]:   role: None
[0m12:50:03.872479 [info ] [MainThread]:   search_path: None
[0m12:50:03.874104 [info ] [MainThread]:   keepalives_idle: 0
[0m12:50:03.877042 [info ] [MainThread]:   sslmode: None
[0m12:50:03.878480 [info ] [MainThread]:   sslcert: None
[0m12:50:03.879834 [info ] [MainThread]:   sslkey: None
[0m12:50:03.881527 [info ] [MainThread]:   sslrootcert: None
[0m12:50:03.883216 [info ] [MainThread]:   application_name: dbt
[0m12:50:03.886015 [info ] [MainThread]:   retries: 1
[0m12:50:03.888432 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:03.958125 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:50:03.991398 [debug] [MainThread]: Using postgres connection "debug"
[0m12:50:03.993211 [debug] [MainThread]: On debug: select 1 as id
[0m12:50:03.994886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:04.003786 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m12:50:04.006563 [debug] [MainThread]: On debug: Close
[0m12:50:04.008182 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:50:04.009994 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:50:04.019176 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.73037076, "process_in_blocks": "0", "process_kernel_time": 0.15006, "process_mem_max_rss": "101684", "process_out_blocks": "0", "process_user_time": 2.42098}
[0m12:50:04.021734 [debug] [MainThread]: Command `dbt debug` succeeded at 12:50:04.021432 after 0.73 seconds
[0m12:50:04.023458 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:50:04.025250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf622a4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf61df7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf61fb0bc0>]}
[0m12:50:04.027052 [debug] [MainThread]: Flushing usage events
[0m12:50:05.836829 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:15.639665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17beeaa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17bd08f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17be88860>]}


============================== 12:50:15.644237 | c9bdd603-68cc-4d5d-84ba-01730c383b2b ==============================
[0m12:50:15.644237 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:50:15.645795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:50:16.094054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9bdd603-68cc-4d5d-84ba-01730c383b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17b358f80>]}
[0m12:50:16.267642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9bdd603-68cc-4d5d-84ba-01730c383b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17baca270>]}
[0m12:50:16.273321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:16.552529 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:50:18.486374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:50:18.488140 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/union_raw_tables.sql
[0m12:50:19.037215 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.staging_green_tripdata_2019_all' (models/staging/staging_green_tripdata_2019_all.sql) depends on a source named 'raw.green_tripdata_2019-01' which was not found
[0m12:50:19.041516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5475478, "process_in_blocks": "0", "process_kernel_time": 0.25128, "process_mem_max_rss": "103536", "process_out_blocks": "0", "process_user_time": 3.24654}
[0m12:50:19.045569 [debug] [MainThread]: Command `dbt run` failed at 12:50:19.044960 after 3.55 seconds
[0m12:50:19.047924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17b935dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17978b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17976b470>]}
[0m12:50:19.050812 [debug] [MainThread]: Flushing usage events
[0m12:50:20.069496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:42.277840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c80110a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c80796d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c9cd64b0>]}


============================== 12:51:42.294362 | 478a60a1-1d0b-4766-9050-aa22f6e870ad ==============================
[0m12:51:42.294362 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:51:42.300505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:42.658382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '478a60a1-1d0b-4766-9050-aa22f6e870ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c80a0ce0>]}
[0m12:51:42.753907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '478a60a1-1d0b-4766-9050-aa22f6e870ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c9b54b30>]}
[0m12:51:42.755979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:51:42.915794 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:51:46.893073 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m12:51:46.898861 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/schema.yml
[0m12:51:46.908409 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/union_raw_tables.sql
[0m12:51:47.654689 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.staging_green_tripdata_2019_all' (models/staging/staging_green_tripdata_2019_all.sql) depends on a source named 'raw.green_tripdata_2019-01' which was not found
[0m12:51:47.658110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.687131, "process_in_blocks": "0", "process_kernel_time": 0.3691, "process_mem_max_rss": "102920", "process_out_blocks": "0", "process_user_time": 3.591251}
[0m12:51:47.659734 [debug] [MainThread]: Command `dbt run` failed at 12:51:47.659555 after 5.69 seconds
[0m12:51:47.661227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c8126d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c6298860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3c48f7200>]}
[0m12:51:47.662612 [debug] [MainThread]: Flushing usage events
[0m12:51:48.749317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:58.073607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f148bf39730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f148c0500b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f148c0e1fa0>]}


============================== 12:52:58.083828 | f67527e5-2413-4d24-b3c2-cbb66f97d172 ==============================
[0m12:52:58.083828 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:52:58.087454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:58.519440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f67527e5-2413-4d24-b3c2-cbb66f97d172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1489f5b350>]}
[0m12:52:58.707074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f67527e5-2413-4d24-b3c2-cbb66f97d172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f148ab034d0>]}
[0m12:52:58.712002 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:52:58.978013 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:53:01.425928 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m12:53:01.427730 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/schema.yml
[0m12:53:01.429497 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/union_raw_tables.sql
[0m12:53:02.091997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m12:53:02.123583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f67527e5-2413-4d24-b3c2-cbb66f97d172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f148838d370>]}
[0m12:53:02.442152 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:53:02.457697 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:53:02.499468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f67527e5-2413-4d24-b3c2-cbb66f97d172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1486a56960>]}
[0m12:53:02.502214 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m12:53:02.504561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f67527e5-2413-4d24-b3c2-cbb66f97d172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14882a4a70>]}
[0m12:53:02.509320 [info ] [MainThread]: 
[0m12:53:02.510964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:02.512689 [info ] [MainThread]: 
[0m12:53:02.514862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:02.524049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m12:53:02.570304 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:53:02.572736 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:53:02.574755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:02.585657 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m12:53:02.589722 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:53:02.594175 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m12:53:02.595560 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m12:53:02.596729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:02.605462 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m12:53:02.609183 [debug] [ThreadPool]: On list_ingest_db: Close
[0m12:53:02.613775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_staging)
[0m12:53:02.629159 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:53:02.632482 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m12:53:02.636106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:02.656328 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m12:53:02.658964 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m12:53:02.661221 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m12:53:02.667137 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:53:02.671060 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m12:53:02.673544 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m12:53:02.676101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m12:53:02.680015 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:53:02.682004 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m12:53:02.684036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:02.692910 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:53:02.695957 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m12:53:02.698157 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:53:02.704744 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m12:53:02.709723 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m12:53:02.712599 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m12:53:02.715823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m12:53:02.731048 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:53:02.734572 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m12:53:02.738473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:02.757848 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m12:53:02.761766 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m12:53:02.765444 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m12:53:02.772021 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m12:53:02.776407 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m12:53:02.778905 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m12:53:02.789532 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:02.792281 [debug] [MainThread]: On master: BEGIN
[0m12:53:02.794762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:02.805061 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:53:02.807318 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:02.809710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:53:02.821336 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m12:53:02.825075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f67527e5-2413-4d24-b3c2-cbb66f97d172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1489f871a0>]}
[0m12:53:02.827380 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:02.829825 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:02.831608 [debug] [MainThread]: On master: BEGIN
[0m12:53:02.834132 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:53:02.836127 [debug] [MainThread]: On master: COMMIT
[0m12:53:02.837998 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:02.839828 [debug] [MainThread]: On master: COMMIT
[0m12:53:02.841886 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:53:02.843349 [debug] [MainThread]: On master: Close
[0m12:53:02.847759 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:53:02.849558 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m12:53:02.851419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m12:53:02.852626 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:53:02.868643 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:53:02.890060 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:53:02.943374 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:53:02.964917 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:53:02.966833 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m12:53:02.968629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:02.977780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:53:02.979354 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:53:02.981436 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m12:53:03.026911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m12:53:03.052861 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:53:03.055237 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m12:53:03.061683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:53:03.096890 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m12:53:03.099603 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:53:03.103030 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m12:53:03.108931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:53:03.119476 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m12:53:03.130233 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m12:53:03.132354 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m12:53:03.135349 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:53:03.140080 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m12:53:03.144250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f67527e5-2413-4d24-b3c2-cbb66f97d172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f148bdca2a0>]}
[0m12:53:03.146915 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.29s]
[0m12:53:03.149983 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m12:53:03.152449 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:53:03.153897 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m12:53:03.155243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m12:53:03.156631 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:53:03.163589 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m12:53:03.176374 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:53:03.208711 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m12:53:03.233798 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m12:53:03.248648 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m12:53:03.251942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:03.272509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:53:03.278163 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m12:53:03.284500 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
  
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
  
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
  
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
  count(*) as trip_count,
  round(avg(trip_distance)::numeric,2) as avg_distance,
  round(sum(trip_distance)::numeric,2) as total_distance,
  round(avg(fare_amount)::numeric,2) as avg_fare,
  round(sum(fare_amount)::numeric,2) as total_fare,
  round(sum(tip_amount)::numeric,2) as total_tip,
  round(avg(tip_amount)::numeric,2) as avg_tip,
  round(avg(total_amount)::numeric,2) as avg_total,
  round(avg(passenger_count)::numeric,2) as avg_passenger_count,
  count(distinct pulocationid) as unique_pickup_locations,
  min(lpep_pickup_datetime) as first_trip,
  max(lpep_pickup_datetime) as last_trip,
  count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
  count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
  max(
    case
      when lpep_dropoff_datetime is not null then
        extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
      else null end
  ) as trip_duration_minutes,
  case
    when avg(trip_distance)<=2 then 'Short'
    when avg(trip_distance)<=5 then 'Medium'
    else 'Long' end as trip_type,
  
    CASE 
        WHEN fare_amount > 0 THEN ROUND(tip_amount / fare_amount, 2)
        ELSE NULL
    END
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
WHERE 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour;
  );
  
[0m12:53:03.328544 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                   ^

[0m12:53:03.332657 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m12:53:03.337230 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m12:53:03.357662 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m12:53:03.365865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f67527e5-2413-4d24-b3c2-cbb66f97d172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1485af7560>]}
[0m12:53:03.374829 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.21s]
[0m12:53:03.386337 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m12:53:03.395237 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m12:53:03.412994 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:03.421117 [debug] [MainThread]: On master: BEGIN
[0m12:53:03.428552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:03.460131 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m12:53:03.465729 [debug] [MainThread]: On master: COMMIT
[0m12:53:03.469443 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:03.473147 [debug] [MainThread]: On master: COMMIT
[0m12:53:03.478491 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:53:03.484271 [debug] [MainThread]: On master: Close
[0m12:53:03.490194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:03.495363 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m12:53:03.500300 [info ] [MainThread]: 
[0m12:53:03.508183 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m12:53:03.521594 [debug] [MainThread]: Command end result
[0m12:53:03.730466 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m12:53:03.769993 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m12:53:03.832870 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m12:53:03.837922 [info ] [MainThread]: 
[0m12:53:03.845810 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:53:03.856157 [info ] [MainThread]: 
[0m12:53:03.867172 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m12:53:03.878056 [info ] [MainThread]: 
[0m12:53:03.884863 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:53:03.895482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.055954, "process_in_blocks": "0", "process_kernel_time": 0.349018, "process_mem_max_rss": "114836", "process_out_blocks": "0", "process_user_time": 4.617017}
[0m12:53:03.899950 [debug] [MainThread]: Command `dbt run` failed at 12:53:03.899361 after 6.06 seconds
[0m12:53:03.904883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f148acd3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1486a57fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1486a57f80>]}
[0m12:53:03.908871 [debug] [MainThread]: Flushing usage events
[0m12:53:05.441704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:12.666519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63aeee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63d0c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63aedaf0>]}


============================== 13:01:12.674902 | a7b6e629-f35d-4f39-9baa-f965dcac4079 ==============================
[0m13:01:12.674902 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:01:12.678799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:01:12.924498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7b6e629-f35d-4f39-9baa-f965dcac4079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63b1ac00>]}
[0m13:01:13.003510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7b6e629-f35d-4f39-9baa-f965dcac4079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc648ba180>]}
[0m13:01:13.005685 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:01:13.187597 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:01:20.555567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:20.557041 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:01:20.974316 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:01:20.993626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7b6e629-f35d-4f39-9baa-f965dcac4079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc65e1e9f0>]}
[0m13:01:21.152452 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:01:21.162959 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:01:21.194431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7b6e629-f35d-4f39-9baa-f965dcac4079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc61f73b30>]}
[0m13:01:21.196419 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:01:21.198411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b6e629-f35d-4f39-9baa-f965dcac4079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc61d76900>]}
[0m13:01:21.202990 [info ] [MainThread]: 
[0m13:01:21.204786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:21.206092 [info ] [MainThread]: 
[0m13:01:21.207563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:21.213367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:01:21.253338 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:01:21.255042 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:01:21.256464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:21.264301 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m13:01:21.266979 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:01:21.270251 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:01:21.271320 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:01:21.272293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:21.278429 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m13:01:21.280798 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:01:21.283511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:01:21.290809 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:01:21.292359 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:01:21.294503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:21.303562 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:01:21.305963 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:01:21.307584 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:01:21.314674 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:01:21.318837 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:01:21.324190 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:01:21.328483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:01:21.336423 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:01:21.338234 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:01:21.340497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:21.349716 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:01:21.352631 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:01:21.355740 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:01:21.361626 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:01:21.366530 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:01:21.369234 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:01:21.371880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:01:21.377321 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:01:21.380885 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:01:21.383711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:21.398089 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:01:21.402073 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:01:21.405492 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:01:21.414663 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:01:21.420407 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:01:21.424325 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:01:21.441164 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:21.445103 [debug] [MainThread]: On master: BEGIN
[0m13:01:21.448438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:21.469003 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m13:01:21.473124 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:21.477574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:21.499515 [debug] [MainThread]: SQL status: SELECT 12 in 0.017 seconds
[0m13:01:21.510558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b6e629-f35d-4f39-9baa-f965dcac4079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc639631d0>]}
[0m13:01:21.512959 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:21.515770 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:21.518723 [debug] [MainThread]: On master: BEGIN
[0m13:01:21.522739 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:01:21.525650 [debug] [MainThread]: On master: COMMIT
[0m13:01:21.528674 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:21.531007 [debug] [MainThread]: On master: COMMIT
[0m13:01:21.534185 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:21.536754 [debug] [MainThread]: On master: Close
[0m13:01:21.544548 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:01:21.547933 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:01:21.550659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:01:21.553315 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:01:21.571465 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:01:21.598705 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:01:21.640794 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:01:21.674772 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:01:21.678166 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:01:21.682430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:21.705061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m13:01:21.710729 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:01:21.716788 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:01:21.747214 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m13:01:21.761402 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:01:21.764073 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:01:21.767595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:21.774508 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:01:21.777811 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:01:21.783060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:01:21.807362 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:01:21.815178 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:01:21.820971 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:01:21.827820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:01:21.841478 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:01:21.853038 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:01:21.856133 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:01:21.862385 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:01:21.867228 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:01:21.871707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b6e629-f35d-4f39-9baa-f965dcac4079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc31c1eab0>]}
[0m13:01:21.874754 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.32s]
[0m13:01:21.877286 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:01:21.879934 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:01:21.882097 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:01:21.884028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:01:21.885759 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:01:21.892031 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:01:21.924685 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:01:21.953102 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:01:21.989876 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:01:21.992731 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:01:21.995575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:22.007975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:01:22.010582 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:01:22.013213 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour

    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    CASE 
        WHEN fare_amount > 0 THEN ROUND(tip_amount / fare_amount, 2)
        ELSE NULL
    END
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour;
  );
  
[0m13:01:22.016213 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "coalesce"
LINE 33: coalesce(
         ^

[0m13:01:22.018412 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:01:22.020816 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:01:22.025835 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "coalesce"
  LINE 33: coalesce(
           ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:01:22.028117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b6e629-f35d-4f39-9baa-f965dcac4079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc602783e0>]}
[0m13:01:22.030873 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.14s]
[0m13:01:22.034992 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:01:22.036822 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "coalesce"
  LINE 33: coalesce(
           ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:01:22.040289 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:22.041525 [debug] [MainThread]: On master: BEGIN
[0m13:01:22.043217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:22.053665 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:01:22.059348 [debug] [MainThread]: On master: COMMIT
[0m13:01:22.061281 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:22.063822 [debug] [MainThread]: On master: COMMIT
[0m13:01:22.066647 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:22.069319 [debug] [MainThread]: On master: Close
[0m13:01:22.072216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:22.074796 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:01:22.077770 [info ] [MainThread]: 
[0m13:01:22.080031 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m13:01:22.082359 [debug] [MainThread]: Command end result
[0m13:01:22.234734 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:01:22.280458 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:01:22.325241 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:01:22.330574 [info ] [MainThread]: 
[0m13:01:22.338433 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:01:22.347552 [info ] [MainThread]: 
[0m13:01:22.359951 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "coalesce"
  LINE 33: coalesce(
           ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:01:22.365855 [info ] [MainThread]: 
[0m13:01:22.375472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:01:22.386437 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.871536, "process_in_blocks": "0", "process_kernel_time": 0.266164, "process_mem_max_rss": "113780", "process_out_blocks": "0", "process_user_time": 3.183737}
[0m13:01:22.393179 [debug] [MainThread]: Command `dbt run` failed at 13:01:22.392811 after 9.88 seconds
[0m13:01:22.394915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63dbe270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc63dbd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc33537770>]}
[0m13:01:22.399325 [debug] [MainThread]: Flushing usage events
[0m13:01:27.668094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:38.383876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa0cb2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9f51d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9f2d6960>]}


============================== 13:08:38.390026 | 1a38dd74-fba2-4411-86ab-385584a716e6 ==============================
[0m13:08:38.390026 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:08:38.391995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:08:38.658009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a38dd74-fba2-4411-86ab-385584a716e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9f29d520>]}
[0m13:08:38.743870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a38dd74-fba2-4411-86ab-385584a716e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9ec2cec0>]}
[0m13:08:38.747171 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:08:38.879908 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:08:45.267646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:08:45.279316 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/calculate_tip_rate.sql
[0m13:08:45.754496 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:08:45.776614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a38dd74-fba2-4411-86ab-385584a716e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9d40dcd0>]}
[0m13:08:45.980376 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:08:45.990523 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:08:46.016887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a38dd74-fba2-4411-86ab-385584a716e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9ce59ac0>]}
[0m13:08:46.018053 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:08:46.020310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a38dd74-fba2-4411-86ab-385584a716e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9ef3dbe0>]}
[0m13:08:46.033380 [info ] [MainThread]: 
[0m13:08:46.035842 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:46.037201 [info ] [MainThread]: 
[0m13:08:46.041144 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:08:46.045323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public'
[0m13:08:46.084668 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:08:46.087396 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:08:46.091111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:46.100902 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:08:46.103442 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:08:46.107058 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:08:46.113299 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:08:46.119278 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:08:46.122736 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:08:46.126596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:08:46.133343 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:08:46.134589 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:08:46.135629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:46.141736 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:08:46.143356 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:08:46.145812 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:08:46.149933 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:08:46.154318 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:08:46.157453 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:08:46.158837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:08:46.166072 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:08:46.185717 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:08:46.188798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:46.197966 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:08:46.200025 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:08:46.202248 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:08:46.206658 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:08:46.211815 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:08:46.215660 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:08:46.224053 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:46.226522 [debug] [MainThread]: On master: BEGIN
[0m13:08:46.228998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:46.237486 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:08:46.240199 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:46.243234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:08:46.254795 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:08:46.262058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a38dd74-fba2-4411-86ab-385584a716e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa87516750>]}
[0m13:08:46.264034 [debug] [MainThread]: On master: ROLLBACK
[0m13:08:46.267038 [debug] [MainThread]: On master: Close
[0m13:08:46.273987 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:08:46.277304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:08:46.279493 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:08:46.298838 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:08:46.328454 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:08:46.330664 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:08:46.332156 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.lookup_data
[0m13:08:46.333628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now seed.my_dbt_project.lookup_data)
[0m13:08:46.335082 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.lookup_data
[0m13:08:46.338196 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.lookup_data
[0m13:08:46.340382 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.lookup_data
[0m13:08:46.341948 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:08:46.343334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.lookup_data, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:08:46.344593 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:08:46.353296 [debug] [Thread-1 (]: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:08:46.355417 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:08:46.356680 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:08:46.357313 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_calculate_tip_rate' to be skipped because of status 'error'.  Reason: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:08:46.358449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:08:46.361930 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:08:46.368184 [debug] [Thread-1 (]: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:08:46.370013 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:08:46.371320 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:08:46.371870 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_is_valid_trip' to be skipped because of status 'error'.  Reason: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:08:46.372771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:08:46.376632 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:08:46.381903 [debug] [Thread-1 (]: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:08:46.383705 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:08:46.384843 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:08:46.385294 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_standardize_payment_type' to be skipped because of status 'error'.  Reason: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:08:46.386355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_standardize_payment_type, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:08:46.389084 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:08:46.394694 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:08:46.412585 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:08:46.414911 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:08:46.417014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:46.419079 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:08:46.431846 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
    'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:08:46.434759 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 8.1986, "process_in_blocks": "0", "process_kernel_time": 0.422271, "process_mem_max_rss": "113668", "process_out_blocks": "0", "process_user_time": 2.818417}
[0m13:08:46.436724 [debug] [MainThread]: Command `dbt compile` failed at 13:08:46.436555 after 8.20 seconds
[0m13:08:46.438586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9f14af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9d060320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9d0879b0>]}
[0m13:08:46.440612 [debug] [MainThread]: Flushing usage events
[0m13:08:51.218375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:53.028750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa521b67410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa522d7e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5214ad760>]}


============================== 13:08:53.033445 | df3fb343-3b6e-4690-a7dd-5fc46c593862 ==============================
[0m13:08:53.033445 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:08:53.035415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:08:53.256536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df3fb343-3b6e-4690-a7dd-5fc46c593862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa521282f30>]}
[0m13:08:53.329876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df3fb343-3b6e-4690-a7dd-5fc46c593862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51f630e00>]}
[0m13:08:53.333103 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:08:53.433407 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:08:58.022005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:08:58.023023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:08:58.030074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:08:58.096982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df3fb343-3b6e-4690-a7dd-5fc46c593862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa52246cce0>]}
[0m13:08:58.267515 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:08:58.273848 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:08:58.309931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df3fb343-3b6e-4690-a7dd-5fc46c593862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51f44c830>]}
[0m13:08:58.311949 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:08:58.313524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df3fb343-3b6e-4690-a7dd-5fc46c593862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51f630c50>]}
[0m13:08:58.317210 [info ] [MainThread]: 
[0m13:08:58.318872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:58.320328 [info ] [MainThread]: 
[0m13:08:58.321852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:08:58.328080 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:08:58.368894 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:08:58.371173 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:08:58.373174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:58.382937 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:08:58.386663 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:08:58.392313 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:08:58.394929 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:08:58.397632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:58.411067 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m13:08:58.417720 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:08:58.425131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m13:08:58.441807 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:08:58.444447 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:08:58.446312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:58.454480 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:08:58.456186 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:08:58.457802 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:08:58.461860 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:08:58.465591 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:08:58.468429 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:08:58.470713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:08:58.474185 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:08:58.475983 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:08:58.478821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:58.489213 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:08:58.492142 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:08:58.495636 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:08:58.502053 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:08:58.507111 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:08:58.511244 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:08:58.515408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:08:58.522698 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:08:58.526154 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:08:58.529516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:58.544844 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:08:58.549285 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:08:58.552598 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:08:58.560588 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.005 seconds
[0m13:08:58.568377 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:08:58.572912 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:08:58.598874 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:58.602570 [debug] [MainThread]: On master: BEGIN
[0m13:08:58.606645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:58.626336 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m13:08:58.630322 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:58.634921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:08:58.658267 [debug] [MainThread]: SQL status: SELECT 12 in 0.020 seconds
[0m13:08:58.665609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df3fb343-3b6e-4690-a7dd-5fc46c593862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51e5c8ec0>]}
[0m13:08:58.667375 [debug] [MainThread]: On master: ROLLBACK
[0m13:08:58.670023 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:58.672357 [debug] [MainThread]: On master: BEGIN
[0m13:08:58.674904 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:08:58.677120 [debug] [MainThread]: On master: COMMIT
[0m13:08:58.678776 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:58.681110 [debug] [MainThread]: On master: COMMIT
[0m13:08:58.683787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:08:58.686035 [debug] [MainThread]: On master: Close
[0m13:08:58.690719 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:08:58.693817 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:08:58.695641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:08:58.697222 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:08:58.713251 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:08:58.729064 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:08:58.768698 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:08:58.784527 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:08:58.786868 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:08:58.789532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:58.797918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:08:58.800962 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:08:58.803518 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:08:58.818640 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m13:08:58.834225 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:08:58.837070 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:08:58.840998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:08:58.847209 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:08:58.851416 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:08:58.858796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:08:58.887582 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:08:58.890867 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:08:58.893836 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:08:58.901866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:08:58.911162 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:08:58.921486 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:08:58.924312 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:08:58.932085 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:08:58.936044 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:08:58.938929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df3fb343-3b6e-4690-a7dd-5fc46c593862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51e493740>]}
[0m13:08:58.940413 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.24s]
[0m13:08:58.941815 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:08:58.943975 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:08:58.945817 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:08:58.949191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:08:58.950623 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:08:58.963024 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:08:58.981412 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:08:59.012720 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:08:59.032778 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:08:59.034323 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:08:59.035726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:08:59.042473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:08:59.044377 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:08:59.046073 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour

    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
coalesce(tip_amount / nullif(fare_amount, 0), 0)
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour;
  );
  
[0m13:08:59.048251 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "coalesce"
LINE 33: coalesce(
         ^

[0m13:08:59.049979 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:08:59.051921 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:08:59.056650 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "coalesce"
  LINE 33: coalesce(
           ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:08:59.058793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df3fb343-3b6e-4690-a7dd-5fc46c593862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51e67d490>]}
[0m13:08:59.061053 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.11s]
[0m13:08:59.062792 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:08:59.064243 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "coalesce"
  LINE 33: coalesce(
           ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:08:59.067269 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:59.068565 [debug] [MainThread]: On master: BEGIN
[0m13:08:59.069853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:08:59.076082 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:08:59.077436 [debug] [MainThread]: On master: COMMIT
[0m13:08:59.078597 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:59.079756 [debug] [MainThread]: On master: COMMIT
[0m13:08:59.081270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:08:59.082468 [debug] [MainThread]: On master: Close
[0m13:08:59.084123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:59.085629 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:08:59.086823 [info ] [MainThread]: 
[0m13:08:59.088153 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m13:08:59.090332 [debug] [MainThread]: Command end result
[0m13:08:59.274707 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:08:59.320745 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:08:59.349085 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:08:59.351604 [info ] [MainThread]: 
[0m13:08:59.354627 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:08:59.360300 [info ] [MainThread]: 
[0m13:08:59.366428 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "coalesce"
  LINE 33: coalesce(
           ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:08:59.372383 [info ] [MainThread]: 
[0m13:08:59.377539 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:08:59.384183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4885836, "process_in_blocks": "0", "process_kernel_time": 0.318317, "process_mem_max_rss": "109340", "process_out_blocks": "0", "process_user_time": 2.636067}
[0m13:08:59.389601 [debug] [MainThread]: Command `dbt run` failed at 13:08:59.389105 after 6.49 seconds
[0m13:08:59.393331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa521bc5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa521bc7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51f78bf80>]}
[0m13:08:59.395767 [debug] [MainThread]: Flushing usage events
[0m13:09:03.379675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:33.995084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464cb70920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464c1decc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464ebb9b20>]}


============================== 13:09:33.999596 | d561eba4-af36-4eac-993e-2e73da3c186b ==============================
[0m13:09:33.999596 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:09:34.001203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:09:34.237244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd561eba4-af36-4eac-993e-2e73da3c186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464be8da00>]}
[0m13:09:34.310419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd561eba4-af36-4eac-993e-2e73da3c186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464be711c0>]}
[0m13:09:34.312979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:09:34.426750 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:09:36.389388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:09:36.390838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:09:36.399075 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:09:36.466429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd561eba4-af36-4eac-993e-2e73da3c186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464a6de390>]}
[0m13:09:36.643298 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:09:36.654554 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:09:36.692988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd561eba4-af36-4eac-993e-2e73da3c186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464a24f110>]}
[0m13:09:36.695766 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:09:36.697665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd561eba4-af36-4eac-993e-2e73da3c186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464befd220>]}
[0m13:09:36.702354 [info ] [MainThread]: 
[0m13:09:36.704086 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:09:36.705708 [info ] [MainThread]: 
[0m13:09:36.707533 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:09:36.710643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public_marts'
[0m13:09:36.753872 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:09:36.755680 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:09:36.757527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:36.767060 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:09:36.770231 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:09:36.772376 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:09:36.777614 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:09:36.781642 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:09:36.784030 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:09:36.786116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:09:36.789918 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:09:36.791752 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:09:36.793510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:36.801424 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:09:36.803998 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:09:36.806504 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:09:36.811601 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:09:36.815352 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:09:36.818468 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:09:36.821608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:09:36.825337 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:09:36.827502 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:09:36.829705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:36.838625 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:09:36.840670 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:09:36.842282 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:09:36.846675 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:09:36.850830 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:09:36.853278 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:09:36.864865 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:36.867517 [debug] [MainThread]: On master: BEGIN
[0m13:09:36.870180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:36.880034 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:09:36.883071 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:36.885064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:09:36.895750 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:09:36.902284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd561eba4-af36-4eac-993e-2e73da3c186b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464a5fc3b0>]}
[0m13:09:36.905323 [debug] [MainThread]: On master: ROLLBACK
[0m13:09:36.907659 [debug] [MainThread]: On master: Close
[0m13:09:36.914513 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:09:36.917083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:09:36.919823 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:09:36.935280 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:09:36.955832 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:09:36.957961 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:09:36.960047 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.lookup_data
[0m13:09:36.961940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now seed.my_dbt_project.lookup_data)
[0m13:09:36.963997 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.lookup_data
[0m13:09:36.968385 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.lookup_data
[0m13:09:36.971033 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.lookup_data
[0m13:09:36.973313 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:09:36.975113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.lookup_data, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:09:36.977329 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:09:36.985886 [debug] [Thread-1 (]: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:36.988533 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:09:36.990609 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:09:36.991139 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_calculate_tip_rate' to be skipped because of status 'error'.  Reason: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:09:36.992609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:09:36.996159 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:09:37.003445 [debug] [Thread-1 (]: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:37.006964 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:09:37.009120 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:09:37.009747 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_is_valid_trip' to be skipped because of status 'error'.  Reason: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:09:37.011527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:09:37.016146 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:09:37.023445 [debug] [Thread-1 (]: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:37.025463 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:09:37.027038 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:09:37.027687 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_standardize_payment_type' to be skipped because of status 'error'.  Reason: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:09:37.031208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_standardize_payment_type, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:09:37.034797 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:09:37.045325 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:09:37.061158 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:09:37.063449 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:09:37.065809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:37.067372 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:09:37.069793 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
    'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:37.071933 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.2061, "process_in_blocks": "0", "process_kernel_time": 0.224598, "process_mem_max_rss": "109376", "process_out_blocks": "0", "process_user_time": 2.197163}
[0m13:09:37.073740 [debug] [MainThread]: Command `dbt compile` failed at 13:09:37.073564 after 3.21 seconds
[0m13:09:37.075073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464c4a4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464c354ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46494a5b50>]}
[0m13:09:37.076223 [debug] [MainThread]: Flushing usage events
[0m13:09:41.270259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:26.219289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f743298c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7433cd8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7431dc5160>]}


============================== 13:12:26.226710 | 5c2b3f29-1288-4a7b-b301-1ea686509559 ==============================
[0m13:12:26.226710 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:12:26.229362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:12:26.370617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c2b3f29-1288-4a7b-b301-1ea686509559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7432929f70>]}
[0m13:12:26.869206 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6krw_7gt'
[0m13:12:26.870857 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:12:32.759538 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:12:32.763883 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:12:36.492296 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:12:36.500292 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:12:56.215229 [info ] [MainThread]: Installed from version 1.3.0
[0m13:12:56.224207 [info ] [MainThread]: Up to date!
[0m13:12:56.234199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5c2b3f29-1288-4a7b-b301-1ea686509559', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7431a70da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7431a70530>]}
[0m13:12:56.250038 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 30.231636, "process_in_blocks": "0", "process_kernel_time": 0.701969, "process_mem_max_rss": "89264", "process_out_blocks": "176", "process_user_time": 1.855204}
[0m13:12:56.261777 [debug] [MainThread]: Command `dbt deps` succeeded at 13:12:56.260176 after 30.24 seconds
[0m13:12:56.268329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7432c2d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7432097e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7432609df0>]}
[0m13:12:56.277317 [debug] [MainThread]: Flushing usage events
[0m13:13:00.304166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:51.153266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f3076390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f3fd6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f3074590>]}


============================== 13:13:51.162289 | c98d8944-cc93-488f-bd50-9303e23e50a5 ==============================
[0m13:13:51.162289 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:13:51.166891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:13:51.412233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c98d8944-cc93-488f-bd50-9303e23e50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f2162d50>]}
[0m13:13:51.491065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c98d8944-cc93-488f-bd50-9303e23e50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f2090050>]}
[0m13:13:51.493656 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:13:51.618679 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:13:54.802991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:54.806095 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/calculate_tip_rate.sql
[0m13:13:55.220383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:13:55.239904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c98d8944-cc93-488f-bd50-9303e23e50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1eaefa420>]}
[0m13:13:55.441116 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:13:55.450354 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:13:55.500092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c98d8944-cc93-488f-bd50-9303e23e50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f211d4c0>]}
[0m13:13:55.502525 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:13:55.503918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c98d8944-cc93-488f-bd50-9303e23e50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f08fea50>]}
[0m13:13:55.507424 [info ] [MainThread]: 
[0m13:13:55.509186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:13:55.510622 [info ] [MainThread]: 
[0m13:13:55.512189 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:13:55.514605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public_staging'
[0m13:13:55.555327 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:13:55.557653 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:13:55.559601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:55.568014 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:13:55.569301 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:13:55.570388 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:13:55.574320 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:13:55.577351 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:13:55.579243 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:13:55.581196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:13:55.585011 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:13:55.587378 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:13:55.589537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:55.597311 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:13:55.599363 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:13:55.600856 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:13:55.604691 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:13:55.608416 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:13:55.610510 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:13:55.612679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:13:55.620187 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:13:55.622267 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:13:55.624341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:55.632797 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:13:55.634662 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:13:55.636717 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:13:55.641656 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:13:55.644375 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:13:55.646742 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:13:55.654102 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:55.656391 [debug] [MainThread]: On master: BEGIN
[0m13:13:55.659007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:55.668302 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:13:55.670357 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:55.673130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:13:55.687691 [debug] [MainThread]: SQL status: SELECT 12 in 0.011 seconds
[0m13:13:55.694946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c98d8944-cc93-488f-bd50-9303e23e50a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1eaa81010>]}
[0m13:13:55.698238 [debug] [MainThread]: On master: ROLLBACK
[0m13:13:55.701818 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:55.705153 [debug] [MainThread]: On master: BEGIN
[0m13:13:55.709910 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:13:55.713142 [debug] [MainThread]: On master: COMMIT
[0m13:13:55.716318 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:55.720098 [debug] [MainThread]: On master: COMMIT
[0m13:13:55.725061 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:13:55.729544 [debug] [MainThread]: On master: Close
[0m13:13:55.739124 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:13:55.744407 [info ] [Thread-1 (]: 1 of 3 START test test_calculate_tip_rate ...................................... [RUN]
[0m13:13:55.748242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:13:55.750737 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:13:55.771519 [debug] [Thread-1 (]: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:13:55.773935 [error] [Thread-1 (]: 1 of 3 ERROR test_calculate_tip_rate ........................................... [[31mERROR[0m in 0.03s]
[0m13:13:55.776782 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:13:55.780003 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:13:55.780780 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_calculate_tip_rate' to be skipped because of status 'error'.  Reason: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:13:55.782277 [info ] [Thread-1 (]: 2 of 3 START test test_is_valid_trip ........................................... [RUN]
[0m13:13:55.785726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:13:55.789261 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:13:55.797137 [debug] [Thread-1 (]: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:13:55.800200 [error] [Thread-1 (]: 2 of 3 ERROR test_is_valid_trip ................................................ [[31mERROR[0m in 0.01s]
[0m13:13:55.804393 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:13:55.806678 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:13:55.807399 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_is_valid_trip' to be skipped because of status 'error'.  Reason: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:13:55.809020 [info ] [Thread-1 (]: 3 of 3 START test test_standardize_payment_type ................................ [RUN]
[0m13:13:55.812916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:13:55.814936 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:13:55.822946 [debug] [Thread-1 (]: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:13:55.826305 [error] [Thread-1 (]: 3 of 3 ERROR test_standardize_payment_type ..................................... [[31mERROR[0m in 0.01s]
[0m13:13:55.830654 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:13:55.833945 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_standardize_payment_type' to be skipped because of status 'error'.  Reason: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:13:55.837546 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:55.839680 [debug] [MainThread]: On master: BEGIN
[0m13:13:55.842174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:55.851980 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:13:55.855244 [debug] [MainThread]: On master: COMMIT
[0m13:13:55.857836 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:55.860717 [debug] [MainThread]: On master: COMMIT
[0m13:13:55.863356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:13:55.866768 [debug] [MainThread]: On master: Close
[0m13:13:55.871634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:55.874244 [debug] [MainThread]: Connection 'test.my_dbt_project.test_standardize_payment_type' was properly closed.
[0m13:13:55.878500 [info ] [MainThread]: 
[0m13:13:55.881534 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:13:55.890714 [debug] [MainThread]: Command end result
[0m13:13:56.064253 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:13:56.137151 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:13:56.203429 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:13:56.215723 [info ] [MainThread]: 
[0m13:13:56.227718 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:13:56.242178 [info ] [MainThread]: 
[0m13:13:56.252038 [error] [MainThread]:   Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:13:56.260561 [info ] [MainThread]: 
[0m13:13:56.267503 [error] [MainThread]:   Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:13:56.274412 [info ] [MainThread]: 
[0m13:13:56.278527 [error] [MainThread]:   Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:13:56.281795 [info ] [MainThread]: 
[0m13:13:56.286018 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:13:56.289862 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.3534794, "process_in_blocks": "0", "process_kernel_time": 0.323327, "process_mem_max_rss": "118276", "process_out_blocks": "0", "process_user_time": 2.738183}
[0m13:13:56.292586 [debug] [MainThread]: Command `dbt test` failed at 13:13:56.292132 after 5.36 seconds
[0m13:13:56.295781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f253f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f2695a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f4140230>]}
[0m13:13:56.298193 [debug] [MainThread]: Flushing usage events
[0m13:13:59.694278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:58.462114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282a5bcc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282a748f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c0b4230>]}


============================== 13:16:58.469794 | 40178e8c-77f6-4d3a-9ef3-9d65b26876b8 ==============================
[0m13:16:58.469794 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:16:58.473172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:16:58.630118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40178e8c-77f6-4d3a-9ef3-9d65b26876b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282be37080>]}
[0m13:16:58.660456 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-eq1384vy'
[0m13:16:58.662414 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:16:59.312654 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:16:59.316300 [error] [MainThread]: Encountered an error:
Package dbt-labs/dbt_unit_testing was not found in the package index
[0m13:16:59.320722 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/deps.py", line 219, in run
    self.lock()
  File "/usr/local/lib/python3.12/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/deps/registry.py", line 98, in resolved
    self._check_in_index()
  File "/usr/local/lib/python3.12/site-packages/dbt/deps/registry.py", line 77, in _check_in_index
    raise PackageNotFoundError(self.package)
dbt.exceptions.PackageNotFoundError: Package dbt-labs/dbt_unit_testing was not found in the package index

[0m13:16:59.323363 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 1.1889267, "process_in_blocks": "0", "process_kernel_time": 0.10988, "process_mem_max_rss": "88784", "process_out_blocks": "8", "process_user_time": 1.768069}
[0m13:16:59.325376 [debug] [MainThread]: Command `dbt deps` failed at 13:16:59.325199 after 1.19 seconds
[0m13:16:59.327277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282acf3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2829ff53a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2829f62c60>]}
[0m13:16:59.329865 [debug] [MainThread]: Flushing usage events
[0m13:17:00.229451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:18.607734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c0241c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c02a82030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c0241e3f0>]}


============================== 13:18:18.612396 | e9a1d291-a6cc-4cfb-8249-f5ad9940c55e ==============================
[0m13:18:18.612396 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:18:18.614183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:18.859226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9a1d291-a6cc-4cfb-8249-f5ad9940c55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c01eefa40>]}
[0m13:18:18.935333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9a1d291-a6cc-4cfb-8249-f5ad9940c55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c02192300>]}
[0m13:18:18.937797 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:18:19.037934 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:18:21.035135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:21.037220 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://tests/test_standardize_payment_type.sql
[0m13:18:21.279612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:18:21.297082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9a1d291-a6cc-4cfb-8249-f5ad9940c55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c02c8e960>]}
[0m13:18:21.460926 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:18:21.468802 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:18:21.520060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9a1d291-a6cc-4cfb-8249-f5ad9940c55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bffe25250>]}
[0m13:18:21.521311 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:18:21.522802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9a1d291-a6cc-4cfb-8249-f5ad9940c55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c001ec3e0>]}
[0m13:18:21.526385 [info ] [MainThread]: 
[0m13:18:21.527800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:21.529428 [info ] [MainThread]: 
[0m13:18:21.531634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:18:21.535367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public'
[0m13:18:21.577169 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:18:21.579358 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:18:21.581041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:21.589708 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:18:21.591488 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:18:21.593350 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:18:21.597969 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:18:21.601686 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:18:21.605116 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:18:21.608728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:18:21.620639 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:18:21.623369 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:18:21.626466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:21.641927 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:18:21.646400 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:18:21.651202 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:18:21.663470 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m13:18:21.669809 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:18:21.675799 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:18:21.682355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:18:21.697360 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:18:21.700367 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:18:21.704655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:21.717296 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:18:21.719236 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:18:21.721181 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:18:21.726228 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:18:21.730661 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:18:21.734051 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:18:21.745006 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:21.748768 [debug] [MainThread]: On master: BEGIN
[0m13:18:21.752803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:21.769174 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m13:18:21.772489 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:21.776295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:18:21.792947 [debug] [MainThread]: SQL status: SELECT 12 in 0.013 seconds
[0m13:18:21.800237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9a1d291-a6cc-4cfb-8249-f5ad9940c55e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c005e9cd0>]}
[0m13:18:21.804218 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:21.808779 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:21.813159 [debug] [MainThread]: On master: BEGIN
[0m13:18:21.818060 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:18:21.821537 [debug] [MainThread]: On master: COMMIT
[0m13:18:21.825462 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:21.829308 [debug] [MainThread]: On master: COMMIT
[0m13:18:21.834219 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:18:21.838358 [debug] [MainThread]: On master: Close
[0m13:18:21.844542 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:18:21.847349 [info ] [Thread-1 (]: 1 of 3 START test test_calculate_tip_rate ...................................... [RUN]
[0m13:18:21.849666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:18:21.851481 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:18:21.865183 [debug] [Thread-1 (]: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:18:21.866955 [error] [Thread-1 (]: 1 of 3 ERROR test_calculate_tip_rate ........................................... [[31mERROR[0m in 0.02s]
[0m13:18:21.869287 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:18:21.870869 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:18:21.871655 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_calculate_tip_rate' to be skipped because of status 'error'.  Reason: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:18:21.872952 [info ] [Thread-1 (]: 2 of 3 START test test_is_valid_trip ........................................... [RUN]
[0m13:18:21.876392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:18:21.877669 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:18:21.883627 [debug] [Thread-1 (]: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:18:21.885346 [error] [Thread-1 (]: 2 of 3 ERROR test_is_valid_trip ................................................ [[31mERROR[0m in 0.01s]
[0m13:18:21.888389 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:18:21.890074 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:18:21.890753 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_is_valid_trip' to be skipped because of status 'error'.  Reason: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:18:21.891718 [info ] [Thread-1 (]: 3 of 3 START test test_standardize_payment_type ................................ [RUN]
[0m13:18:21.894303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:18:21.896475 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:18:21.902754 [debug] [Thread-1 (]: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'standardize_payment_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:18:21.905013 [error] [Thread-1 (]: 3 of 3 ERROR test_standardize_payment_type ..................................... [[31mERROR[0m in 0.01s]
[0m13:18:21.907337 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:18:21.908787 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_standardize_payment_type' to be skipped because of status 'error'.  Reason: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'standardize_payment_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:18:21.910984 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:21.912520 [debug] [MainThread]: On master: BEGIN
[0m13:18:21.914322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:18:21.922355 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:18:21.924406 [debug] [MainThread]: On master: COMMIT
[0m13:18:21.926482 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:21.928215 [debug] [MainThread]: On master: COMMIT
[0m13:18:21.930512 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:18:21.932630 [debug] [MainThread]: On master: Close
[0m13:18:21.934273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:21.935831 [debug] [MainThread]: Connection 'test.my_dbt_project.test_standardize_payment_type' was properly closed.
[0m13:18:21.938482 [info ] [MainThread]: 
[0m13:18:21.940259 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m13:18:21.943168 [debug] [MainThread]: Command end result
[0m13:18:22.015914 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:18:22.026104 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:18:22.042089 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:18:22.043774 [info ] [MainThread]: 
[0m13:18:22.045730 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:18:22.047092 [info ] [MainThread]: 
[0m13:18:22.048260 [error] [MainThread]:   Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:18:22.049611 [info ] [MainThread]: 
[0m13:18:22.051032 [error] [MainThread]:   Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:18:22.052421 [info ] [MainThread]: 
[0m13:18:22.053733 [error] [MainThread]:   Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'standardize_payment_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:18:22.055117 [info ] [MainThread]: 
[0m13:18:22.056468 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:18:22.059601 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.582652, "process_in_blocks": "0", "process_kernel_time": 0.211207, "process_mem_max_rss": "111316", "process_out_blocks": "0", "process_user_time": 2.524435}
[0m13:18:22.062269 [debug] [MainThread]: Command `dbt test` failed at 13:18:22.062008 after 3.59 seconds
[0m13:18:22.063813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c01ec5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c02499670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c0249a9c0>]}
[0m13:18:22.066246 [debug] [MainThread]: Flushing usage events
[0m13:18:23.100506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:21.367000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaffe41490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafffb2e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb019385c0>]}


============================== 13:19:21.371474 | 43708393-457d-4a60-98a8-65ea9897f650 ==============================
[0m13:19:21.371474 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:19:21.373207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:19:21.591582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43708393-457d-4a60-98a8-65ea9897f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb003fa660>]}
[0m13:19:21.667846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43708393-457d-4a60-98a8-65ea9897f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaffd78c80>]}
[0m13:19:21.672074 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:19:21.793058 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:19:22.846989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:19:22.848123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:19:22.854355 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:19:22.911859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43708393-457d-4a60-98a8-65ea9897f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb0042cb00>]}
[0m13:19:23.085309 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:19:23.097212 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:19:23.151453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43708393-457d-4a60-98a8-65ea9897f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafd87dcd0>]}
[0m13:19:23.154066 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:19:23.155934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43708393-457d-4a60-98a8-65ea9897f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafdc9d5b0>]}
[0m13:19:23.160064 [info ] [MainThread]: 
[0m13:19:23.162290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:23.164642 [info ] [MainThread]: 
[0m13:19:23.167168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:19:23.170448 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public_marts'
[0m13:19:23.209065 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:19:23.212145 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:19:23.215730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:23.225918 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:19:23.228063 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:19:23.230956 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:19:23.235631 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:19:23.239796 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:19:23.242490 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:19:23.244813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public)
[0m13:19:23.249185 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:19:23.251902 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:19:23.254822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:23.267931 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:19:23.271331 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:19:23.274797 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:19:23.284235 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.006 seconds
[0m13:19:23.293016 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:19:23.296246 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:19:23.299357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:19:23.311859 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:19:23.314220 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:19:23.317143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:23.328122 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:19:23.329881 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:19:23.332392 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:19:23.336169 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:19:23.339131 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:19:23.340942 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:19:23.348082 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:23.349497 [debug] [MainThread]: On master: BEGIN
[0m13:19:23.351394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:23.359143 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:19:23.360949 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:23.362745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:19:23.374602 [debug] [MainThread]: SQL status: SELECT 12 in 0.010 seconds
[0m13:19:23.380190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43708393-457d-4a60-98a8-65ea9897f650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafdc8a480>]}
[0m13:19:23.381921 [debug] [MainThread]: On master: ROLLBACK
[0m13:19:23.383871 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:23.385403 [debug] [MainThread]: On master: BEGIN
[0m13:19:23.387320 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:19:23.389027 [debug] [MainThread]: On master: COMMIT
[0m13:19:23.390799 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:23.392519 [debug] [MainThread]: On master: COMMIT
[0m13:19:23.394865 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:19:23.397317 [debug] [MainThread]: On master: Close
[0m13:19:23.402286 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:19:23.404295 [info ] [Thread-1 (]: 1 of 3 START test test_calculate_tip_rate ...................................... [RUN]
[0m13:19:23.405713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:19:23.407222 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:19:23.420435 [debug] [Thread-1 (]: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:19:23.422406 [error] [Thread-1 (]: 1 of 3 ERROR test_calculate_tip_rate ........................................... [[31mERROR[0m in 0.02s]
[0m13:19:23.423963 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:19:23.425236 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:19:23.425816 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_calculate_tip_rate' to be skipped because of status 'error'.  Reason: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:19:23.427038 [info ] [Thread-1 (]: 2 of 3 START test test_is_valid_trip ........................................... [RUN]
[0m13:19:23.429908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:19:23.431103 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:19:23.439979 [debug] [Thread-1 (]: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:19:23.441816 [error] [Thread-1 (]: 2 of 3 ERROR test_is_valid_trip ................................................ [[31mERROR[0m in 0.01s]
[0m13:19:23.443917 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:19:23.445549 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:19:23.446475 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_is_valid_trip' to be skipped because of status 'error'.  Reason: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:19:23.447729 [info ] [Thread-1 (]: 3 of 3 START test test_standardize_payment_type ................................ [RUN]
[0m13:19:23.451066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:19:23.452250 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:19:23.458809 [debug] [Thread-1 (]: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'standardize_payment_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:19:23.460376 [error] [Thread-1 (]: 3 of 3 ERROR test_standardize_payment_type ..................................... [[31mERROR[0m in 0.01s]
[0m13:19:23.462928 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:19:23.465011 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_standardize_payment_type' to be skipped because of status 'error'.  Reason: Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'standardize_payment_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:19:23.468128 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:23.469890 [debug] [MainThread]: On master: BEGIN
[0m13:19:23.471333 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:23.479059 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:19:23.480656 [debug] [MainThread]: On master: COMMIT
[0m13:19:23.482087 [debug] [MainThread]: Using postgres connection "master"
[0m13:19:23.483481 [debug] [MainThread]: On master: COMMIT
[0m13:19:23.485287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:19:23.486904 [debug] [MainThread]: On master: Close
[0m13:19:23.488412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:23.489403 [debug] [MainThread]: Connection 'test.my_dbt_project.test_standardize_payment_type' was properly closed.
[0m13:19:23.490757 [info ] [MainThread]: 
[0m13:19:23.492072 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m13:19:23.494055 [debug] [MainThread]: Command end result
[0m13:19:23.572289 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:19:23.587039 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:19:23.608243 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:19:23.610736 [info ] [MainThread]: 
[0m13:19:23.612788 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:19:23.614086 [info ] [MainThread]: 
[0m13:19:23.615543 [error] [MainThread]:   Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:19:23.616682 [info ] [MainThread]: 
[0m13:19:23.617948 [error] [MainThread]:   Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:19:23.619563 [info ] [MainThread]: 
[0m13:19:23.621321 [error] [MainThread]:   Compilation Error in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)
  'standardize_payment_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:19:23.622964 [info ] [MainThread]: 
[0m13:19:23.624261 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:19:23.626988 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.4315035, "process_in_blocks": "0", "process_kernel_time": 0.206656, "process_mem_max_rss": "111136", "process_out_blocks": "0", "process_user_time": 2.342108}
[0m13:19:23.629888 [debug] [MainThread]: Command `dbt test` failed at 13:19:23.629404 after 2.43 seconds
[0m13:19:23.631978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaff9258e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaff925a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaff925b20>]}
[0m13:19:23.633815 [debug] [MainThread]: Flushing usage events
[0m13:19:26.628543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:20.098754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2756457920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27567f3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2756455d00>]}


============================== 13:21:20.103006 | d459c45b-4d3b-4684-9ad3-c22cd4fae95a ==============================
[0m13:21:20.103006 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:21:20.104656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:21:20.316284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd459c45b-4d3b-4684-9ad3-c22cd4fae95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2756455d00>]}
[0m13:21:20.390673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd459c45b-4d3b-4684-9ad3-c22cd4fae95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2756cf3560>]}
[0m13:21:20.393321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:21:20.498714 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:21:22.267425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:21:22.268583 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://tests/test_standardize_payment_type.sql
[0m13:21:22.506943 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:21:22.522893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd459c45b-4d3b-4684-9ad3-c22cd4fae95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2754b0f680>]}
[0m13:21:22.707158 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:21:22.763225 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:21:22.840173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd459c45b-4d3b-4684-9ad3-c22cd4fae95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27543892b0>]}
[0m13:21:22.854489 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:21:22.856030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd459c45b-4d3b-4684-9ad3-c22cd4fae95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2754714a70>]}
[0m13:21:22.859987 [info ] [MainThread]: 
[0m13:21:22.861394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:22.862930 [info ] [MainThread]: 
[0m13:21:22.864819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:22.868547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public_staging'
[0m13:21:22.905298 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:21:22.906874 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:21:22.907944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:22.915169 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:21:22.916290 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:21:22.917594 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:21:22.921197 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:22.923372 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:21:22.924589 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:21:22.926109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:21:22.928962 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:21:22.930066 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:21:22.931172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:22.937581 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:21:22.938801 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:21:22.940458 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:21:22.943611 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:21:22.945825 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:21:22.946992 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:21:22.948517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public)
[0m13:21:22.952554 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:21:22.953919 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:21:22.954948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:22.960651 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:21:22.961760 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:21:22.962983 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:21:22.966305 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:21:22.969175 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:21:22.970302 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:21:22.980323 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:22.981851 [debug] [MainThread]: On master: BEGIN
[0m13:21:22.983343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:22.989537 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:21:22.990880 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:22.992214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:23.001533 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:21:23.006436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd459c45b-4d3b-4684-9ad3-c22cd4fae95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f275386eab0>]}
[0m13:21:23.007856 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:23.009919 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:23.011503 [debug] [MainThread]: On master: BEGIN
[0m13:21:23.013647 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:23.015000 [debug] [MainThread]: On master: COMMIT
[0m13:21:23.016439 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:23.017706 [debug] [MainThread]: On master: COMMIT
[0m13:21:23.019913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:23.021778 [debug] [MainThread]: On master: Close
[0m13:21:23.025909 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:21:23.027151 [info ] [Thread-1 (]: 1 of 3 START test test_calculate_tip_rate ...................................... [RUN]
[0m13:21:23.028278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:21:23.029447 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:21:23.040580 [debug] [Thread-1 (]: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:23.042524 [error] [Thread-1 (]: 1 of 3 ERROR test_calculate_tip_rate ........................................... [[31mERROR[0m in 0.01s]
[0m13:21:23.047087 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:21:23.049125 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:21:23.049719 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_calculate_tip_rate' to be skipped because of status 'error'.  Reason: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:21:23.050656 [info ] [Thread-1 (]: 2 of 3 START test test_is_valid_trip ........................................... [RUN]
[0m13:21:23.053882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:21:23.054966 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:21:23.061413 [debug] [Thread-1 (]: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:23.063225 [error] [Thread-1 (]: 2 of 3 ERROR test_is_valid_trip ................................................ [[31mERROR[0m in 0.01s]
[0m13:21:23.064619 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:21:23.066054 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:21:23.066701 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_is_valid_trip' to be skipped because of status 'error'.  Reason: Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:21:23.067799 [info ] [Thread-1 (]: 3 of 3 START test test_standardize_payment_type ................................ [RUN]
[0m13:21:23.070100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:21:23.071474 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:21:23.076587 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:21:23.089575 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m13:21:23.108270 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:21:23.121394 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:21:23.122593 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: BEGIN
[0m13:21:23.123956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:23.129984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:21:23.131321 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:21:23.132589 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_standardize_payment_type"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_standardize_payment_type.sql

with test_data as (
    select 1 as payment_type, 'Credit card' as expected_label
    union all
    select 3, 'No charge'
    union all
    select 6, 'Voided trip'
),

actual as (
    select
        payment_type,
        
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as actual_label,
        expected_label
    from test_data
)

select *
from actual
where actual_label != expected_label
      
    ) dbt_internal_test
[0m13:21:23.135262 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:21:23.140479 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: ROLLBACK
[0m13:21:23.142185 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: Close
[0m13:21:23.143752 [error] [Thread-1 (]: 3 of 3 FAIL 3 test_standardize_payment_type .................................... [[31mFAIL 3[0m in 0.07s]
[0m13:21:23.145587 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:21:23.147883 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:23.148831 [debug] [MainThread]: On master: BEGIN
[0m13:21:23.149716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:23.155032 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:21:23.156181 [debug] [MainThread]: On master: COMMIT
[0m13:21:23.157198 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:23.158469 [debug] [MainThread]: On master: COMMIT
[0m13:21:23.159931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:23.161293 [debug] [MainThread]: On master: Close
[0m13:21:23.162913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:23.164119 [debug] [MainThread]: Connection 'test.my_dbt_project.test_standardize_payment_type' was properly closed.
[0m13:21:23.165467 [info ] [MainThread]: 
[0m13:21:23.166903 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:21:23.168676 [debug] [MainThread]: Command end result
[0m13:21:23.217135 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:21:23.223421 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:21:23.235586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:21:23.236555 [info ] [MainThread]: 
[0m13:21:23.237717 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:21:23.239274 [info ] [MainThread]: 
[0m13:21:23.240628 [error] [MainThread]:   Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:23.241918 [info ] [MainThread]: 
[0m13:21:23.243459 [error] [MainThread]:   Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:21:23.245139 [info ] [MainThread]: 
[0m13:21:23.246888 [error] [MainThread]: [31mFailure in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)[0m
[0m13:21:23.248690 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m13:21:23.250796 [info ] [MainThread]: 
[0m13:21:23.252729 [info ] [MainThread]:   compiled code at target/compiled/my_dbt_project/tests/test_standardize_payment_type.sql
[0m13:21:23.254194 [info ] [MainThread]: 
[0m13:21:23.255333 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:21:23.257451 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.2921023, "process_in_blocks": "0", "process_kernel_time": 0.157776, "process_mem_max_rss": "112028", "process_out_blocks": "0", "process_user_time": 2.514562}
[0m13:21:23.258981 [debug] [MainThread]: Command `dbt test` failed at 13:21:23.258826 after 3.29 seconds
[0m13:21:23.259950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2756967020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2756e48290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2756e48740>]}
[0m13:21:23.261009 [debug] [MainThread]: Flushing usage events
[0m13:21:25.800448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:31.459630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f085a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ee950380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f08e3bf0>]}


============================== 13:24:31.468894 | 8daedf7c-bd67-4baf-83c8-8aff0384e423 ==============================
[0m13:24:31.468894 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:24:31.473815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:24:31.706772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8daedf7c-bd67-4baf-83c8-8aff0384e423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ee787bf0>]}
[0m13:24:31.775336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8daedf7c-bd67-4baf-83c8-8aff0384e423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3eec22db0>]}
[0m13:24:31.778895 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:31.902709 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:24:33.037811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:24:33.039158 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://tests/test_is_valid_trip.sql
[0m13:24:33.261566 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:24:33.277573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8daedf7c-bd67-4baf-83c8-8aff0384e423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ecc7b980>]}
[0m13:24:33.435691 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:24:33.442764 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:24:33.485733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8daedf7c-bd67-4baf-83c8-8aff0384e423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ec854f50>]}
[0m13:24:33.487138 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:24:33.488837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8daedf7c-bd67-4baf-83c8-8aff0384e423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ecbf7b90>]}
[0m13:24:33.492470 [info ] [MainThread]: 
[0m13:24:33.494031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:24:33.495236 [info ] [MainThread]: 
[0m13:24:33.498772 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:24:33.501859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public_staging'
[0m13:24:33.542228 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:24:33.543782 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:24:33.545098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:33.553677 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:24:33.555168 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:24:33.557129 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:24:33.561268 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:24:33.564204 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:24:33.565939 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:24:33.567408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:24:33.570825 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:24:33.572184 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:24:33.573574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:33.580308 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:24:33.582022 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:24:33.583565 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:24:33.587658 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:24:33.591103 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:24:33.593200 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:24:33.595343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:24:33.603439 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:24:33.604783 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:24:33.605865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:33.612974 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:24:33.614481 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:24:33.615741 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:24:33.619138 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:24:33.621826 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:24:33.623714 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:24:33.630362 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:33.631622 [debug] [MainThread]: On master: BEGIN
[0m13:24:33.632860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:33.639973 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:24:33.641730 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:33.642796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:24:33.652182 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:24:33.656935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8daedf7c-bd67-4baf-83c8-8aff0384e423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ee786960>]}
[0m13:24:33.658228 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:33.659476 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:33.660400 [debug] [MainThread]: On master: BEGIN
[0m13:24:33.661781 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:24:33.662923 [debug] [MainThread]: On master: COMMIT
[0m13:24:33.663944 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:33.665014 [debug] [MainThread]: On master: COMMIT
[0m13:24:33.666703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:33.668315 [debug] [MainThread]: On master: Close
[0m13:24:33.673264 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:24:33.674921 [info ] [Thread-1 (]: 1 of 3 START test test_calculate_tip_rate ...................................... [RUN]
[0m13:24:33.676391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:24:33.677477 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:24:33.690151 [debug] [Thread-1 (]: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:33.691650 [error] [Thread-1 (]: 1 of 3 ERROR test_calculate_tip_rate ........................................... [[31mERROR[0m in 0.02s]
[0m13:24:33.693266 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:24:33.694618 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:24:33.695332 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_calculate_tip_rate' to be skipped because of status 'error'.  Reason: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:24:33.696411 [info ] [Thread-1 (]: 2 of 3 START test test_is_valid_trip ........................................... [RUN]
[0m13:24:33.700545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:24:33.701872 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:24:33.706435 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_is_valid_trip"
[0m13:24:33.714406 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_is_valid_trip
[0m13:24:33.734008 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_is_valid_trip"
[0m13:24:33.743498 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_is_valid_trip"
[0m13:24:33.744524 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: BEGIN
[0m13:24:33.745410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:33.751723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:24:33.752988 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_is_valid_trip"
[0m13:24:33.754288 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_is_valid_trip"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_is_valid_trip.sql

with test_data as (
    select 1 as trip_distance, 10 as fare_amount, 1 as passenger_count,
           TIMESTAMP '2021-01-01 12:00:00' as pickup_datetime,
           TIMESTAMP '2021-01-01 12:02:00' as dropoff_datetime,
           true as expected_is_valid
    union all
    select 0, 10, 1, TIMESTAMP '2021-01-01 12:00:00', TIMESTAMP '2021-01-01 12:02:00', false
),

actual as (
    select
        *,
        
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM dropoff_datetime - pickup_datetime) > 60
 as actual_is_valid
    from test_data
)

select *
from actual
where actual_is_valid != expected_is_valid
      
    ) dbt_internal_test
[0m13:24:33.757716 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:24:33.763710 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: ROLLBACK
[0m13:24:33.765022 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: Close
[0m13:24:33.766342 [info ] [Thread-1 (]: 2 of 3 PASS test_is_valid_trip ................................................. [[32mPASS[0m in 0.07s]
[0m13:24:33.768009 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:24:33.769296 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:24:33.770346 [info ] [Thread-1 (]: 3 of 3 START test test_standardize_payment_type ................................ [RUN]
[0m13:24:33.771569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:24:33.772538 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:24:33.777000 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:24:33.785270 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m13:24:33.789508 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:24:33.797911 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:24:33.799300 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: BEGIN
[0m13:24:33.800567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:33.807017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:24:33.808411 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:24:33.810020 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_standardize_payment_type"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_standardize_payment_type.sql

with test_data as (
    select 1 as payment_type, 'Credit card' as expected_label
    union all
    select 3, 'No charge'
    union all
    select 6, 'Voided trip'
),

actual as (
    select
        payment_type,
        
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as actual_label,
        expected_label
    from test_data
)

select *
from actual
where actual_label != expected_label
      
    ) dbt_internal_test
[0m13:24:33.811971 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:33.814616 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: ROLLBACK
[0m13:24:33.816369 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: Close
[0m13:24:33.817991 [error] [Thread-1 (]: 3 of 3 FAIL 3 test_standardize_payment_type .................................... [[31mFAIL 3[0m in 0.05s]
[0m13:24:33.820139 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:24:33.822855 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:33.824279 [debug] [MainThread]: On master: BEGIN
[0m13:24:33.825796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:33.833841 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:24:33.835367 [debug] [MainThread]: On master: COMMIT
[0m13:24:33.837223 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:33.839260 [debug] [MainThread]: On master: COMMIT
[0m13:24:33.841207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:33.842724 [debug] [MainThread]: On master: Close
[0m13:24:33.844406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:33.846470 [debug] [MainThread]: Connection 'test.my_dbt_project.test_standardize_payment_type' was properly closed.
[0m13:24:33.848419 [info ] [MainThread]: 
[0m13:24:33.849956 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:24:33.852416 [debug] [MainThread]: Command end result
[0m13:24:33.924886 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:24:33.940422 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:24:33.981211 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:24:33.984474 [info ] [MainThread]: 
[0m13:24:33.990915 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:24:33.997087 [info ] [MainThread]: 
[0m13:24:34.002403 [error] [MainThread]:   Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:34.009627 [info ] [MainThread]: 
[0m13:24:34.015516 [error] [MainThread]: [31mFailure in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)[0m
[0m13:24:34.022199 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m13:24:34.027191 [info ] [MainThread]: 
[0m13:24:34.031973 [info ] [MainThread]:   compiled code at target/compiled/my_dbt_project/tests/test_standardize_payment_type.sql
[0m13:24:34.037496 [info ] [MainThread]: 
[0m13:24:34.040916 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m13:24:34.045478 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.741702, "process_in_blocks": "0", "process_kernel_time": 0.239199, "process_mem_max_rss": "111848", "process_out_blocks": "0", "process_user_time": 2.461761}
[0m13:24:34.048836 [debug] [MainThread]: Command `dbt test` failed at 13:24:34.048453 after 2.75 seconds
[0m13:24:34.051504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ef1e75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ef3144d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ef314da0>]}
[0m13:24:34.054756 [debug] [MainThread]: Flushing usage events
[0m13:24:36.414291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:43.163369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb546c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb575b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb4cb7560>]}


============================== 13:24:43.167976 | 45b175f1-bbb1-4adf-9b23-08e981cfedbd ==============================
[0m13:24:43.167976 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:24:43.169463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:24:43.399119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45b175f1-bbb1-4adf-9b23-08e981cfedbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb46d9af0>]}
[0m13:24:43.469709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45b175f1-bbb1-4adf-9b23-08e981cfedbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb5039df0>]}
[0m13:24:43.472966 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:43.599572 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:24:45.515307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:45.516307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:45.522789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:24:45.587179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45b175f1-bbb1-4adf-9b23-08e981cfedbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb2d2b410>]}
[0m13:24:45.715133 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:24:45.721795 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:24:45.757014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45b175f1-bbb1-4adf-9b23-08e981cfedbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb2af5a90>]}
[0m13:24:45.758484 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 551 macros
[0m13:24:45.759693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45b175f1-bbb1-4adf-9b23-08e981cfedbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb28b48f0>]}
[0m13:24:45.763205 [info ] [MainThread]: 
[0m13:24:45.764932 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:24:45.766820 [info ] [MainThread]: 
[0m13:24:45.769210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:24:45.775544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public'
[0m13:24:45.816793 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:24:45.818108 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:24:45.819174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:45.825869 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:24:45.827140 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:24:45.828198 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:24:45.831388 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:24:45.834152 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:24:45.835422 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:24:45.837151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:24:45.843997 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:24:45.845718 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:24:45.847570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:45.855280 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:24:45.857498 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:24:45.859472 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:24:45.864122 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:24:45.867333 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:24:45.869495 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:24:45.872169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:24:45.876346 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:24:45.877848 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:24:45.879719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:45.886965 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:24:45.888586 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:24:45.889812 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:24:45.893991 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:24:45.896666 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:24:45.899510 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:24:45.905944 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:45.907838 [debug] [MainThread]: On master: BEGIN
[0m13:24:45.909420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:45.916354 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:24:45.918326 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:45.920067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:24:45.929540 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:24:45.934304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45b175f1-bbb1-4adf-9b23-08e981cfedbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb1d07dd0>]}
[0m13:24:45.935890 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:45.937514 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:45.938606 [debug] [MainThread]: On master: BEGIN
[0m13:24:45.940967 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:24:45.941889 [debug] [MainThread]: On master: COMMIT
[0m13:24:45.942825 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:45.943731 [debug] [MainThread]: On master: COMMIT
[0m13:24:45.944998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:45.946390 [debug] [MainThread]: On master: Close
[0m13:24:45.950126 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:24:45.951866 [info ] [Thread-1 (]: 1 of 3 START test test_calculate_tip_rate ...................................... [RUN]
[0m13:24:45.953635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:24:45.955089 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:24:45.966597 [debug] [Thread-1 (]: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:45.968787 [error] [Thread-1 (]: 1 of 3 ERROR test_calculate_tip_rate ........................................... [[31mERROR[0m in 0.02s]
[0m13:24:45.970189 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:24:45.971537 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:24:45.972183 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.test_calculate_tip_rate' to be skipped because of status 'error'.  Reason: Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:24:45.973556 [info ] [Thread-1 (]: 2 of 3 START test test_is_valid_trip ........................................... [RUN]
[0m13:24:45.981802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:24:45.983228 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:24:45.989357 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_is_valid_trip"
[0m13:24:45.998867 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_is_valid_trip
[0m13:24:46.020437 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_is_valid_trip"
[0m13:24:46.026310 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_is_valid_trip"
[0m13:24:46.027530 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: BEGIN
[0m13:24:46.028444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:46.034256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:24:46.035441 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_is_valid_trip"
[0m13:24:46.036472 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_is_valid_trip"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_is_valid_trip.sql

with test_data as (
    select 1 as trip_distance, 10 as fare_amount, 1 as passenger_count,
           TIMESTAMP '2021-01-01 12:00:00' as pickup_datetime,
           TIMESTAMP '2021-01-01 12:02:00' as dropoff_datetime,
           true as expected_is_valid
    union all
    select 0, 10, 1, TIMESTAMP '2021-01-01 12:00:00', TIMESTAMP '2021-01-01 12:02:00', false
),

actual as (
    select
        *,
        
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM dropoff_datetime - pickup_datetime) > 60
 as actual_is_valid
    from test_data
)

select *
from actual
where actual_is_valid != expected_is_valid
      
    ) dbt_internal_test
[0m13:24:46.038446 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:46.043661 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: ROLLBACK
[0m13:24:46.045037 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: Close
[0m13:24:46.046353 [info ] [Thread-1 (]: 2 of 3 PASS test_is_valid_trip ................................................. [[32mPASS[0m in 0.06s]
[0m13:24:46.048076 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:24:46.049327 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:24:46.050341 [info ] [Thread-1 (]: 3 of 3 START test test_standardize_payment_type ................................ [RUN]
[0m13:24:46.051868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:24:46.053328 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:24:46.058313 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:24:46.067724 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m13:24:46.071462 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:24:46.079734 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:24:46.081141 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: BEGIN
[0m13:24:46.082261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:46.088238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:24:46.089458 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:24:46.090360 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_standardize_payment_type"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_standardize_payment_type.sql

with test_data as (
    select 1 as payment_type, 'Credit card' as expected_label
    union all
    select 3, 'No charge'
    union all
    select 6, 'Voided trip'
),

actual as (
    select
        payment_type,
        
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as actual_label,
        expected_label
    from test_data
)

select *
from actual
where actual_label != expected_label
      
    ) dbt_internal_test
[0m13:24:46.092262 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:46.094350 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: ROLLBACK
[0m13:24:46.095404 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: Close
[0m13:24:46.096573 [error] [Thread-1 (]: 3 of 3 FAIL 3 test_standardize_payment_type .................................... [[31mFAIL 3[0m in 0.04s]
[0m13:24:46.097954 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:24:46.100121 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:46.101023 [debug] [MainThread]: On master: BEGIN
[0m13:24:46.101891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:46.107429 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:24:46.108590 [debug] [MainThread]: On master: COMMIT
[0m13:24:46.109690 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:46.110599 [debug] [MainThread]: On master: COMMIT
[0m13:24:46.111832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:46.112886 [debug] [MainThread]: On master: Close
[0m13:24:46.114151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:46.115384 [debug] [MainThread]: Connection 'test.my_dbt_project.test_standardize_payment_type' was properly closed.
[0m13:24:46.116486 [info ] [MainThread]: 
[0m13:24:46.118117 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:24:46.122640 [debug] [MainThread]: Command end result
[0m13:24:46.179127 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:24:46.184942 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:24:46.197133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:24:46.198702 [info ] [MainThread]: 
[0m13:24:46.200497 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:24:46.202064 [info ] [MainThread]: 
[0m13:24:46.203438 [error] [MainThread]:   Compilation Error in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)
  'dict object' has no attribute 'unit_test'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:46.204612 [info ] [MainThread]: 
[0m13:24:46.205825 [error] [MainThread]: [31mFailure in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)[0m
[0m13:24:46.207129 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m13:24:46.208531 [info ] [MainThread]: 
[0m13:24:46.210322 [info ] [MainThread]:   compiled code at target/compiled/my_dbt_project/tests/test_standardize_payment_type.sql
[0m13:24:46.212280 [info ] [MainThread]: 
[0m13:24:46.214098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m13:24:46.216511 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.1844957, "process_in_blocks": "0", "process_kernel_time": 0.194218, "process_mem_max_rss": "110628", "process_out_blocks": "0", "process_user_time": 2.330626}
[0m13:24:46.218966 [debug] [MainThread]: Command `dbt test` failed at 13:24:46.218624 after 3.19 seconds
[0m13:24:46.220171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb5268290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb4e57800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb4a42ea0>]}
[0m13:24:46.221549 [debug] [MainThread]: Flushing usage events
[0m13:24:47.859274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:24.572375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b668f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b680c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b67b9610>]}


============================== 13:27:24.577973 | 4f6975a2-33e0-4481-85a6-e285e11b53db ==============================
[0m13:27:24.577973 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:27:24.580078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:27:24.819063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f6975a2-33e0-4481-85a6-e285e11b53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b7e43170>]}
[0m13:27:24.890869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f6975a2-33e0-4481-85a6-e285e11b53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b66275f0>]}
[0m13:27:24.893924 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:27:25.005001 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:27:26.638895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:26.640129 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://tests/test_calculate_tip_rate.sql
[0m13:27:26.941790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:27:26.962302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f6975a2-33e0-4481-85a6-e285e11b53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b48459d0>]}
[0m13:27:27.153795 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:27:27.163944 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:27:27.210973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f6975a2-33e0-4481-85a6-e285e11b53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b40d13d0>]}
[0m13:27:27.212573 [info ] [MainThread]: Found 1 seed, 2 models, 3 data tests, 12 sources, 551 macros
[0m13:27:27.214053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f6975a2-33e0-4481-85a6-e285e11b53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b40a5a60>]}
[0m13:27:27.218113 [info ] [MainThread]: 
[0m13:27:27.219662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:27.221309 [info ] [MainThread]: 
[0m13:27:27.225054 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:27:27.229062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public'
[0m13:27:27.266036 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:27:27.267549 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:27:27.269516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:27.278757 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:27:27.280464 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:27:27.281695 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:27:27.285962 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:27:27.290543 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:27:27.293812 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:27:27.297536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:27:27.307082 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:27:27.309288 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:27:27.312361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:27.320957 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:27:27.323828 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:27:27.326923 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:27:27.333804 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:27:27.339009 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:27:27.342010 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:27:27.344629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:27:27.351307 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:27:27.353506 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:27:27.355739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:27.366562 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:27:27.368813 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:27:27.371203 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:27:27.376263 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:27:27.380068 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:27:27.383340 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:27:27.393068 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:27.395699 [debug] [MainThread]: On master: BEGIN
[0m13:27:27.398882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:27.417920 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:27:27.421024 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:27.423492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:27:27.439539 [debug] [MainThread]: SQL status: SELECT 12 in 0.013 seconds
[0m13:27:27.445092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f6975a2-33e0-4481-85a6-e285e11b53db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b44596d0>]}
[0m13:27:27.447096 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:27.449032 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:27.450587 [debug] [MainThread]: On master: BEGIN
[0m13:27:27.452950 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:27:27.454840 [debug] [MainThread]: On master: COMMIT
[0m13:27:27.456607 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:27.458986 [debug] [MainThread]: On master: COMMIT
[0m13:27:27.461025 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:27:27.463076 [debug] [MainThread]: On master: Close
[0m13:27:27.467040 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:27:27.469085 [info ] [Thread-1 (]: 1 of 3 START test test_calculate_tip_rate ...................................... [RUN]
[0m13:27:27.470866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:27:27.472322 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:27:27.482336 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_calculate_tip_rate"
[0m13:27:27.500966 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_calculate_tip_rate
[0m13:27:27.522312 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_calculate_tip_rate"
[0m13:27:27.542652 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_calculate_tip_rate"
[0m13:27:27.544706 [debug] [Thread-1 (]: On test.my_dbt_project.test_calculate_tip_rate: BEGIN
[0m13:27:27.546324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:27.554221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:27:27.556861 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_calculate_tip_rate"
[0m13:27:27.559544 [debug] [Thread-1 (]: On test.my_dbt_project.test_calculate_tip_rate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_calculate_tip_rate"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_calculate_tip_rate.sql

with test_data as (
    select 5 as tip_amount, 10 as fare_amount, 0.5 as expected_tip_rate
    union all
    select 3, 0, NULL
    union all
    select NULL, 15, NULL
),

actual as (
    select
        *,
        
    CASE 
        WHEN fare_amount > 0 THEN ROUND(tip_amount / fare_amount, 2)
        ELSE NULL
    END
 as actual_tip_rate
    from test_data
)

select *
from actual
where not (
    (actual_tip_rate = expected_tip_rate)
    or (actual_tip_rate is null and expected_tip_rate is null)
)
      
    ) dbt_internal_test
[0m13:27:27.565569 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:27:27.573091 [debug] [Thread-1 (]: On test.my_dbt_project.test_calculate_tip_rate: ROLLBACK
[0m13:27:27.576536 [debug] [Thread-1 (]: On test.my_dbt_project.test_calculate_tip_rate: Close
[0m13:27:27.580934 [error] [Thread-1 (]: 1 of 3 FAIL 1 test_calculate_tip_rate .......................................... [[31mFAIL 1[0m in 0.11s]
[0m13:27:27.583566 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:27:27.585632 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:27:27.587122 [info ] [Thread-1 (]: 2 of 3 START test test_is_valid_trip ........................................... [RUN]
[0m13:27:27.588962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:27:27.590581 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:27:27.597994 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_is_valid_trip"
[0m13:27:27.616117 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_is_valid_trip
[0m13:27:27.621470 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_is_valid_trip"
[0m13:27:27.651256 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_is_valid_trip"
[0m13:27:27.655734 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: BEGIN
[0m13:27:27.658942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:27.677751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:27:27.682484 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_is_valid_trip"
[0m13:27:27.686075 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_is_valid_trip"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_is_valid_trip.sql

with test_data as (
    select 1 as trip_distance, 10 as fare_amount, 1 as passenger_count,
           TIMESTAMP '2021-01-01 12:00:00' as pickup_datetime,
           TIMESTAMP '2021-01-01 12:02:00' as dropoff_datetime,
           true as expected_is_valid
    union all
    select 0, 10, 1, TIMESTAMP '2021-01-01 12:00:00', TIMESTAMP '2021-01-01 12:02:00', false
),

actual as (
    select
        *,
        
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM dropoff_datetime - pickup_datetime) > 60
 as actual_is_valid
    from test_data
)

select *
from actual
where actual_is_valid != expected_is_valid
      
    ) dbt_internal_test
[0m13:27:27.692189 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:27:27.697496 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: ROLLBACK
[0m13:27:27.701184 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: Close
[0m13:27:27.704825 [info ] [Thread-1 (]: 2 of 3 PASS test_is_valid_trip ................................................. [[32mPASS[0m in 0.12s]
[0m13:27:27.708318 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:27:27.710999 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:27:27.713092 [info ] [Thread-1 (]: 3 of 3 START test test_standardize_payment_type ................................ [RUN]
[0m13:27:27.715247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:27:27.717725 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:27:27.724604 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:27:27.749521 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m13:27:27.754436 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:27:27.776883 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:27:27.779794 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: BEGIN
[0m13:27:27.782959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:27.798049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:27:27.801105 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:27:27.803271 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_standardize_payment_type"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_standardize_payment_type.sql

with test_data as (
    select 1 as payment_type, 'Credit card' as expected_label
    union all
    select 3, 'No charge'
    union all
    select 6, 'Voided trip'
),

actual as (
    select
        payment_type,
        
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as actual_label,
        expected_label
    from test_data
)

select *
from actual
where actual_label != expected_label
      
    ) dbt_internal_test
[0m13:27:27.806782 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:27:27.811593 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: ROLLBACK
[0m13:27:27.814228 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: Close
[0m13:27:27.816867 [error] [Thread-1 (]: 3 of 3 FAIL 3 test_standardize_payment_type .................................... [[31mFAIL 3[0m in 0.10s]
[0m13:27:27.818701 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:27:27.821393 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:27.822502 [debug] [MainThread]: On master: BEGIN
[0m13:27:27.823872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:27.831599 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:27:27.833716 [debug] [MainThread]: On master: COMMIT
[0m13:27:27.835676 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:27.837837 [debug] [MainThread]: On master: COMMIT
[0m13:27:27.840627 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:27:27.842213 [debug] [MainThread]: On master: Close
[0m13:27:27.844531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:27.846711 [debug] [MainThread]: Connection 'test.my_dbt_project.test_standardize_payment_type' was properly closed.
[0m13:27:27.848566 [info ] [MainThread]: 
[0m13:27:27.850413 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m13:27:27.852839 [debug] [MainThread]: Command end result
[0m13:27:27.925165 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:27:27.932520 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:27:27.947756 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:27:27.949667 [info ] [MainThread]: 
[0m13:27:27.950997 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:27:27.952485 [info ] [MainThread]: 
[0m13:27:27.953756 [error] [MainThread]: [31mFailure in test test_calculate_tip_rate (tests/test_calculate_tip_rate.sql)[0m
[0m13:27:27.955121 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:27:27.956367 [info ] [MainThread]: 
[0m13:27:27.957798 [info ] [MainThread]:   compiled code at target/compiled/my_dbt_project/tests/test_calculate_tip_rate.sql
[0m13:27:27.959598 [info ] [MainThread]: 
[0m13:27:27.961497 [error] [MainThread]: [31mFailure in test test_standardize_payment_type (tests/test_standardize_payment_type.sql)[0m
[0m13:27:27.963188 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m13:27:27.964621 [info ] [MainThread]: 
[0m13:27:27.966260 [info ] [MainThread]:   compiled code at target/compiled/my_dbt_project/tests/test_standardize_payment_type.sql
[0m13:27:27.968496 [info ] [MainThread]: 
[0m13:27:27.970078 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m13:27:27.972454 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.5584385, "process_in_blocks": "0", "process_kernel_time": 0.287789, "process_mem_max_rss": "111112", "process_out_blocks": "0", "process_user_time": 2.639723}
[0m13:27:27.974269 [debug] [MainThread]: Command `dbt test` failed at 13:27:27.973891 after 3.56 seconds
[0m13:27:27.975927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b668cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b668e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b8028350>]}
[0m13:27:27.977702 [debug] [MainThread]: Flushing usage events
[0m13:27:29.955509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:24.620036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74714e6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74713ff1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7470e32f90>]}


============================== 13:30:24.625816 | cf3cbccf-4796-4e25-b395-493d77de9233 ==============================
[0m13:30:24.625816 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:30:24.628579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:30:24.878097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf3cbccf-4796-4e25-b395-493d77de9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746f118410>]}
[0m13:30:24.966489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf3cbccf-4796-4e25-b395-493d77de9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7470eeba10>]}
[0m13:30:24.968813 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:30:25.070186 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:30:26.484221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:30:26.485609 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/calculate_tip_rate.sql
[0m13:30:26.486664 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://tests/test_standardize_payment_type.sql
[0m13:30:27.062968 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:30:27.080185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf3cbccf-4796-4e25-b395-493d77de9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746d314b00>]}
[0m13:30:27.266490 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:30:27.276002 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:30:27.325825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf3cbccf-4796-4e25-b395-493d77de9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746cd0c9b0>]}
[0m13:30:27.328073 [info ] [MainThread]: Found 1 seed, 2 models, 3 data tests, 12 sources, 551 macros
[0m13:30:27.329517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf3cbccf-4796-4e25-b395-493d77de9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746ce902f0>]}
[0m13:30:27.333965 [info ] [MainThread]: 
[0m13:30:27.335679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:27.337962 [info ] [MainThread]: 
[0m13:30:27.342193 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:30:27.345430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public'
[0m13:30:27.385154 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:30:27.387314 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:30:27.389389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:27.398707 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:30:27.400799 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:30:27.402566 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:30:27.407143 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:30:27.410344 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:30:27.412682 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:30:27.415088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:30:27.422033 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:30:27.423817 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:30:27.425907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:27.433889 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:30:27.435623 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:30:27.437369 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:30:27.441717 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:30:27.444451 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:30:27.446352 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:30:27.448150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:30:27.451346 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:30:27.453316 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:30:27.455604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:27.462682 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:30:27.464677 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:30:27.466743 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:30:27.470771 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:30:27.473630 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:30:27.475578 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:30:27.482397 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:27.484124 [debug] [MainThread]: On master: BEGIN
[0m13:30:27.485087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:27.495779 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:30:27.497377 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:27.498776 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:30:27.508063 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:30:27.513338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf3cbccf-4796-4e25-b395-493d77de9233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746d2a6c30>]}
[0m13:30:27.515103 [debug] [MainThread]: On master: ROLLBACK
[0m13:30:27.517188 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:27.518630 [debug] [MainThread]: On master: BEGIN
[0m13:30:27.520674 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:30:27.522685 [debug] [MainThread]: On master: COMMIT
[0m13:30:27.524508 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:27.525969 [debug] [MainThread]: On master: COMMIT
[0m13:30:27.527906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:30:27.529546 [debug] [MainThread]: On master: Close
[0m13:30:27.533700 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:30:27.535392 [info ] [Thread-1 (]: 1 of 3 START test test_calculate_tip_rate ...................................... [RUN]
[0m13:30:27.536906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:30:27.538064 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:30:27.546197 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_calculate_tip_rate"
[0m13:30:27.560767 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_calculate_tip_rate
[0m13:30:27.582574 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_calculate_tip_rate"
[0m13:30:27.596443 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_calculate_tip_rate"
[0m13:30:27.597735 [debug] [Thread-1 (]: On test.my_dbt_project.test_calculate_tip_rate: BEGIN
[0m13:30:27.599417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:27.606696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:30:27.608487 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_calculate_tip_rate"
[0m13:30:27.610230 [debug] [Thread-1 (]: On test.my_dbt_project.test_calculate_tip_rate: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_calculate_tip_rate"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_calculate_tip_rate.sql

with test_data as (
    select 5 as tip_amount, 10 as fare_amount, 0.5 as expected_tip_rate
    union all
    select 3, 0, NULL
    union all
    select NULL, 15, NULL
),

actual as (
    select
        *,
        
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 as actual_tip_rate
    from test_data
)

select *
from actual
where not (
    (actual_tip_rate = expected_tip_rate)
    or (actual_tip_rate is null and expected_tip_rate is null)
)
      
    ) dbt_internal_test
[0m13:30:27.616201 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:30:27.622916 [debug] [Thread-1 (]: On test.my_dbt_project.test_calculate_tip_rate: ROLLBACK
[0m13:30:27.625579 [debug] [Thread-1 (]: On test.my_dbt_project.test_calculate_tip_rate: Close
[0m13:30:27.628187 [info ] [Thread-1 (]: 1 of 3 PASS test_calculate_tip_rate ............................................ [[32mPASS[0m in 0.09s]
[0m13:30:27.629691 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:30:27.631208 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:30:27.632720 [info ] [Thread-1 (]: 2 of 3 START test test_is_valid_trip ........................................... [RUN]
[0m13:30:27.634388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:30:27.635818 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:30:27.639713 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_is_valid_trip"
[0m13:30:27.647711 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_is_valid_trip
[0m13:30:27.651849 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_is_valid_trip"
[0m13:30:27.668194 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_is_valid_trip"
[0m13:30:27.670083 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: BEGIN
[0m13:30:27.671505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:27.680293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:30:27.681951 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_is_valid_trip"
[0m13:30:27.683705 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_is_valid_trip"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_is_valid_trip.sql

with test_data as (
    select 1 as trip_distance, 10 as fare_amount, 1 as passenger_count,
           TIMESTAMP '2021-01-01 12:00:00' as pickup_datetime,
           TIMESTAMP '2021-01-01 12:02:00' as dropoff_datetime,
           true as expected_is_valid
    union all
    select 0, 10, 1, TIMESTAMP '2021-01-01 12:00:00', TIMESTAMP '2021-01-01 12:02:00', false
),

actual as (
    select
        *,
        
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM dropoff_datetime - pickup_datetime) > 60
 as actual_is_valid
    from test_data
)

select *
from actual
where actual_is_valid != expected_is_valid
      
    ) dbt_internal_test
[0m13:30:27.686524 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:30:27.689553 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: ROLLBACK
[0m13:30:27.691583 [debug] [Thread-1 (]: On test.my_dbt_project.test_is_valid_trip: Close
[0m13:30:27.693732 [info ] [Thread-1 (]: 2 of 3 PASS test_is_valid_trip ................................................. [[32mPASS[0m in 0.06s]
[0m13:30:27.695109 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:30:27.696633 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:30:27.698079 [info ] [Thread-1 (]: 3 of 3 START test test_standardize_payment_type ................................ [RUN]
[0m13:30:27.699339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:30:27.700906 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:30:27.704424 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:30:27.712562 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m13:30:27.718733 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:30:27.730887 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:30:27.733388 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: BEGIN
[0m13:30:27.735025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:27.743042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:30:27.745136 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.test_standardize_payment_type"
[0m13:30:27.747195 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "test.my_dbt_project.test_standardize_payment_type"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/test_standardize_payment_type.sql

with test_data as (
    select 1 as payment_type, 'Credit Card' as expected
    union all
    select 3, 'No Charge'
    union all
    select 6, 'Voided Trip'
),

actual as (
    select
        *,
        
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as actual
    from test_data
)

select *
from actual
where not (
    actual = expected
    or (actual is null and expected is null)
)
      
    ) dbt_internal_test
[0m13:30:27.750452 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:30:27.754009 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: ROLLBACK
[0m13:30:27.756646 [debug] [Thread-1 (]: On test.my_dbt_project.test_standardize_payment_type: Close
[0m13:30:27.759025 [info ] [Thread-1 (]: 3 of 3 PASS test_standardize_payment_type ...................................... [[32mPASS[0m in 0.06s]
[0m13:30:27.760850 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:30:27.763608 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:27.764565 [debug] [MainThread]: On master: BEGIN
[0m13:30:27.765445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:27.770962 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:30:27.772123 [debug] [MainThread]: On master: COMMIT
[0m13:30:27.773095 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:27.773971 [debug] [MainThread]: On master: COMMIT
[0m13:30:27.775013 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:30:27.775812 [debug] [MainThread]: On master: Close
[0m13:30:27.776759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:27.777605 [debug] [MainThread]: Connection 'test.my_dbt_project.test_standardize_payment_type' was properly closed.
[0m13:30:27.778561 [info ] [MainThread]: 
[0m13:30:27.779733 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:30:27.782328 [debug] [MainThread]: Command end result
[0m13:30:27.858958 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:30:27.867754 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:30:27.886406 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:30:27.888509 [info ] [MainThread]: 
[0m13:30:27.889896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:27.891465 [info ] [MainThread]: 
[0m13:30:27.893104 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:30:27.895154 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.4528854, "process_in_blocks": "0", "process_kernel_time": 0.180696, "process_mem_max_rss": "117544", "process_out_blocks": "0", "process_user_time": 2.941343}
[0m13:30:27.896782 [debug] [MainThread]: Command `dbt test` succeeded at 13:30:27.896616 after 3.45 seconds
[0m13:30:27.898028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7470c8d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74713fcb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746cec4200>]}
[0m13:30:27.899286 [debug] [MainThread]: Flushing usage events
[0m13:30:28.922465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:17.897502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce2e8cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce275ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce2e8fe60>]}


============================== 13:31:17.902088 | b67fdfc5-c224-4e5a-a580-ed2b0733a9de ==============================
[0m13:31:17.902088 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:31:17.903488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:31:18.113450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b67fdfc5-c224-4e5a-a580-ed2b0733a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce41b8560>]}
[0m13:31:18.199408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b67fdfc5-c224-4e5a-a580-ed2b0733a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce2136b10>]}
[0m13:31:18.202522 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:31:18.329576 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:31:19.315546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:19.316501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:19.322703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:31:19.391514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b67fdfc5-c224-4e5a-a580-ed2b0733a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce21543e0>]}
[0m13:31:19.561319 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:31:19.567861 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:31:19.595450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b67fdfc5-c224-4e5a-a580-ed2b0733a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce059c7d0>]}
[0m13:31:19.597417 [info ] [MainThread]: Found 1 seed, 2 models, 3 data tests, 12 sources, 551 macros
[0m13:31:19.598934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67fdfc5-c224-4e5a-a580-ed2b0733a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce09e1eb0>]}
[0m13:31:19.602457 [info ] [MainThread]: 
[0m13:31:19.603593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:19.605042 [info ] [MainThread]: 
[0m13:31:19.606922 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:19.609929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public_staging'
[0m13:31:19.648077 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:31:19.650709 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:31:19.652422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:19.661430 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:31:19.663214 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:31:19.665109 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:31:19.669804 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:31:19.672892 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:31:19.675575 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:31:19.678476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:31:19.682583 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:31:19.684468 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:31:19.686287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:19.694950 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:31:19.697897 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:31:19.700831 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:31:19.709113 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m13:31:19.716256 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:31:19.719905 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:31:19.724740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:31:19.743899 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:31:19.746371 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:31:19.748848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:19.758162 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:31:19.760532 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:31:19.762318 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:31:19.767503 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:31:19.770843 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:31:19.773905 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:31:19.783931 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:19.786859 [debug] [MainThread]: On master: BEGIN
[0m13:31:19.790276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:19.801793 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:31:19.804562 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:19.807741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:19.821582 [debug] [MainThread]: SQL status: SELECT 12 in 0.011 seconds
[0m13:31:19.827862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67fdfc5-c224-4e5a-a580-ed2b0733a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce2186960>]}
[0m13:31:19.829826 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:19.832038 [debug] [MainThread]: On master: Close
[0m13:31:19.838025 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:31:19.841006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:31:19.843158 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:31:19.859353 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:31:19.881880 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:31:19.885113 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:31:19.887722 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.lookup_data
[0m13:31:19.890546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now seed.my_dbt_project.lookup_data)
[0m13:31:19.893127 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.lookup_data
[0m13:31:19.898900 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.lookup_data
[0m13:31:19.901543 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.lookup_data
[0m13:31:19.903901 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m13:31:19.905869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.lookup_data, now test.my_dbt_project.test_calculate_tip_rate)
[0m13:31:19.907522 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m13:31:19.914941 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_calculate_tip_rate"
[0m13:31:19.924453 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_calculate_tip_rate
[0m13:31:19.926504 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m13:31:19.927904 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m13:31:19.929734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m13:31:19.931024 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m13:31:19.936951 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_is_valid_trip"
[0m13:31:19.951165 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_is_valid_trip
[0m13:31:19.953245 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m13:31:19.954390 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m13:31:19.955974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m13:31:19.957243 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m13:31:19.964837 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m13:31:19.975917 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m13:31:19.978475 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m13:31:19.980239 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:31:19.981915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_standardize_payment_type, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:31:19.983339 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:31:19.992167 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:31:20.005331 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:31:20.007497 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:31:20.010640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:20.012134 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:31:20.014321 [debug] [MainThread]: Command end result
[0m13:31:20.068712 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:31:20.075515 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:31:20.088274 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:31:20.089848 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.336105, "process_in_blocks": "0", "process_kernel_time": 0.081204, "process_mem_max_rss": "107620", "process_out_blocks": "0", "process_user_time": 2.334619}
[0m13:31:20.091311 [debug] [MainThread]: Command `dbt compile` succeeded at 13:31:20.091161 after 2.34 seconds
[0m13:31:20.092382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce09d4560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce22f1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcce22f2ba0>]}
[0m13:31:20.093691 [debug] [MainThread]: Flushing usage events
[0m13:31:21.510663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:46.327219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f6b17c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f692d8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f694b0440>]}


============================== 13:31:46.335101 | 9a456f97-8f73-496a-ba54-d6400fae6b2f ==============================
[0m13:31:46.335101 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:31:46.337792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:31:46.554449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a456f97-8f73-496a-ba54-d6400fae6b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f69906f00>]}
[0m13:31:46.665945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a456f97-8f73-496a-ba54-d6400fae6b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f6901bb90>]}
[0m13:31:46.668998 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:31:46.822563 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:31:49.030856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:49.032949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:49.044693 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:31:49.120103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a456f97-8f73-496a-ba54-d6400fae6b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f6789d700>]}
[0m13:31:49.325959 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:31:49.336584 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:31:49.367911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a456f97-8f73-496a-ba54-d6400fae6b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f6745f050>]}
[0m13:31:49.369294 [info ] [MainThread]: Found 1 seed, 2 models, 3 data tests, 12 sources, 551 macros
[0m13:31:49.370531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a456f97-8f73-496a-ba54-d6400fae6b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f674549b0>]}
[0m13:31:49.373656 [info ] [MainThread]: 
[0m13:31:49.375002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:49.376477 [info ] [MainThread]: 
[0m13:31:49.379634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:49.386829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:31:49.433325 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:31:49.435080 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:31:49.436547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:49.444538 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m13:31:49.447798 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:31:49.452169 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:31:49.453677 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:31:49.455467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:49.464089 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m13:31:49.468418 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:31:49.473319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m13:31:49.483194 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:31:49.485697 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:31:49.488690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:49.499464 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:31:49.501433 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:31:49.503991 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:31:49.509690 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:31:49.513153 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:31:49.515127 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:31:49.517597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:31:49.521394 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:31:49.522902 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:31:49.524499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:49.531320 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:31:49.533410 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:31:49.535152 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:31:49.538808 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:31:49.541411 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:31:49.542911 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:31:49.544872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:31:49.548478 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:31:49.550465 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:31:49.552699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:49.564222 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:31:49.566993 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:31:49.569752 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:31:49.578324 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.006 seconds
[0m13:31:49.585557 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:31:49.589709 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:31:49.608476 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:49.611697 [debug] [MainThread]: On master: BEGIN
[0m13:31:49.615460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:49.635978 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m13:31:49.640599 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:49.645692 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:49.675804 [debug] [MainThread]: SQL status: SELECT 12 in 0.026 seconds
[0m13:31:49.693318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a456f97-8f73-496a-ba54-d6400fae6b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f67465af0>]}
[0m13:31:49.696736 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:49.700982 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:49.705162 [debug] [MainThread]: On master: BEGIN
[0m13:31:49.710210 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:31:49.713543 [debug] [MainThread]: On master: COMMIT
[0m13:31:49.716839 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:49.719935 [debug] [MainThread]: On master: COMMIT
[0m13:31:49.723614 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:31:49.726570 [debug] [MainThread]: On master: Close
[0m13:31:49.732740 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:31:49.735939 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:31:49.738368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:31:49.740127 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:31:49.755835 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:31:49.773659 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:31:49.817561 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:31:49.844893 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:31:49.847276 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:31:49.850010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:49.863526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m13:31:49.866531 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:31:49.870084 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:31:49.887516 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m13:31:49.903433 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:31:49.905781 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:31:49.909897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:31:49.916296 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:31:49.917813 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:31:49.921628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:31:49.943012 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:31:49.945662 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:31:49.948047 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:31:49.953862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:31:49.962437 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:31:49.969507 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:31:49.971428 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:31:49.978320 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m13:31:49.982776 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:31:49.985710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a456f97-8f73-496a-ba54-d6400fae6b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f6ae628d0>]}
[0m13:31:49.987553 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.25s]
[0m13:31:49.989257 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:31:49.991635 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:31:49.993303 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:31:49.995210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:31:49.996691 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:31:50.010174 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:31:50.027899 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:31:50.052493 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:31:50.068875 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:31:50.070211 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:31:50.072120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:50.079467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:31:50.081213 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:31:50.083334 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour

    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour;
  );
  
[0m13:31:50.086336 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "coalesce"
LINE 33: coalesce(
         ^

[0m13:31:50.087892 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:31:50.089866 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:31:50.095617 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "coalesce"
  LINE 33: coalesce(
           ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:31:50.097662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a456f97-8f73-496a-ba54-d6400fae6b2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f678b4860>]}
[0m13:31:50.100180 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.10s]
[0m13:31:50.102207 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:31:50.104063 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "coalesce"
  LINE 33: coalesce(
           ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:31:50.107067 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:50.108463 [debug] [MainThread]: On master: BEGIN
[0m13:31:50.110156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:50.118173 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:31:50.120747 [debug] [MainThread]: On master: COMMIT
[0m13:31:50.123080 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:50.125438 [debug] [MainThread]: On master: COMMIT
[0m13:31:50.128362 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:31:50.130366 [debug] [MainThread]: On master: Close
[0m13:31:50.132606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:50.134550 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:31:50.136920 [info ] [MainThread]: 
[0m13:31:50.138506 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m13:31:50.140404 [debug] [MainThread]: Command end result
[0m13:31:50.227537 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:31:50.238487 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:31:50.255805 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:31:50.257199 [info ] [MainThread]: 
[0m13:31:50.258407 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:31:50.259837 [info ] [MainThread]: 
[0m13:31:50.261443 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "coalesce"
  LINE 33: coalesce(
           ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:31:50.262856 [info ] [MainThread]: 
[0m13:31:50.264492 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:31:50.267186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.0818415, "process_in_blocks": "0", "process_kernel_time": 0.258465, "process_mem_max_rss": "109308", "process_out_blocks": "0", "process_user_time": 2.543302}
[0m13:31:50.269882 [debug] [MainThread]: Command `dbt run` failed at 13:31:50.269456 after 4.08 seconds
[0m13:31:50.272234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f69616930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f69671790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f696738c0>]}
[0m13:31:50.274379 [debug] [MainThread]: Flushing usage events
[0m13:31:51.980404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:31.836514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecfbc8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecf565eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecfa54aa0>]}


============================== 13:32:31.842577 | cd5ade07-5cb7-4ab9-aa09-f13502f6890c ==============================
[0m13:32:31.842577 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:32:31.844281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:32.075445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd5ade07-5cb7-4ab9-aa09-f13502f6890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecf0d4920>]}
[0m13:32:32.158654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd5ade07-5cb7-4ab9-aa09-f13502f6890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecf66e450>]}
[0m13:32:32.160327 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:32.302191 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:32:33.685647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:33.687209 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:32:34.103501 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:32:34.126057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd5ade07-5cb7-4ab9-aa09-f13502f6890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecd493650>]}
[0m13:32:34.324881 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:32:34.343030 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:32:34.380535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd5ade07-5cb7-4ab9-aa09-f13502f6890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec77bd490>]}
[0m13:32:34.382040 [info ] [MainThread]: Found 1 seed, 2 models, 3 data tests, 12 sources, 551 macros
[0m13:32:34.383507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd5ade07-5cb7-4ab9-aa09-f13502f6890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecd6d2f00>]}
[0m13:32:34.387318 [info ] [MainThread]: 
[0m13:32:34.388486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:32:34.389930 [info ] [MainThread]: 
[0m13:32:34.391838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:34.398329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:32:34.431733 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:32:34.434297 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:32:34.437315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:34.447196 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:32:34.454056 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:32:34.459857 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:32:34.462192 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:32:34.465367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:34.476113 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m13:32:34.481682 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:32:34.488319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m13:32:34.507806 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:32:34.511108 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:32:34.514512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:34.546671 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m13:32:34.553089 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:32:34.558632 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:32:34.570284 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m13:32:34.575407 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:32:34.578591 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:32:34.581491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:32:34.585275 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:32:34.588102 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:32:34.590452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:34.599957 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:32:34.602942 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:32:34.606294 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:32:34.613292 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:32:34.618912 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:32:34.622195 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:32:34.626702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:32:34.632638 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:32:34.636098 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:32:34.639814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:34.653881 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:32:34.656872 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:32:34.660551 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:32:34.669104 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.005 seconds
[0m13:32:34.677912 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:32:34.683076 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:32:34.711606 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:34.714295 [debug] [MainThread]: On master: BEGIN
[0m13:32:34.717937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:34.736925 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:32:34.741457 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:34.747237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:34.774414 [debug] [MainThread]: SQL status: SELECT 12 in 0.022 seconds
[0m13:32:34.784931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd5ade07-5cb7-4ab9-aa09-f13502f6890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec77bd7f0>]}
[0m13:32:34.788132 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:34.792659 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:34.796409 [debug] [MainThread]: On master: BEGIN
[0m13:32:34.800976 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:32:34.803655 [debug] [MainThread]: On master: COMMIT
[0m13:32:34.806942 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:34.810243 [debug] [MainThread]: On master: COMMIT
[0m13:32:34.814592 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:32:34.818632 [debug] [MainThread]: On master: Close
[0m13:32:34.824765 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:32:34.828025 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:32:34.830596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:32:34.832597 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:32:34.851897 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:34.878034 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:32:34.916944 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:34.951313 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:34.955423 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:32:34.961022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:34.987561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m13:32:34.993114 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:34.998243 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:32:35.023637 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m13:32:35.036941 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:35.039880 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:32:35.044276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:32:35.051956 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:35.056015 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:32:35.062828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:32:35.121763 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:32:35.124569 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:35.126703 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:32:35.133791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:32:35.142429 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:32:35.149373 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:35.152129 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:32:35.158370 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:32:35.163470 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:32:35.168375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd5ade07-5cb7-4ab9-aa09-f13502f6890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed0c52a80>]}
[0m13:32:35.171485 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.34s]
[0m13:32:35.173520 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:32:35.175873 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:32:35.177549 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:32:35.179222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:32:35.180774 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:32:35.187335 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:32:35.208363 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:32:35.234068 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:32:35.247432 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:32:35.249335 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:32:35.250772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:35.258865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:32:35.260743 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:32:35.262691 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour;
  );
  
[0m13:32:35.265881 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                   ^

[0m13:32:35.267802 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:32:35.269712 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:32:35.274630 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:32:35.276447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd5ade07-5cb7-4ab9-aa09-f13502f6890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ec6b23920>]}
[0m13:32:35.278499 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.10s]
[0m13:32:35.280503 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:32:35.282618 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:32:35.287032 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:35.288706 [debug] [MainThread]: On master: BEGIN
[0m13:32:35.290120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:35.301325 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:32:35.304068 [debug] [MainThread]: On master: COMMIT
[0m13:32:35.306940 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:35.309391 [debug] [MainThread]: On master: COMMIT
[0m13:32:35.312986 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:35.315124 [debug] [MainThread]: On master: Close
[0m13:32:35.317809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:35.320320 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:32:35.322578 [info ] [MainThread]: 
[0m13:32:35.324553 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m13:32:35.326625 [debug] [MainThread]: Command end result
[0m13:32:35.419565 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:32:35.434803 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:32:35.455223 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:32:35.458492 [info ] [MainThread]: 
[0m13:32:35.460644 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:32:35.462682 [info ] [MainThread]: 
[0m13:32:35.464420 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:32:35.466018 [info ] [MainThread]: 
[0m13:32:35.467366 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:32:35.469745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.7842479, "process_in_blocks": "0", "process_kernel_time": 0.226557, "process_mem_max_rss": "115868", "process_out_blocks": "0", "process_user_time": 3.073297}
[0m13:32:35.472015 [debug] [MainThread]: Command `dbt run` failed at 13:32:35.471694 after 3.79 seconds
[0m13:32:35.473795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecfb921e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecfb93fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ecf24bbf0>]}
[0m13:32:35.475423 [debug] [MainThread]: Flushing usage events
[0m13:32:38.079531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:53.111776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6740f8c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6740e789b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67408956d0>]}


============================== 13:32:53.115671 | dd41ddb3-a87b-498f-8361-a887551f69b9 ==============================
[0m13:32:53.115671 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:32:53.117581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:53.352244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd41ddb3-a87b-498f-8361-a887551f69b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67402608c0>]}
[0m13:32:53.450827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd41ddb3-a87b-498f-8361-a887551f69b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674033d8e0>]}
[0m13:32:53.454136 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:53.584871 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:32:54.878580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:54.880053 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:54.887570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:32:54.963348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd41ddb3-a87b-498f-8361-a887551f69b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673eafb770>]}
[0m13:32:55.140333 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:32:55.154705 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:32:55.194823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd41ddb3-a87b-498f-8361-a887551f69b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673eafbec0>]}
[0m13:32:55.197070 [info ] [MainThread]: Found 1 seed, 2 models, 3 data tests, 12 sources, 551 macros
[0m13:32:55.198764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd41ddb3-a87b-498f-8361-a887551f69b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67406cdd30>]}
[0m13:32:55.203482 [info ] [MainThread]: 
[0m13:32:55.204951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:32:55.208285 [info ] [MainThread]: 
[0m13:32:55.210452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:55.218200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:32:55.260935 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:32:55.264508 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:32:55.266691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:55.276694 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:32:55.280683 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:32:55.284850 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:32:55.287214 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:32:55.289211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:55.299438 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:32:55.303024 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:32:55.307597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:32:55.316806 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:32:55.319675 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:32:55.321860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:55.330813 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:32:55.333142 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:32:55.335131 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:32:55.341261 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m13:32:55.345019 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:32:55.347522 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:32:55.350899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:32:55.359348 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:32:55.361843 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:32:55.363870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:55.371402 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:32:55.374182 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:32:55.376688 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:32:55.381593 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:32:55.385110 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:32:55.386967 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:32:55.389544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:32:55.393947 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:32:55.396588 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:32:55.398997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:55.406445 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:32:55.408400 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:32:55.410920 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:32:55.415856 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:32:55.419550 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:32:55.422221 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:32:55.430702 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:55.433437 [debug] [MainThread]: On master: BEGIN
[0m13:32:55.434923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:55.444223 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:32:55.446137 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:55.448087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:55.459659 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m13:32:55.465059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd41ddb3-a87b-498f-8361-a887551f69b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673da32510>]}
[0m13:32:55.467679 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:55.469907 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:55.472160 [debug] [MainThread]: On master: BEGIN
[0m13:32:55.475674 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:32:55.477312 [debug] [MainThread]: On master: COMMIT
[0m13:32:55.480074 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:55.482443 [debug] [MainThread]: On master: COMMIT
[0m13:32:55.484226 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:55.486407 [debug] [MainThread]: On master: Close
[0m13:32:55.490968 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:32:55.493577 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:32:55.495423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:32:55.497243 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:32:55.513003 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:55.535025 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:32:55.581956 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:55.600969 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:55.603517 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:32:55.606208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:55.614507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:32:55.617463 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:55.620424 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:32:55.630290 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:32:55.644020 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:55.646455 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:32:55.650398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:32:55.657068 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:55.660023 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:32:55.663880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:32:55.689165 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:32:55.691950 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:55.694806 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:32:55.702689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:32:55.714706 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:32:55.725545 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:32:55.729265 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:32:55.737525 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m13:32:55.743324 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:32:55.748102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41ddb3-a87b-498f-8361-a887551f69b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6742076c90>]}
[0m13:32:55.751897 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.25s]
[0m13:32:55.755828 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:32:55.758039 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:32:55.759991 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:32:55.762010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:32:55.763660 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:32:55.778756 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:32:55.807353 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:32:55.839771 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:32:55.870986 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:32:55.874254 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:32:55.876809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:55.888059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:32:55.891188 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:32:55.893306 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour;
  );
  
[0m13:32:55.897081 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                   ^

[0m13:32:55.899656 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:32:55.902194 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:32:55.907730 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:32:55.910180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41ddb3-a87b-498f-8361-a887551f69b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f673eaf9d00>]}
[0m13:32:55.913006 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.15s]
[0m13:32:55.915258 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:32:55.918004 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:32:55.921693 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:55.924346 [debug] [MainThread]: On master: BEGIN
[0m13:32:55.925994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:55.935283 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:32:55.938254 [debug] [MainThread]: On master: COMMIT
[0m13:32:55.939778 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:55.941678 [debug] [MainThread]: On master: COMMIT
[0m13:32:55.943776 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:55.946147 [debug] [MainThread]: On master: Close
[0m13:32:55.948838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:55.951107 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:32:55.952933 [info ] [MainThread]: 
[0m13:32:55.955712 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m13:32:55.958610 [debug] [MainThread]: Command end result
[0m13:32:56.059335 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:32:56.103878 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:32:56.164901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:32:56.173650 [info ] [MainThread]: 
[0m13:32:56.177190 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:32:56.191364 [info ] [MainThread]: 
[0m13:32:56.199939 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:32:56.260349 [info ] [MainThread]: 
[0m13:32:56.272297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:32:56.287587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3405368, "process_in_blocks": "0", "process_kernel_time": 0.222736, "process_mem_max_rss": "109236", "process_out_blocks": "0", "process_user_time": 2.601968}
[0m13:32:56.290816 [debug] [MainThread]: Command `dbt run` failed at 13:32:56.290370 after 3.34 seconds
[0m13:32:56.292617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67409a5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67403f98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67404f8e00>]}
[0m13:32:56.294309 [debug] [MainThread]: Flushing usage events
[0m13:32:58.357662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:26.886616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc500d10350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5008b4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc500581c40>]}


============================== 13:34:26.892948 | da4c87b6-427b-490b-b779-a6151bf565e6 ==============================
[0m13:34:26.892948 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:34:26.894911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:34:27.151112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da4c87b6-427b-490b-b779-a6151bf565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50007b140>]}
[0m13:34:27.223210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da4c87b6-427b-490b-b779-a6151bf565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc500118f80>]}
[0m13:34:27.225650 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:27.329356 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:34:29.192178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:29.193244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:29.200042 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:34:29.264332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da4c87b6-427b-490b-b779-a6151bf565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4fe7d1190>]}
[0m13:34:29.448956 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:34:29.456058 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:34:29.494415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da4c87b6-427b-490b-b779-a6151bf565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4fe81b6e0>]}
[0m13:34:29.496730 [info ] [MainThread]: Found 1 seed, 2 models, 3 data tests, 12 sources, 551 macros
[0m13:34:29.498032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da4c87b6-427b-490b-b779-a6151bf565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4fe64bbf0>]}
[0m13:34:29.501617 [info ] [MainThread]: 
[0m13:34:29.503167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:34:29.504393 [info ] [MainThread]: 
[0m13:34:29.506202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:29.512327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:34:29.552324 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:34:29.553883 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:34:29.555917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:29.565204 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m13:34:29.568159 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:34:29.572143 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:34:29.573712 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:34:29.575510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:29.583580 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m13:34:29.586255 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:34:29.589745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:34:29.596851 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:34:29.598817 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:34:29.600793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:29.609182 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:34:29.611386 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:34:29.613272 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:34:29.619775 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:34:29.624829 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:34:29.628096 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:34:29.632258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:34:29.647104 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:34:29.650277 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:34:29.653002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:29.668478 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:34:29.672311 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:34:29.674889 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:34:29.683216 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:34:29.687658 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:34:29.690063 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:34:29.692530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:34:29.697131 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:34:29.699505 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:34:29.701910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:29.712413 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:34:29.715876 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:34:29.719013 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:34:29.727622 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:34:29.734332 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:34:29.739330 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:34:29.757554 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:29.761639 [debug] [MainThread]: On master: BEGIN
[0m13:34:29.764917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:29.780284 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:34:29.783594 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:29.786916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:34:29.810092 [debug] [MainThread]: SQL status: SELECT 12 in 0.019 seconds
[0m13:34:29.821347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da4c87b6-427b-490b-b779-a6151bf565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4fff5b530>]}
[0m13:34:29.824106 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:29.827216 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:29.830491 [debug] [MainThread]: On master: BEGIN
[0m13:34:29.834044 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:34:29.836683 [debug] [MainThread]: On master: COMMIT
[0m13:34:29.839089 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:29.841561 [debug] [MainThread]: On master: COMMIT
[0m13:34:29.844217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:29.846520 [debug] [MainThread]: On master: Close
[0m13:34:29.851422 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:34:29.854161 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:34:29.856377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:34:29.857611 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:34:29.873759 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:29.885228 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:34:29.930245 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:29.941831 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:29.943442 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:34:29.944574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:29.950501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:34:29.952096 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:29.953344 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:34:29.962086 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:34:29.975889 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:29.978307 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:34:29.981152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:29.986503 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:29.988205 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:34:29.991985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:30.013103 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:34:30.014946 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:30.016572 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:34:30.020918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:34:30.029691 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:34:30.036232 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:30.038203 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:34:30.043889 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:34:30.048503 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:34:30.052712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da4c87b6-427b-490b-b779-a6151bf565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc501dc6a50>]}
[0m13:34:30.054982 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.19s]
[0m13:34:30.056969 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:34:30.059657 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:34:30.061653 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:34:30.063712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:34:30.065415 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:34:30.083389 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:34:30.093741 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:34:30.121197 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:34:30.132016 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:34:30.133449 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:34:30.134597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:30.140724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:34:30.142554 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:34:30.144255 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour;
  );
  
[0m13:34:30.146421 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                   ^

[0m13:34:30.148018 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:34:30.149561 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:34:30.154016 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:34:30.155569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da4c87b6-427b-490b-b779-a6151bf565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4fd64b1a0>]}
[0m13:34:30.157176 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.09s]
[0m13:34:30.158800 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:34:30.160027 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:34:30.162783 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:30.163756 [debug] [MainThread]: On master: BEGIN
[0m13:34:30.164598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:30.170652 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:34:30.172121 [debug] [MainThread]: On master: COMMIT
[0m13:34:30.173360 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:30.174623 [debug] [MainThread]: On master: COMMIT
[0m13:34:30.176462 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:30.178060 [debug] [MainThread]: On master: Close
[0m13:34:30.180113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:30.181669 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:34:30.183470 [info ] [MainThread]: 
[0m13:34:30.186292 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m13:34:30.190935 [debug] [MainThread]: Command end result
[0m13:34:30.246838 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:34:30.252712 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:34:30.267718 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:34:30.269436 [info ] [MainThread]: 
[0m13:34:30.270983 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:34:30.272416 [info ] [MainThread]: 
[0m13:34:30.273941 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:34:30.275254 [info ] [MainThread]: 
[0m13:34:30.276684 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:34:30.278814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5313869, "process_in_blocks": "0", "process_kernel_time": 0.12877, "process_mem_max_rss": "110112", "process_out_blocks": "0", "process_user_time": 2.585307}
[0m13:34:30.281032 [debug] [MainThread]: Command `dbt run` failed at 13:34:30.280867 after 3.53 seconds
[0m13:34:30.282501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc500cadc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc500c8b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50067c320>]}
[0m13:34:30.284086 [debug] [MainThread]: Flushing usage events
[0m13:34:33.191967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:53.138482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f32b47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f2888b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f2d2aa20>]}


============================== 13:34:53.142657 | 0455b1ee-02fd-43a0-ba48-7feb1f7d6965 ==============================
[0m13:34:53.142657 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:34:53.144071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:34:53.417854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0455b1ee-02fd-43a0-ba48-7feb1f7d6965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f29c6120>]}
[0m13:34:53.489589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0455b1ee-02fd-43a0-ba48-7feb1f7d6965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f2750b00>]}
[0m13:34:53.492162 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:53.644229 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:34:55.624836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:34:55.626126 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:34:56.038542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:34:56.059378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0455b1ee-02fd-43a0-ba48-7feb1f7d6965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f0a65610>]}
[0m13:34:56.327235 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:34:56.340242 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:34:56.375860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0455b1ee-02fd-43a0-ba48-7feb1f7d6965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eaf9c770>]}
[0m13:34:56.377859 [info ] [MainThread]: Found 1 seed, 2 models, 3 data tests, 12 sources, 551 macros
[0m13:34:56.379252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0455b1ee-02fd-43a0-ba48-7feb1f7d6965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f2560140>]}
[0m13:34:56.382497 [info ] [MainThread]: 
[0m13:34:56.383870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:34:56.385303 [info ] [MainThread]: 
[0m13:34:56.387264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:56.394187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:34:56.434182 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:34:56.436118 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:34:56.438251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:56.448349 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:34:56.451389 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:34:56.456097 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:34:56.458129 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:34:56.460188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:56.468762 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m13:34:56.472164 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:34:56.475787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m13:34:56.485486 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:34:56.487773 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:34:56.489929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:56.498428 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:34:56.500829 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:34:56.503115 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:34:56.507834 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:34:56.511425 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:34:56.514577 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:34:56.517807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public)
[0m13:34:56.522244 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:34:56.524370 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:34:56.525960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:56.534193 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:34:56.536574 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:34:56.539094 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:34:56.545558 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:34:56.551632 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:34:56.555609 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:34:56.559197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:34:56.570844 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:34:56.574472 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:34:56.577985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:56.593773 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:34:56.597276 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:34:56.600318 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:34:56.608720 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:34:56.613836 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:34:56.617365 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:34:56.629515 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:56.631103 [debug] [MainThread]: On master: BEGIN
[0m13:34:56.633983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:56.643884 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:34:56.647241 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:56.649796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:34:56.663484 [debug] [MainThread]: SQL status: SELECT 12 in 0.010 seconds
[0m13:34:56.671214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0455b1ee-02fd-43a0-ba48-7feb1f7d6965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f2563380>]}
[0m13:34:56.674076 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:56.677081 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:56.679227 [debug] [MainThread]: On master: BEGIN
[0m13:34:56.681982 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:34:56.684100 [debug] [MainThread]: On master: COMMIT
[0m13:34:56.686157 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:56.688163 [debug] [MainThread]: On master: COMMIT
[0m13:34:56.690539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:56.692628 [debug] [MainThread]: On master: Close
[0m13:34:56.696387 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:34:56.698653 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:34:56.700209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:34:56.701530 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:34:56.714659 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:56.731109 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:34:56.771806 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:56.792930 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:56.795779 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:34:56.798604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:56.810109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:34:56.812730 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:56.816277 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:34:56.833505 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m13:34:56.848414 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:56.850540 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:34:56.853309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:56.858490 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:56.861316 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:34:56.866068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:34:56.902105 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:34:56.906091 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:56.908929 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:34:56.914722 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:34:56.932276 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:34:56.941235 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:34:56.952958 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:34:56.963548 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m13:34:56.975547 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:34:56.984193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0455b1ee-02fd-43a0-ba48-7feb1f7d6965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f32da4e0>]}
[0m13:34:56.989911 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.28s]
[0m13:34:57.000443 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:34:57.007685 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:34:57.012820 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:34:57.021246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:34:57.029196 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:34:57.061042 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:34:57.087592 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:34:57.119380 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:34:57.140112 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:34:57.145238 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:34:57.148803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:57.170181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m13:34:57.177945 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:34:57.184414 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
  );
  
[0m13:34:57.192563 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "vendorid" does not exist
LINE 17:   case vendorid
                ^
HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".

[0m13:34:57.196924 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:34:57.205202 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:34:57.215341 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:34:57.219388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0455b1ee-02fd-43a0-ba48-7feb1f7d6965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eaf9c650>]}
[0m13:34:57.225764 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.20s]
[0m13:34:57.232256 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:34:57.239337 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:34:57.250027 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:57.258360 [debug] [MainThread]: On master: BEGIN
[0m13:34:57.266502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:57.296379 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m13:34:57.300338 [debug] [MainThread]: On master: COMMIT
[0m13:34:57.304550 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:57.308836 [debug] [MainThread]: On master: COMMIT
[0m13:34:57.315677 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:34:57.321757 [debug] [MainThread]: On master: Close
[0m13:34:57.329436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:57.336405 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:34:57.343351 [info ] [MainThread]: 
[0m13:34:57.352986 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m13:34:57.365929 [debug] [MainThread]: Command end result
[0m13:34:57.621620 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:34:57.649814 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:34:57.668492 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:34:57.670680 [info ] [MainThread]: 
[0m13:34:57.673083 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:34:57.675646 [info ] [MainThread]: 
[0m13:34:57.677938 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:34:57.679864 [info ] [MainThread]: 
[0m13:34:57.682253 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:34:57.685510 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.66078, "process_in_blocks": "0", "process_kernel_time": 0.309987, "process_mem_max_rss": "115720", "process_out_blocks": "0", "process_user_time": 3.049875}
[0m13:34:57.690004 [debug] [MainThread]: Command `dbt run` failed at 13:34:57.689425 after 4.67 seconds
[0m13:34:57.698929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f33ef620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f00d4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f00d43b0>]}
[0m13:34:57.701744 [debug] [MainThread]: Flushing usage events
[0m13:34:58.776327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:01.885121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292b1b66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292af16600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292b1b55b0>]}


============================== 13:36:01.890067 | 3ca56867-8a58-48cf-9ab1-563705c0c35e ==============================
[0m13:36:01.890067 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:36:01.891972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:02.119725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ca56867-8a58-48cf-9ab1-563705c0c35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292ab2ede0>]}
[0m13:36:02.196863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ca56867-8a58-48cf-9ab1-563705c0c35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292b6b7500>]}
[0m13:36:02.199844 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:36:02.325568 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:36:07.704669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:36:07.706048 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:36:08.020999 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.marts_green_tripdata_summary_2019' (models/marts/marts_green_tripdata_summary_2019.sql) depends on a node named 'green_tripdata_2019_all' which was not found
[0m13:36:08.023597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.2878175, "process_in_blocks": "0", "process_kernel_time": 0.34293, "process_mem_max_rss": "103420", "process_out_blocks": "0", "process_user_time": 2.329911}
[0m13:36:08.025387 [debug] [MainThread]: Command `dbt run` failed at 13:36:08.025215 after 6.29 seconds
[0m13:36:08.026779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292abcf920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292912ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2929097440>]}
[0m13:36:08.028106 [debug] [MainThread]: Flushing usage events
[0m13:36:15.247067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:31.446974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003f5ff6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00405e7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003f5fe7e0>]}


============================== 13:36:31.457287 | 5783feee-b80e-47e2-9369-200b67e785c4 ==============================
[0m13:36:31.457287 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:36:31.460235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:36:31.702925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5783feee-b80e-47e2-9369-200b67e785c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003f5286e0>]}
[0m13:36:31.795789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5783feee-b80e-47e2-9369-200b67e785c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003f0dfe60>]}
[0m13:36:31.798141 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:36:31.940621 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:36:37.109423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:36:37.113120 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:36:37.540155 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.marts_green_tripdata_summary_2019' (models/marts/marts_green_tripdata_summary_2019.sql) depends on a node named 'staging.green_tripdata_2019_all' which was not found
[0m13:36:37.553154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.288609, "process_in_blocks": "0", "process_kernel_time": 0.265986, "process_mem_max_rss": "103540", "process_out_blocks": "0", "process_user_time": 2.455262}
[0m13:36:37.556469 [debug] [MainThread]: Command `dbt run` failed at 13:36:37.556131 after 6.29 seconds
[0m13:36:37.559187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003f5fe000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003d7b4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003c0966f0>]}
[0m13:36:37.561721 [debug] [MainThread]: Flushing usage events
[0m13:36:40.887937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:38.343151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c67ff170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c608db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c5fb8b60>]}


============================== 13:37:38.347313 | df0530d9-d840-445f-9d02-5998227fe35e ==============================
[0m13:37:38.347313 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:37:38.349258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:37:38.552740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df0530d9-d840-445f-9d02-5998227fe35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c5eead50>]}
[0m13:37:38.678884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df0530d9-d840-445f-9d02-5998227fe35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c666dac0>]}
[0m13:37:38.680881 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:37:38.782576 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:37:39.956810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:37:39.958430 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/staging/schema.yml
[0m13:37:39.959673 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:37:40.407764 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:37:40.429080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df0530d9-d840-445f-9d02-5998227fe35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c40c9640>]}
[0m13:37:40.644048 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:37:40.660733 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:37:40.700736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df0530d9-d840-445f-9d02-5998227fe35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c281e630>]}
[0m13:37:40.705194 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:37:40.709428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0530d9-d840-445f-9d02-5998227fe35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c41b27e0>]}
[0m13:37:40.718982 [info ] [MainThread]: 
[0m13:37:40.720868 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:37:40.722654 [info ] [MainThread]: 
[0m13:37:40.725307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:37:40.732837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:37:40.787232 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:37:40.788947 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:37:40.790226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:40.798675 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m13:37:40.801537 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:37:40.807165 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:37:40.808839 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:37:40.809973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:40.816872 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m13:37:40.819601 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:37:40.822579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_staging)
[0m13:37:40.830686 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:37:40.832113 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:37:40.833183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:40.840055 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:37:40.841486 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:37:40.843174 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:37:40.850224 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:37:40.853906 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:37:40.855911 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:37:40.858024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:37:40.863136 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:37:40.865652 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:37:40.868282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:40.883070 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:37:40.886820 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:37:40.889725 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:37:40.897918 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.005 seconds
[0m13:37:40.903393 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:37:40.907127 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:37:40.910659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:37:40.921156 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:37:40.925333 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:37:40.929509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:40.947006 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m13:37:40.951204 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:37:40.955372 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:37:40.966624 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m13:37:40.975892 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:37:40.981161 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:37:40.995415 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:40.998743 [debug] [MainThread]: On master: BEGIN
[0m13:37:41.001840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:41.012394 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:37:41.015336 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:41.018517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:37:41.035041 [debug] [MainThread]: SQL status: SELECT 12 in 0.013 seconds
[0m13:37:41.044197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0530d9-d840-445f-9d02-5998227fe35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c422c800>]}
[0m13:37:41.047786 [debug] [MainThread]: On master: ROLLBACK
[0m13:37:41.052469 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:41.055824 [debug] [MainThread]: On master: BEGIN
[0m13:37:41.060935 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:37:41.065167 [debug] [MainThread]: On master: COMMIT
[0m13:37:41.068644 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:41.072655 [debug] [MainThread]: On master: COMMIT
[0m13:37:41.078116 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:37:41.081854 [debug] [MainThread]: On master: Close
[0m13:37:41.091710 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:37:41.095953 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:37:41.098607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:37:41.101198 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:37:41.116484 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:37:41.139947 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:37:41.183043 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:37:41.222704 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:37:41.226797 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:37:41.230696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:41.245978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:37:41.249743 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:37:41.253455 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:37:41.271103 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m13:37:41.288600 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:37:41.291162 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:37:41.295568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:37:41.301740 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:37:41.303927 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:37:41.308021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:37:41.329132 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:37:41.331395 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:37:41.333810 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:37:41.343290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:37:41.358998 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:37:41.373540 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:37:41.376836 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:37:41.389238 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m13:37:41.397926 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:37:41.403081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0530d9-d840-445f-9d02-5998227fe35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c694e0f0>]}
[0m13:37:41.405954 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.30s]
[0m13:37:41.407797 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:37:41.410742 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:37:41.412498 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:37:41.414598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:37:41.416238 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:37:41.424436 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:37:41.443659 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:37:41.469290 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:37:41.492042 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:37:41.495023 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:37:41.497141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:41.506839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:37:41.509825 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:37:41.512679 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour;
  );
  
[0m13:37:41.516615 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                   ^

[0m13:37:41.518805 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:37:41.522056 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:37:41.528420 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:37:41.531773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0530d9-d840-445f-9d02-5998227fe35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c422c680>]}
[0m13:37:41.535623 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.12s]
[0m13:37:41.537743 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:37:41.540393 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:37:41.546384 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:41.548980 [debug] [MainThread]: On master: BEGIN
[0m13:37:41.550401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:41.558576 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:37:41.560210 [debug] [MainThread]: On master: COMMIT
[0m13:37:41.562786 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:41.565547 [debug] [MainThread]: On master: COMMIT
[0m13:37:41.567264 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:37:41.569823 [debug] [MainThread]: On master: Close
[0m13:37:41.573068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:41.575130 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:37:41.577342 [info ] [MainThread]: 
[0m13:37:41.579802 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m13:37:41.582060 [debug] [MainThread]: Command end result
[0m13:37:41.691005 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:37:41.706318 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:37:41.731823 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:37:41.735376 [info ] [MainThread]: 
[0m13:37:41.737554 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:37:41.739154 [info ] [MainThread]: 
[0m13:37:41.740946 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:37:41.742373 [info ] [MainThread]: 
[0m13:37:41.744003 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:37:41.746880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5175848, "process_in_blocks": "0", "process_kernel_time": 0.219653, "process_mem_max_rss": "113760", "process_out_blocks": "0", "process_user_time": 2.895437}
[0m13:37:41.749102 [debug] [MainThread]: Command `dbt run` failed at 13:37:41.748857 after 3.52 seconds
[0m13:37:41.750930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c6986780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c42c1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c2837a40>]}
[0m13:37:41.753221 [debug] [MainThread]: Flushing usage events
[0m13:37:45.392201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:11.829561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316d22180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc315730f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316ed6120>]}


============================== 13:38:11.833897 | 0e5ae633-f5fa-4349-9bcc-3b14f34e1e85 ==============================
[0m13:38:11.833897 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:38:11.835368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:12.114177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e5ae633-f5fa-4349-9bcc-3b14f34e1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31506fe60>]}
[0m13:38:12.185410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e5ae633-f5fa-4349-9bcc-3b14f34e1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31503f740>]}
[0m13:38:12.188115 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:38:12.319967 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:38:13.814387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:38:13.818141 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/schema.yml
[0m13:38:14.287872 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:38:14.307910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e5ae633-f5fa-4349-9bcc-3b14f34e1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc311dbfa10>]}
[0m13:38:14.463496 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:38:14.472669 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:38:14.509357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e5ae633-f5fa-4349-9bcc-3b14f34e1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc311d94950>]}
[0m13:38:14.511206 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:38:14.512557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e5ae633-f5fa-4349-9bcc-3b14f34e1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3135aa660>]}
[0m13:38:14.515846 [info ] [MainThread]: 
[0m13:38:14.517489 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:14.519106 [info ] [MainThread]: 
[0m13:38:14.520997 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:38:14.527306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:38:14.567116 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:38:14.568395 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:38:14.569351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:14.576312 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m13:38:14.578491 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:38:14.581585 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:38:14.582587 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:38:14.583595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:14.589429 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m13:38:14.591529 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:38:14.593807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_staging)
[0m13:38:14.601097 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:38:14.602423 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:38:14.603610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:14.616198 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:38:14.617722 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:38:14.619119 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:38:14.625970 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:38:14.628700 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:38:14.630307 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:38:14.632397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:38:14.635321 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:38:14.637235 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:38:14.639291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:14.647223 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:38:14.649140 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:38:14.651304 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:38:14.655581 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:38:14.659453 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:38:14.661531 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:38:14.662959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:38:14.671764 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:38:14.673832 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:38:14.675491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:14.683945 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:38:14.685946 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:38:14.687702 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:38:14.692602 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:38:14.695372 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:38:14.697222 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:38:14.704004 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:14.706016 [debug] [MainThread]: On master: BEGIN
[0m13:38:14.707797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:14.714903 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:38:14.717422 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:14.719853 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:38:14.730095 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:38:14.735009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e5ae633-f5fa-4349-9bcc-3b14f34e1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc311212810>]}
[0m13:38:14.737325 [debug] [MainThread]: On master: ROLLBACK
[0m13:38:14.739415 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:14.741792 [debug] [MainThread]: On master: BEGIN
[0m13:38:14.744508 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:38:14.746353 [debug] [MainThread]: On master: COMMIT
[0m13:38:14.749367 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:14.752198 [debug] [MainThread]: On master: COMMIT
[0m13:38:14.754999 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:38:14.757850 [debug] [MainThread]: On master: Close
[0m13:38:14.763812 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:38:14.766961 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:38:14.768826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:38:14.770593 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:38:14.784946 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:14.800921 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:38:14.840136 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:14.861201 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:14.863222 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:38:14.866687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:14.874824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:38:14.876735 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:14.878476 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:38:14.886695 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:38:14.897934 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:14.900402 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:38:14.903749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:14.909159 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:14.910519 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:38:14.913448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:14.933723 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:38:14.935719 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:14.937604 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:38:14.941869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:38:14.951293 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:38:14.961088 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:14.962996 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:38:14.967611 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:38:14.971964 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:38:14.975744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e5ae633-f5fa-4349-9bcc-3b14f34e1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc316d8e330>]}
[0m13:38:14.978024 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.21s]
[0m13:38:14.979566 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:38:14.981995 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:38:14.983529 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:38:14.984766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:38:14.986060 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:38:14.993877 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:38:15.006195 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:38:15.034528 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:38:15.059854 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:38:15.062219 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:38:15.064584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:15.076422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:38:15.079718 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:38:15.083334 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour;
  );
  
[0m13:38:15.088364 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                   ^

[0m13:38:15.091628 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:38:15.096365 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:38:15.109277 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:38:15.113183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e5ae633-f5fa-4349-9bcc-3b14f34e1e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc310649df0>]}
[0m13:38:15.118116 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.13s]
[0m13:38:15.123152 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:38:15.126798 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:38:15.134664 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:15.137296 [debug] [MainThread]: On master: BEGIN
[0m13:38:15.139957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:15.149892 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:38:15.153494 [debug] [MainThread]: On master: COMMIT
[0m13:38:15.155867 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:15.158691 [debug] [MainThread]: On master: COMMIT
[0m13:38:15.162360 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:38:15.165236 [debug] [MainThread]: On master: Close
[0m13:38:15.168807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:15.171358 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:38:15.174552 [info ] [MainThread]: 
[0m13:38:15.176949 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m13:38:15.179835 [debug] [MainThread]: Command end result
[0m13:38:15.272974 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:38:15.284501 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:38:15.297679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:38:15.299141 [info ] [MainThread]: 
[0m13:38:15.301035 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:38:15.302365 [info ] [MainThread]: 
[0m13:38:15.304165 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near ";"
  LINE 84: order by vendor_label, trip_month, trip_weekday, trip_hour;
                                                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:38:15.305349 [info ] [MainThread]: 
[0m13:38:15.306670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:38:15.309746 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6088617, "process_in_blocks": "0", "process_kernel_time": 0.259208, "process_mem_max_rss": "115660", "process_out_blocks": "0", "process_user_time": 2.941024}
[0m13:38:15.311967 [debug] [MainThread]: Command `dbt run` failed at 13:38:15.311715 after 3.61 seconds
[0m13:38:15.313474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3152da960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc315b610a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31541acc0>]}
[0m13:38:15.315302 [debug] [MainThread]: Flushing usage events
[0m13:38:19.453348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:40.193566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33edb3b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ef84ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33edc4f6e0>]}


============================== 13:38:40.198049 | 3112ff02-5562-4c87-9f9e-2c490afa4803 ==============================
[0m13:38:40.198049 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:38:40.200157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:38:40.434897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3112ff02-5562-4c87-9f9e-2c490afa4803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ed72b980>]}
[0m13:38:40.514977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3112ff02-5562-4c87-9f9e-2c490afa4803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ed66b620>]}
[0m13:38:40.517066 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:38:40.604799 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:38:45.497910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:38:45.499212 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:38:45.890104 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:38:45.909926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3112ff02-5562-4c87-9f9e-2c490afa4803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e9f8eff0>]}
[0m13:38:46.088364 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:38:46.096240 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:38:46.150450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3112ff02-5562-4c87-9f9e-2c490afa4803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e9f26b70>]}
[0m13:38:46.157283 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:38:46.163737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3112ff02-5562-4c87-9f9e-2c490afa4803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ed72b8c0>]}
[0m13:38:46.173719 [info ] [MainThread]: 
[0m13:38:46.178370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:46.182501 [info ] [MainThread]: 
[0m13:38:46.187424 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:38:46.201185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:38:46.236885 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:38:46.239945 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:38:46.243473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:46.259728 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m13:38:46.266002 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:38:46.274731 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:38:46.278981 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:38:46.283434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:46.297881 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m13:38:46.302199 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:38:46.307614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:38:46.320249 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:38:46.325708 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:38:46.331104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:46.354019 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m13:38:46.364498 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:38:46.371454 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:38:46.387189 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.009 seconds
[0m13:38:46.399740 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:38:46.407047 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:38:46.418090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:38:46.444706 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:38:46.449965 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:38:46.455300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:46.497634 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m13:38:46.505365 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:38:46.512269 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:38:46.531281 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m13:38:46.546367 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:38:46.555187 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:38:46.564724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:38:46.583502 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:38:46.589520 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:38:46.594751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:46.621384 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m13:38:46.628588 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:38:46.635171 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:38:46.654252 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m13:38:46.670738 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:38:46.680872 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:38:46.712353 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:46.716962 [debug] [MainThread]: On master: BEGIN
[0m13:38:46.721253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:46.740615 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:38:46.746517 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:46.751817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:38:46.781327 [debug] [MainThread]: SQL status: SELECT 12 in 0.025 seconds
[0m13:38:46.797546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3112ff02-5562-4c87-9f9e-2c490afa4803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ebe5f4a0>]}
[0m13:38:46.801180 [debug] [MainThread]: On master: ROLLBACK
[0m13:38:46.806080 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:46.809768 [debug] [MainThread]: On master: BEGIN
[0m13:38:46.815151 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:38:46.818712 [debug] [MainThread]: On master: COMMIT
[0m13:38:46.822116 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:46.826872 [debug] [MainThread]: On master: COMMIT
[0m13:38:46.832368 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:38:46.837606 [debug] [MainThread]: On master: Close
[0m13:38:46.848274 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:38:46.852338 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:38:46.856813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:38:46.861855 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:38:46.882302 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:46.902130 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:38:46.940624 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:46.975100 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:46.978944 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:38:46.983475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:46.999052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:38:47.002810 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:47.006996 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:38:47.022805 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m13:38:47.036573 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:47.039352 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:38:47.043333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:47.050455 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:47.053847 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:38:47.058329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:47.081317 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:38:47.083682 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:47.085601 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:38:47.091394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:38:47.103367 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:38:47.112514 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:38:47.114270 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:38:47.120299 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:38:47.125601 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:38:47.128958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3112ff02-5562-4c87-9f9e-2c490afa4803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ef356270>]}
[0m13:38:47.131662 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.27s]
[0m13:38:47.133375 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:38:47.135595 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:38:47.137367 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:38:47.139478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:38:47.141169 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:38:47.147188 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:38:47.166489 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:38:47.196722 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:38:47.252370 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:38:47.261100 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:38:47.274043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:47.299479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m13:38:47.304305 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:38:47.309612 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:38:47.316577 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "vendorid" does not exist
LINE 17:   case vendorid
                ^
HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".

[0m13:38:47.321123 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:38:47.325399 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:38:47.334749 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:38:47.371338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3112ff02-5562-4c87-9f9e-2c490afa4803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e921b2f0>]}
[0m13:38:47.392838 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.23s]
[0m13:38:47.406320 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:38:47.415627 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:38:47.436012 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:47.444399 [debug] [MainThread]: On master: BEGIN
[0m13:38:47.454441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:47.496653 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m13:38:47.505962 [debug] [MainThread]: On master: COMMIT
[0m13:38:47.513963 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:47.521779 [debug] [MainThread]: On master: COMMIT
[0m13:38:47.529742 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:38:47.533308 [debug] [MainThread]: On master: Close
[0m13:38:47.537853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:47.542207 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:38:47.544517 [info ] [MainThread]: 
[0m13:38:47.545914 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m13:38:47.548675 [debug] [MainThread]: Command end result
[0m13:38:47.709596 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:38:47.749893 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:38:47.807848 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:38:47.813906 [info ] [MainThread]: 
[0m13:38:47.822060 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:38:47.832795 [info ] [MainThread]: 
[0m13:38:47.846988 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:38:47.856350 [info ] [MainThread]: 
[0m13:38:47.869764 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:38:47.880148 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.826061, "process_in_blocks": "0", "process_kernel_time": 0.388377, "process_mem_max_rss": "114444", "process_out_blocks": "0", "process_user_time": 3.226518}
[0m13:38:47.885393 [debug] [MainThread]: Command `dbt run` failed at 13:38:47.885154 after 7.83 seconds
[0m13:38:47.889758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ed729dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33eb9eda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33eb9ef1a0>]}
[0m13:38:47.893503 [debug] [MainThread]: Flushing usage events
[0m13:38:56.315660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:55.430288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d86e08a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d868e2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d868e3860>]}


============================== 13:39:55.435890 | 07df0cf1-2dcc-4317-858e-a881c445d744 ==============================
[0m13:39:55.435890 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:39:55.437445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:39:55.685537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07df0cf1-2dcc-4317-858e-a881c445d744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8625e420>]}
[0m13:39:55.765706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07df0cf1-2dcc-4317-858e-a881c445d744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d86293230>]}
[0m13:39:55.768455 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:55.890679 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:39:57.374809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:39:57.378258 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:39:57.801102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:39:57.826324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07df0cf1-2dcc-4317-858e-a881c445d744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d840cf200>]}
[0m13:39:58.043394 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:39:58.056820 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:39:58.094277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07df0cf1-2dcc-4317-858e-a881c445d744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d84066ba0>]}
[0m13:39:58.096099 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:39:58.097921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07df0cf1-2dcc-4317-858e-a881c445d744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8452cb60>]}
[0m13:39:58.101891 [info ] [MainThread]: 
[0m13:39:58.103565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:58.105265 [info ] [MainThread]: 
[0m13:39:58.106971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:58.115553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:39:58.150383 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:39:58.152800 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:39:58.155089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:58.164784 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:39:58.168922 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:39:58.174409 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:39:58.176369 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:39:58.179028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:58.189958 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m13:39:58.195265 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:39:58.200971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m13:39:58.219826 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:39:58.224930 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:39:58.229688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:58.257825 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m13:39:58.263391 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:39:58.269739 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:39:58.283401 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m13:39:58.288644 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:39:58.291998 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:39:58.294817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:39:58.299401 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:39:58.302002 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:39:58.304943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:58.320122 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:39:58.323835 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:39:58.327467 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:39:58.338378 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m13:39:58.346286 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:39:58.351146 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:39:58.356552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:39:58.367263 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:39:58.371621 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:39:58.376199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:58.403171 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m13:39:58.408165 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:39:58.413558 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:39:58.426642 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.008 seconds
[0m13:39:58.441579 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:39:58.447603 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:39:58.473284 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:58.475973 [debug] [MainThread]: On master: BEGIN
[0m13:39:58.478642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:58.490235 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:39:58.491892 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:58.493865 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:39:58.505438 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m13:39:58.511016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07df0cf1-2dcc-4317-858e-a881c445d744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d862bb320>]}
[0m13:39:58.513294 [debug] [MainThread]: On master: ROLLBACK
[0m13:39:58.516282 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:58.518658 [debug] [MainThread]: On master: BEGIN
[0m13:39:58.521250 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:39:58.523770 [debug] [MainThread]: On master: COMMIT
[0m13:39:58.526081 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:58.528425 [debug] [MainThread]: On master: COMMIT
[0m13:39:58.530970 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:39:58.533163 [debug] [MainThread]: On master: Close
[0m13:39:58.536806 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:39:58.538823 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:39:58.540479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:39:58.541651 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:39:58.555582 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:39:58.571590 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:39:58.611512 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:39:58.628678 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:39:58.630762 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:39:58.632747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:58.640341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:39:58.642310 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:39:58.644051 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:39:58.652437 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:39:58.667393 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:39:58.670216 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:39:58.674418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:58.681765 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:39:58.683990 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:39:58.687278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:58.723132 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:39:58.725570 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:39:58.727781 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:39:58.735623 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:39:58.752069 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:39:58.765365 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:39:58.767494 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:39:58.774585 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:39:58.780302 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:39:58.784507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df0cf1-2dcc-4317-858e-a881c445d744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d880565a0>]}
[0m13:39:58.787214 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.24s]
[0m13:39:58.789667 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:39:58.791973 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:39:58.795662 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:39:58.798067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:39:58.809124 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:39:58.816125 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:39:58.831920 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:39:58.860055 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:39:58.876466 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:39:58.878023 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:39:58.879798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:58.887404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:39:58.888863 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:39:58.890193 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case VendorID
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:39:58.893476 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "vendorid" does not exist
LINE 17:   case VendorID
                ^
HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".

[0m13:39:58.894792 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:39:58.897541 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:39:58.903340 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case VendorID
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:39:58.906122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07df0cf1-2dcc-4317-858e-a881c445d744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d7c5483b0>]}
[0m13:39:58.909044 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.11s]
[0m13:39:58.911711 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:39:58.914214 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case VendorID
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:39:58.918749 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:58.920943 [debug] [MainThread]: On master: BEGIN
[0m13:39:58.923095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:58.931947 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:39:58.934132 [debug] [MainThread]: On master: COMMIT
[0m13:39:58.935819 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:58.937398 [debug] [MainThread]: On master: COMMIT
[0m13:39:58.939712 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:39:58.941952 [debug] [MainThread]: On master: Close
[0m13:39:58.944198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:58.946270 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:39:58.948375 [info ] [MainThread]: 
[0m13:39:58.949979 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m13:39:58.952310 [debug] [MainThread]: Command end result
[0m13:39:59.083065 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:39:59.105337 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:39:59.126613 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:39:59.128624 [info ] [MainThread]: 
[0m13:39:59.130157 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:39:59.131821 [info ] [MainThread]: 
[0m13:39:59.133358 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case VendorID
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:39:59.134978 [info ] [MainThread]: 
[0m13:39:59.136317 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:39:59.139230 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8585362, "process_in_blocks": "0", "process_kernel_time": 0.242843, "process_mem_max_rss": "115632", "process_out_blocks": "0", "process_user_time": 2.934362}
[0m13:39:59.141381 [debug] [MainThread]: Command `dbt run` failed at 13:39:59.141174 after 3.86 seconds
[0m13:39:59.143236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d86542cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d84636930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d86910590>]}
[0m13:39:59.145519 [debug] [MainThread]: Flushing usage events
[0m13:40:04.009045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:48.405436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a9bd9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a946ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a9bb9dc0>]}


============================== 13:46:48.409956 | 3818dcb6-92eb-4b1a-8d47-76e6d8100460 ==============================
[0m13:46:48.409956 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:46:48.411564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:48.615541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3818dcb6-92eb-4b1a-8d47-76e6d8100460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8cd0800>]}
[0m13:46:48.689257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3818dcb6-92eb-4b1a-8d47-76e6d8100460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8c60ec0>]}
[0m13:46:48.691626 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:46:48.838532 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:46:50.421778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:46:50.423326 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/schema.yml
[0m13:46:50.424334 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:46:50.927072 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:46:50.943938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3818dcb6-92eb-4b1a-8d47-76e6d8100460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a56af050>]}
[0m13:46:51.125249 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:46:51.133453 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:46:51.164206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3818dcb6-92eb-4b1a-8d47-76e6d8100460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a576f350>]}
[0m13:46:51.166129 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:46:51.167605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3818dcb6-92eb-4b1a-8d47-76e6d8100460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a5673890>]}
[0m13:46:51.170754 [info ] [MainThread]: 
[0m13:46:51.172224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:51.173630 [info ] [MainThread]: 
[0m13:46:51.176395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:51.182849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:46:51.219072 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:46:51.220836 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:46:51.221960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:51.229780 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m13:46:51.232789 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:46:51.237314 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:46:51.238791 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:46:51.240132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:51.246628 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m13:46:51.249151 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:46:51.251776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:46:51.258657 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:46:51.260010 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:46:51.260977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:51.267656 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:46:51.269125 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:46:51.270664 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:46:51.274136 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:46:51.277060 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:46:51.278714 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:46:51.280466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:46:51.287243 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:46:51.289058 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:46:51.290577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:51.297527 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:46:51.299018 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:46:51.300359 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:46:51.303651 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:46:51.306152 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:46:51.307828 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:46:51.309516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:46:51.311946 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:46:51.313697 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:46:51.315291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:51.321957 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:46:51.324109 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:46:51.325284 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:46:51.329169 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:46:51.331485 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:46:51.333030 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:46:51.339111 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:51.340613 [debug] [MainThread]: On master: BEGIN
[0m13:46:51.342294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:51.348741 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:46:51.349882 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:51.351030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:46:51.360217 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:46:51.365105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3818dcb6-92eb-4b1a-8d47-76e6d8100460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a70741a0>]}
[0m13:46:51.366280 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:51.367468 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:51.368483 [debug] [MainThread]: On master: BEGIN
[0m13:46:51.370090 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:46:51.370968 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.371715 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:51.372503 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.373425 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:46:51.374239 [debug] [MainThread]: On master: Close
[0m13:46:51.377534 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:46:51.378680 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:46:51.380924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:46:51.381892 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:46:51.391508 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:46:51.398968 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:46:51.442702 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:46:51.460799 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:46:51.463578 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:46:51.466447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:51.478209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:46:51.481333 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:46:51.485182 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."raw"."green_tripdata_2019-01" union all select * from "ingest_db"."raw"."green_tripdata_2019-02" union all select * from "ingest_db"."raw"."green_tripdata_2019-03" union all select * from "ingest_db"."raw"."green_tripdata_2019-04" union all select * from "ingest_db"."raw"."green_tripdata_2019-05" union all select * from "ingest_db"."raw"."green_tripdata_2019-06" union all select * from "ingest_db"."raw"."green_tripdata_2019-07" union all select * from "ingest_db"."raw"."green_tripdata_2019-08" union all select * from "ingest_db"."raw"."green_tripdata_2019-09" union all select * from "ingest_db"."raw"."green_tripdata_2019-10" union all select * from "ingest_db"."raw"."green_tripdata_2019-11" union all select * from "ingest_db"."raw"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:46:51.490860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.green_tripdata_2019-01" does not exist
LINE 10:   select * from "ingest_db"."raw"."green_tripdata_2019-01" u...
                         ^

[0m13:46:51.496193 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: ROLLBACK
[0m13:46:51.502597 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:46:51.517318 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  relation "raw.green_tripdata_2019-01" does not exist
  LINE 10:   select * from "ingest_db"."raw"."green_tripdata_2019-01" u...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m13:46:51.525054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3818dcb6-92eb-4b1a-8d47-76e6d8100460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a99021e0>]}
[0m13:46:51.531119 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public_staging.staging_green_tripdata_2019_all  [[31mERROR[0m in 0.14s]
[0m13:46:51.538034 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:46:51.541997 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_2019_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  relation "raw.green_tripdata_2019-01" does not exist
  LINE 10:   select * from "ingest_db"."raw"."green_tripdata_2019-01" u...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql.
[0m13:46:51.546745 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:46:51.549078 [info ] [Thread-1 (]: 2 of 2 SKIP relation public_marts.marts_green_tripdata_summary_2019 ............ [[33mSKIP[0m]
[0m13:46:51.554626 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:46:51.559317 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:51.561771 [debug] [MainThread]: On master: BEGIN
[0m13:46:51.564051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:51.572833 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:46:51.575061 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.577502 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:51.579427 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.581995 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:46:51.584292 [debug] [MainThread]: On master: Close
[0m13:46:51.586040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:51.587224 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_2019_all' was properly closed.
[0m13:46:51.589415 [info ] [MainThread]: 
[0m13:46:51.590922 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m13:46:51.592645 [debug] [MainThread]: Command end result
[0m13:46:51.687901 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:46:51.696132 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:46:51.715974 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:46:51.718368 [info ] [MainThread]: 
[0m13:46:51.720191 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:46:51.721936 [info ] [MainThread]: 
[0m13:46:51.723751 [error] [MainThread]:   Database Error in model staging_green_tripdata_2019_all (models/staging/staging_green_tripdata_2019_all.sql)
  relation "raw.green_tripdata_2019-01" does not exist
  LINE 10:   select * from "ingest_db"."raw"."green_tripdata_2019-01" u...
                           ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_2019_all.sql
[0m13:46:51.725071 [info ] [MainThread]: 
[0m13:46:51.727075 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:46:51.729466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4373994, "process_in_blocks": "0", "process_kernel_time": 0.153827, "process_mem_max_rss": "115136", "process_out_blocks": "0", "process_user_time": 2.748387}
[0m13:46:51.731988 [debug] [MainThread]: Command `dbt run` failed at 13:46:51.731810 after 3.44 seconds
[0m13:46:51.733234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a9006a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a6f92360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a934bbf0>]}
[0m13:46:51.735284 [debug] [MainThread]: Flushing usage events
[0m13:46:53.685165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:12.735136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ed2e95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ed14ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ed1c4b60>]}


============================== 13:47:12.741100 | cc4370af-e8ea-4e16-87fd-b6cb49c87f4e ==============================
[0m13:47:12.741100 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:12.742591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:12.958856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc4370af-e8ea-4e16-87fd-b6cb49c87f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00eeaff500>]}
[0m13:47:13.030424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc4370af-e8ea-4e16-87fd-b6cb49c87f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ed8d0e90>]}
[0m13:47:13.032046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:13.143986 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:47:13.918831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:13.920368 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/schema.yml
[0m13:47:14.481735 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:47:14.503800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc4370af-e8ea-4e16-87fd-b6cb49c87f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00eb0ed760>]}
[0m13:47:14.679330 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:47:14.691780 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:47:14.722721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc4370af-e8ea-4e16-87fd-b6cb49c87f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00eb470560>]}
[0m13:47:14.723935 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:47:14.725117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc4370af-e8ea-4e16-87fd-b6cb49c87f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00eb325ca0>]}
[0m13:47:14.728824 [info ] [MainThread]: 
[0m13:47:14.731313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:14.733876 [info ] [MainThread]: 
[0m13:47:14.735965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:14.743647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:47:14.779644 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:47:14.782246 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:47:14.784746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:14.794862 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:47:14.798451 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:47:14.803881 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:47:14.806627 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:47:14.809510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:14.822467 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m13:47:14.827249 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:47:14.832396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m13:47:14.847696 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:47:14.851365 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:47:14.853926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:14.868090 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:47:14.870161 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:47:14.871806 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:47:14.877149 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:47:14.879565 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:47:14.880673 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:47:14.881784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:47:14.884460 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:47:14.885719 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:47:14.887467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:14.894552 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:47:14.896374 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:47:14.897543 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:47:14.900864 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:47:14.902982 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:47:14.904528 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:47:14.907160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:47:14.910990 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:47:14.912118 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:47:14.913929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:14.922060 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:47:14.924333 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:47:14.926168 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:47:14.930378 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:47:14.934137 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:47:14.936088 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:47:14.946280 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:14.948332 [debug] [MainThread]: On master: BEGIN
[0m13:47:14.950785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:14.959079 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:47:14.961540 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:14.963313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:14.973337 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:47:14.979199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc4370af-e8ea-4e16-87fd-b6cb49c87f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00eb52a0c0>]}
[0m13:47:14.981261 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:14.984082 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:14.985786 [debug] [MainThread]: On master: BEGIN
[0m13:47:14.988461 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:47:14.990928 [debug] [MainThread]: On master: COMMIT
[0m13:47:14.993408 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:14.995958 [debug] [MainThread]: On master: COMMIT
[0m13:47:14.998787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:15.000790 [debug] [MainThread]: On master: Close
[0m13:47:15.005270 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:47:15.007058 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:47:15.008392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:47:15.009728 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:47:15.024279 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:15.047244 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:47:15.086806 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:15.125118 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:15.128747 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:47:15.131792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:15.151407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:47:15.156876 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:15.163172 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:47:15.184093 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m13:47:15.199459 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:15.202932 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:47:15.209208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:47:15.219087 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:15.221014 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:47:15.224361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:15.269734 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:47:15.273198 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:15.275863 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:47:15.286564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:47:15.307264 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:47:15.317755 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:15.319343 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:47:15.325511 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:47:15.329308 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:47:15.332716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4370af-e8ea-4e16-87fd-b6cb49c87f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00e89c1c10>]}
[0m13:47:15.334645 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.32s]
[0m13:47:15.337160 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:47:15.339450 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:47:15.341045 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:47:15.342802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:47:15.345713 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:47:15.353623 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:47:15.372200 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:47:15.405135 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:47:15.435434 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:47:15.438049 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:47:15.441124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:15.454972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:47:15.457601 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:47:15.460731 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:47:15.466145 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "vendorid" does not exist
LINE 17:   case vendorid
                ^
HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".

[0m13:47:15.468860 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:47:15.472198 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:47:15.478549 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:47:15.480842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc4370af-e8ea-4e16-87fd-b6cb49c87f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00e99b14c0>]}
[0m13:47:15.483762 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.14s]
[0m13:47:15.486367 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:47:15.488483 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:47:15.491444 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:15.492914 [debug] [MainThread]: On master: BEGIN
[0m13:47:15.494591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:15.501140 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:47:15.502317 [debug] [MainThread]: On master: COMMIT
[0m13:47:15.503519 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:15.505414 [debug] [MainThread]: On master: COMMIT
[0m13:47:15.506911 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:15.508293 [debug] [MainThread]: On master: Close
[0m13:47:15.510324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:15.511911 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:47:15.513460 [info ] [MainThread]: 
[0m13:47:15.514678 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m13:47:15.516724 [debug] [MainThread]: Command end result
[0m13:47:15.620171 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:47:15.642303 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:47:15.665204 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:47:15.667502 [info ] [MainThread]: 
[0m13:47:15.669181 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:47:15.670623 [info ] [MainThread]: 
[0m13:47:15.672003 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:47:15.673283 [info ] [MainThread]: 
[0m13:47:15.674702 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:47:15.677205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.089553, "process_in_blocks": "0", "process_kernel_time": 0.248161, "process_mem_max_rss": "115972", "process_out_blocks": "0", "process_user_time": 2.799262}
[0m13:47:15.678808 [debug] [MainThread]: Command `dbt run` failed at 13:47:15.678522 after 3.09 seconds
[0m13:47:15.680745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00ed049760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00eb09ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00e89ef260>]}
[0m13:47:15.683358 [debug] [MainThread]: Flushing usage events
[0m13:47:17.469474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:55.542312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876427950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8776846e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8758bcb60>]}


============================== 13:47:55.546589 | 15fcbf86-e072-4d53-ad98-ea8ef13529e5 ==============================
[0m13:47:55.546589 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:47:55.548259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:55.766697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15fcbf86-e072-4d53-ad98-ea8ef13529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8756e4410>]}
[0m13:47:55.843971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15fcbf86-e072-4d53-ad98-ea8ef13529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb875698bf0>]}
[0m13:47:55.847400 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:55.977162 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:47:57.115795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:57.117077 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:47:57.506059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:47:57.521370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15fcbf86-e072-4d53-ad98-ea8ef13529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb872233590>]}
[0m13:47:57.732487 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:47:57.749443 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:47:57.817920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15fcbf86-e072-4d53-ad98-ea8ef13529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8721c6c90>]}
[0m13:47:57.822050 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:47:57.826161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15fcbf86-e072-4d53-ad98-ea8ef13529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb875925670>]}
[0m13:47:57.831537 [info ] [MainThread]: 
[0m13:47:57.833088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:57.834494 [info ] [MainThread]: 
[0m13:47:57.836160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:57.842374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:47:57.877937 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:47:57.880171 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:47:57.882469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:57.896578 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m13:47:57.900268 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:47:57.904506 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:47:57.905763 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:47:57.906868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:57.915398 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m13:47:57.918121 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:47:57.921181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m13:47:57.928681 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:47:57.930972 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:47:57.932762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:57.940690 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:47:57.942528 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:47:57.944526 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:47:57.949129 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:47:57.952328 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:47:57.954340 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:47:57.956940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:47:57.962905 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:47:57.964437 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:47:57.966702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:57.974826 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:47:57.976954 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:47:57.979285 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:47:57.983708 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:47:57.986967 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:47:57.989618 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:47:57.992163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:47:57.996308 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:47:57.998727 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:47:58.001366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:58.013176 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:47:58.015840 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:47:58.018385 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:47:58.023402 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:47:58.028913 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:47:58.031185 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:47:58.041981 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:58.044850 [debug] [MainThread]: On master: BEGIN
[0m13:47:58.046871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:58.058743 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:47:58.062271 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:58.066235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:58.082347 [debug] [MainThread]: SQL status: SELECT 12 in 0.013 seconds
[0m13:47:58.090529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15fcbf86-e072-4d53-ad98-ea8ef13529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb875597230>]}
[0m13:47:58.094588 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:58.098733 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:58.102764 [debug] [MainThread]: On master: BEGIN
[0m13:47:58.108028 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:47:58.111380 [debug] [MainThread]: On master: COMMIT
[0m13:47:58.115611 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:58.119789 [debug] [MainThread]: On master: COMMIT
[0m13:47:58.125057 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:47:58.130217 [debug] [MainThread]: On master: Close
[0m13:47:58.143645 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:47:58.150000 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:47:58.156608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:47:58.161610 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:47:58.185329 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:58.208830 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:47:58.248385 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:58.275099 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:58.277154 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:47:58.279516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:58.290357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:47:58.293401 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:58.297503 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:47:58.313752 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m13:47:58.342261 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:58.347669 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:47:58.356447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:47:58.373646 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:58.377142 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:47:58.380236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:47:58.403170 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:47:58.404740 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:58.406271 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:47:58.410116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:47:58.418892 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:47:58.426085 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:47:58.427933 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:47:58.433229 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:47:58.437310 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:47:58.441520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15fcbf86-e072-4d53-ad98-ea8ef13529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8774066f0>]}
[0m13:47:58.443706 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.28s]
[0m13:47:58.445779 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:47:58.448471 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:47:58.449769 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:47:58.450936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:47:58.452041 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:47:58.457477 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:47:58.472771 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:47:58.505965 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:47:58.533176 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:47:58.535653 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:47:58.537789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:58.545641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:47:58.548240 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:47:58.551033 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case vendorid
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:47:58.555205 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "vendorid" does not exist
LINE 17:   case vendorid
                ^
HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".

[0m13:47:58.557479 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:47:58.560682 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:47:58.567580 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:47:58.570931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15fcbf86-e072-4d53-ad98-ea8ef13529e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8714b7080>]}
[0m13:47:58.574242 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.12s]
[0m13:47:58.576979 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:47:58.579559 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:47:58.584686 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:58.587487 [debug] [MainThread]: On master: BEGIN
[0m13:47:58.590956 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:58.603056 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:47:58.606209 [debug] [MainThread]: On master: COMMIT
[0m13:47:58.608115 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:58.610242 [debug] [MainThread]: On master: COMMIT
[0m13:47:58.612898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:47:58.615617 [debug] [MainThread]: On master: Close
[0m13:47:58.618048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:58.620231 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:47:58.622818 [info ] [MainThread]: 
[0m13:47:58.624849 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m13:47:58.627353 [debug] [MainThread]: Command end result
[0m13:47:58.725935 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:47:58.739233 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:47:58.759988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:47:58.762606 [info ] [MainThread]: 
[0m13:47:58.764400 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:47:58.765681 [info ] [MainThread]: 
[0m13:47:58.766909 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case vendorid
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:47:58.768153 [info ] [MainThread]: 
[0m13:47:58.769441 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:47:58.771565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.337119, "process_in_blocks": "0", "process_kernel_time": 0.215223, "process_mem_max_rss": "115384", "process_out_blocks": "0", "process_user_time": 2.84682}
[0m13:47:58.773554 [debug] [MainThread]: Command `dbt run` failed at 13:47:58.773339 after 3.34 seconds
[0m13:47:58.775437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876427950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb873c2dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb87222ea20>]}
[0m13:47:58.777299 [debug] [MainThread]: Flushing usage events
[0m13:48:00.492311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:14.939963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32852eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3271524e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb327152c30>]}


============================== 13:48:14.948545 | 12d19dc1-22b1-4e02-b6a7-7069efdeea08 ==============================
[0m13:48:14.948545 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:48:14.951091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:48:15.176470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12d19dc1-22b1-4e02-b6a7-7069efdeea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3266752e0>]}
[0m13:48:15.259983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12d19dc1-22b1-4e02-b6a7-7069efdeea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb326757b90>]}
[0m13:48:15.263349 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:48:15.426949 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:48:17.392829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:48:17.396430 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:48:17.833924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:48:17.873614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12d19dc1-22b1-4e02-b6a7-7069efdeea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316f97920>]}
[0m13:48:18.048693 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:48:18.060309 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:48:18.106011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12d19dc1-22b1-4e02-b6a7-7069efdeea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316f36d20>]}
[0m13:48:18.108169 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:48:18.110116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12d19dc1-22b1-4e02-b6a7-7069efdeea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb316f57980>]}
[0m13:48:18.115556 [info ] [MainThread]: 
[0m13:48:18.121277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:48:18.125555 [info ] [MainThread]: 
[0m13:48:18.128222 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:48:18.138246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:48:18.173028 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:48:18.176978 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:48:18.179177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:18.189151 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:48:18.193315 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:48:18.199233 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:48:18.202012 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:48:18.204816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:18.215326 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:48:18.220750 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:48:18.225619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:48:18.238061 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:48:18.241221 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:48:18.244961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:18.259868 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:48:18.263218 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:48:18.266846 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:48:18.274228 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m13:48:18.280195 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:48:18.283297 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:48:18.290398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:48:18.298171 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:48:18.299714 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:48:18.302019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:18.310016 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:48:18.312261 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:48:18.314216 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:48:18.318544 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:48:18.321869 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:48:18.324907 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:48:18.328141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:48:18.336079 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:48:18.339710 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:48:18.343712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:18.363251 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m13:48:18.367643 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:48:18.372807 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:48:18.385292 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m13:48:18.394312 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:48:18.399858 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:48:18.417533 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:18.420930 [debug] [MainThread]: On master: BEGIN
[0m13:48:18.424470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:18.439840 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:48:18.444130 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:18.449479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:48:18.482057 [debug] [MainThread]: SQL status: SELECT 12 in 0.027 seconds
[0m13:48:18.491687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12d19dc1-22b1-4e02-b6a7-7069efdeea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3241301a0>]}
[0m13:48:18.494203 [debug] [MainThread]: On master: ROLLBACK
[0m13:48:18.496192 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:18.497799 [debug] [MainThread]: On master: BEGIN
[0m13:48:18.499940 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:48:18.502067 [debug] [MainThread]: On master: COMMIT
[0m13:48:18.504359 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:18.506719 [debug] [MainThread]: On master: COMMIT
[0m13:48:18.509853 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:48:18.513151 [debug] [MainThread]: On master: Close
[0m13:48:18.518841 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:48:18.522573 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:48:18.525111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:48:18.526909 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:48:18.544776 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:48:18.569593 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:48:18.609316 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:48:18.643149 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:48:18.647195 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:48:18.651188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:18.674262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m13:48:18.679306 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:48:18.683963 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:48:18.705625 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m13:48:18.716561 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:48:18.718952 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:48:18.722143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:48:18.727022 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:48:18.729284 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:48:18.732383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:48:18.751064 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:48:18.753716 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:48:18.756002 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:48:18.759690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:48:18.767272 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:48:18.773637 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:48:18.775189 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:48:18.779829 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:48:18.784098 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:48:18.787450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12d19dc1-22b1-4e02-b6a7-7069efdeea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb328402cf0>]}
[0m13:48:18.789244 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.26s]
[0m13:48:18.791273 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:48:18.793483 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:48:18.794903 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:48:18.796910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:48:18.798569 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:48:18.808774 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:48:18.827551 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:48:18.853539 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:48:18.879540 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:48:18.882627 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:48:18.885449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:18.896957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:48:18.899748 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:48:18.902957 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case VendorID
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:48:18.908299 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "vendorid" does not exist
LINE 17:   case VendorID
                ^
HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".

[0m13:48:18.910901 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:48:18.914813 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:48:18.923236 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case VendorID
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:48:18.926245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12d19dc1-22b1-4e02-b6a7-7069efdeea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb314821610>]}
[0m13:48:18.928942 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.13s]
[0m13:48:18.933250 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:48:18.935671 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case VendorID
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:48:18.939252 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:18.941235 [debug] [MainThread]: On master: BEGIN
[0m13:48:18.943591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:18.951435 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:48:18.954218 [debug] [MainThread]: On master: COMMIT
[0m13:48:18.955766 [debug] [MainThread]: Using postgres connection "master"
[0m13:48:18.957685 [debug] [MainThread]: On master: COMMIT
[0m13:48:18.960508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:48:18.962021 [debug] [MainThread]: On master: Close
[0m13:48:18.963690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:18.965586 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:48:18.966733 [info ] [MainThread]: 
[0m13:48:18.968121 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m13:48:18.970572 [debug] [MainThread]: Command end result
[0m13:48:19.042613 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:48:19.053042 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:48:19.066655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:48:19.068098 [info ] [MainThread]: 
[0m13:48:19.069395 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:48:19.070589 [info ] [MainThread]: 
[0m13:48:19.071875 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case VendorID
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:48:19.072985 [info ] [MainThread]: 
[0m13:48:19.074230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:48:19.076081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.3097777, "process_in_blocks": "0", "process_kernel_time": 0.278497, "process_mem_max_rss": "115604", "process_out_blocks": "0", "process_user_time": 2.70815}
[0m13:48:19.078298 [debug] [MainThread]: Command `dbt run` failed at 13:48:19.078137 after 4.31 seconds
[0m13:48:19.079667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb326b95220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb326b96a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3265e7cb0>]}
[0m13:48:19.081106 [debug] [MainThread]: Flushing usage events
[0m13:48:20.822845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:03.058268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18daf226c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18dcdcec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18dba6f6e0>]}


============================== 13:50:03.071630 | 5a94e117-2012-47b3-b284-1c315a4beac4 ==============================
[0m13:50:03.071630 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:50:03.076153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:03.301633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a94e117-2012-47b3-b284-1c315a4beac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d943bb90>]}
[0m13:50:03.378804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a94e117-2012-47b3-b284-1c315a4beac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18dbf33170>]}
[0m13:50:03.380789 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:03.525228 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:50:04.936590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:50:04.938041 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/vendor_label.sql
[0m13:50:05.337836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:50:05.354461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a94e117-2012-47b3-b284-1c315a4beac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c35f3b30>]}
[0m13:50:05.576281 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:50:05.583679 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:50:05.620081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a94e117-2012-47b3-b284-1c315a4beac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c34228d0>]}
[0m13:50:05.621783 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:50:05.622993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a94e117-2012-47b3-b284-1c315a4beac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d93eacc0>]}
[0m13:50:05.626913 [info ] [MainThread]: 
[0m13:50:05.628242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:05.629651 [info ] [MainThread]: 
[0m13:50:05.631540 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:05.640109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:50:05.677065 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:50:05.679009 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:50:05.681300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:05.690557 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m13:50:05.693459 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:50:05.697444 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:50:05.699487 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:50:05.701918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:05.714365 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m13:50:05.719832 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:50:05.725521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_staging)
[0m13:50:05.742599 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:50:05.745146 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:50:05.747450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:05.755039 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:50:05.756376 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:50:05.758139 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:50:05.764375 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:50:05.766633 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:50:05.767680 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:50:05.768837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m13:50:05.771860 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:50:05.774392 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:50:05.775875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:05.783496 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:50:05.785771 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:50:05.788186 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:05.792874 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:50:05.799210 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:50:05.801984 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:50:05.805729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:50:05.815523 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:50:05.817267 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:50:05.819760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:05.832539 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:50:05.835567 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:50:05.839010 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:50:05.847679 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:50:05.852473 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:50:05.854923 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:50:05.864411 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:05.866262 [debug] [MainThread]: On master: BEGIN
[0m13:50:05.868025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:05.877924 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:50:05.879860 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:05.882346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:05.905663 [debug] [MainThread]: SQL status: SELECT 12 in 0.021 seconds
[0m13:50:05.917006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a94e117-2012-47b3-b284-1c315a4beac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c35f3b30>]}
[0m13:50:05.919570 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:05.922432 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:05.924614 [debug] [MainThread]: On master: BEGIN
[0m13:50:05.928007 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:50:05.930052 [debug] [MainThread]: On master: COMMIT
[0m13:50:05.931905 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:05.933637 [debug] [MainThread]: On master: COMMIT
[0m13:50:05.935742 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:05.937897 [debug] [MainThread]: On master: Close
[0m13:50:05.943715 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:50:05.946013 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:50:05.949526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:50:05.950978 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:50:05.966004 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:05.978597 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:50:06.018476 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:06.036182 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:06.038773 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:50:06.041556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:06.058173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:50:06.063331 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:06.068884 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:50:06.094316 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m13:50:06.125581 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:06.131861 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:50:06.141917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:50:06.163877 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:06.170291 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:50:06.179426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:50:06.202446 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:50:06.204900 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:06.208165 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:50:06.215690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:50:06.229639 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:50:06.237189 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:06.238624 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:50:06.243420 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:50:06.247975 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:50:06.251787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a94e117-2012-47b3-b284-1c315a4beac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c27e97c0>]}
[0m13:50:06.254045 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.30s]
[0m13:50:06.255825 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:50:06.258420 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:50:06.260043 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:50:06.261399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:50:06.262343 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:50:06.272587 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:50:06.285646 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:50:06.312439 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:50:06.329472 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:50:06.330521 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:50:06.331784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:06.338066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:50:06.340010 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:50:06.341847 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case column
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:50:06.344006 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "column"
LINE 17:   case column
                ^

[0m13:50:06.345662 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:50:06.347379 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:50:06.351777 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "column"
  LINE 17:   case column
                  ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:50:06.353505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a94e117-2012-47b3-b284-1c315a4beac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18c26af7a0>]}
[0m13:50:06.356117 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.09s]
[0m13:50:06.357583 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:50:06.359223 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "column"
  LINE 17:   case column
                  ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:50:06.362514 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:06.363654 [debug] [MainThread]: On master: BEGIN
[0m13:50:06.364847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:06.372467 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:50:06.373859 [debug] [MainThread]: On master: COMMIT
[0m13:50:06.375097 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:06.376108 [debug] [MainThread]: On master: COMMIT
[0m13:50:06.377460 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:06.378318 [debug] [MainThread]: On master: Close
[0m13:50:06.379288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:06.380020 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:50:06.380967 [info ] [MainThread]: 
[0m13:50:06.384189 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m13:50:06.387062 [debug] [MainThread]: Command end result
[0m13:50:06.437778 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:50:06.443833 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:50:06.455769 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:50:06.456936 [info ] [MainThread]: 
[0m13:50:06.458202 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:50:06.459370 [info ] [MainThread]: 
[0m13:50:06.460501 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  syntax error at or near "column"
  LINE 17:   case column
                  ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:50:06.461491 [info ] [MainThread]: 
[0m13:50:06.462733 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:50:06.465289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.58013, "process_in_blocks": "0", "process_kernel_time": 0.22494, "process_mem_max_rss": "115592", "process_out_blocks": "0", "process_user_time": 2.801534}
[0m13:50:06.466723 [debug] [MainThread]: Command `dbt run` failed at 13:50:06.466522 after 3.58 seconds
[0m13:50:06.467877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18dabf3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18d9025bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18dadc0a70>]}
[0m13:50:06.469547 [debug] [MainThread]: Flushing usage events
[0m13:50:08.664858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:35.535098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfaeb9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfac81d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb543a10>]}


============================== 13:50:35.542036 | af0631de-9a94-45e5-97ac-d22f96d0f4c0 ==============================
[0m13:50:35.542036 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:50:35.545341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:35.787073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af0631de-9a94-45e5-97ac-d22f96d0f4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfac83aa0>]}
[0m13:50:35.872845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af0631de-9a94-45e5-97ac-d22f96d0f4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf938fb60>]}
[0m13:50:35.876356 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:36.011839 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:50:38.410022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:50:38.411412 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/vendor_label.sql
[0m13:50:38.858425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:50:38.879568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af0631de-9a94-45e5-97ac-d22f96d0f4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf80eb6e0>]}
[0m13:50:39.063604 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:50:39.074782 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:50:39.108549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af0631de-9a94-45e5-97ac-d22f96d0f4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf80924b0>]}
[0m13:50:39.110131 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:50:39.111626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0631de-9a94-45e5-97ac-d22f96d0f4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf8ed1580>]}
[0m13:50:39.115520 [info ] [MainThread]: 
[0m13:50:39.117291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:39.118694 [info ] [MainThread]: 
[0m13:50:39.120417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:39.127549 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:50:39.162959 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:50:39.165266 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:50:39.167654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:39.177792 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:50:39.181829 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:50:39.187326 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:50:39.189750 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:50:39.192698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:39.207207 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m13:50:39.212755 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:50:39.217570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:50:39.227513 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:50:39.230375 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:50:39.232946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:39.241266 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:50:39.242861 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:50:39.244467 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:39.248574 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:50:39.252606 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:50:39.255499 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:50:39.258583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:50:39.268898 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:50:39.270782 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:50:39.272493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:39.279935 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:50:39.282252 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:50:39.284457 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:50:39.288882 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:39.292260 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:50:39.294347 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:50:39.296764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:50:39.299519 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:50:39.301098 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:50:39.302789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:39.309935 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:50:39.311760 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:50:39.313116 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:50:39.317391 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:50:39.321099 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:50:39.323315 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:50:39.330045 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:39.332083 [debug] [MainThread]: On master: BEGIN
[0m13:50:39.334129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:39.344380 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:50:39.346611 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:39.349437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:39.365772 [debug] [MainThread]: SQL status: SELECT 12 in 0.013 seconds
[0m13:50:39.373959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af0631de-9a94-45e5-97ac-d22f96d0f4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf80a6c60>]}
[0m13:50:39.376709 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:39.380491 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:39.383415 [debug] [MainThread]: On master: BEGIN
[0m13:50:39.387636 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:50:39.389856 [debug] [MainThread]: On master: COMMIT
[0m13:50:39.392222 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:39.395849 [debug] [MainThread]: On master: COMMIT
[0m13:50:39.398344 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:39.400424 [debug] [MainThread]: On master: Close
[0m13:50:39.404384 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:50:39.406263 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:50:39.408138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:50:39.409441 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:50:39.421606 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:39.432598 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:50:39.477946 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:39.499202 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:39.500820 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:50:39.502845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:39.512536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:50:39.515315 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:39.518094 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:50:39.532443 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:50:39.559125 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:39.562002 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:50:39.566999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:50:39.575956 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:39.578105 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:50:39.580849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:39.598803 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:50:39.600056 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:39.601537 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:50:39.607881 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:50:39.615416 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:50:39.622990 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:50:39.626108 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:50:39.632757 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:50:39.637188 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:50:39.641819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af0631de-9a94-45e5-97ac-d22f96d0f4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc8ae2d0>]}
[0m13:50:39.644409 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.23s]
[0m13:50:39.646341 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:50:39.648459 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:50:39.650072 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:50:39.651557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:50:39.653202 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:50:39.661315 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:50:39.685250 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:50:39.717067 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:50:39.730821 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:50:39.732868 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:50:39.734818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:39.741952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:50:39.744191 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:50:39.745812 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case VendorID
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:50:39.748778 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "vendorid" does not exist
LINE 17:   case VendorID
                ^
HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".

[0m13:50:39.750156 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:50:39.751723 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:50:39.756027 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case VendorID
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:50:39.757914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af0631de-9a94-45e5-97ac-d22f96d0f4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf30e8c20>]}
[0m13:50:39.760174 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.11s]
[0m13:50:39.763315 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:50:39.764962 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case VendorID
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:50:39.769545 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:39.772027 [debug] [MainThread]: On master: BEGIN
[0m13:50:39.774442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:39.781725 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:50:39.784546 [debug] [MainThread]: On master: COMMIT
[0m13:50:39.785637 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:39.786687 [debug] [MainThread]: On master: COMMIT
[0m13:50:39.787959 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:39.789042 [debug] [MainThread]: On master: Close
[0m13:50:39.790312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:39.791432 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:50:39.793681 [info ] [MainThread]: 
[0m13:50:39.797091 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m13:50:39.799881 [debug] [MainThread]: Command end result
[0m13:50:39.851952 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:50:39.857191 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:50:39.866988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:50:39.867968 [info ] [MainThread]: 
[0m13:50:39.869850 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:50:39.871558 [info ] [MainThread]: 
[0m13:50:39.876154 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 17:   case VendorID
                  ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:50:39.877628 [info ] [MainThread]: 
[0m13:50:39.879829 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:50:39.882444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5023427, "process_in_blocks": "0", "process_kernel_time": 0.209763, "process_mem_max_rss": "117556", "process_out_blocks": "0", "process_user_time": 3.056559}
[0m13:50:39.883947 [debug] [MainThread]: Command `dbt run` failed at 13:50:39.883741 after 4.50 seconds
[0m13:50:39.885311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb0cfec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfb0cf5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cf8f833b0>]}
[0m13:50:39.886529 [debug] [MainThread]: Flushing usage events
[0m13:50:41.081389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:28.422981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3758fbc560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375751f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37578c75c0>]}


============================== 13:52:28.428476 | 095402c7-7cd8-4018-83ce-0a02d0d23acc ==============================
[0m13:52:28.428476 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:52:28.430714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:28.651424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '095402c7-7cd8-4018-83ce-0a02d0d23acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37558e7980>]}
[0m13:52:28.721096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '095402c7-7cd8-4018-83ce-0a02d0d23acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375710f980>]}
[0m13:52:28.723752 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:52:28.820941 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:52:30.451855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:30.453716 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/vendor_label.sql
[0m13:52:30.882864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:52:30.902590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '095402c7-7cd8-4018-83ce-0a02d0d23acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374f8979b0>]}
[0m13:52:31.070373 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:52:31.080092 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:52:31.108980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '095402c7-7cd8-4018-83ce-0a02d0d23acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374f8369c0>]}
[0m13:52:31.110899 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:52:31.112495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095402c7-7cd8-4018-83ce-0a02d0d23acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3755358350>]}
[0m13:52:31.115690 [info ] [MainThread]: 
[0m13:52:31.116995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:31.118777 [info ] [MainThread]: 
[0m13:52:31.121059 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:31.128407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:52:31.166765 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:52:31.169296 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:52:31.171118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:31.180583 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m13:52:31.183917 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:52:31.188323 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:52:31.190102 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:52:31.191781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:31.199295 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m13:52:31.202347 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:52:31.205985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:52:31.215610 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:52:31.218185 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:52:31.220456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:31.230321 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:52:31.232748 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:52:31.235047 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:52:31.240031 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m13:52:31.243937 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:52:31.245664 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:52:31.249673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:52:31.259551 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:52:31.261461 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:52:31.263609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:31.271495 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:52:31.273071 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:52:31.274906 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:52:31.279019 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:52:31.282504 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:52:31.283953 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:52:31.285910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:52:31.289532 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:52:31.291433 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:52:31.292994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:31.300317 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:52:31.301931 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:52:31.303463 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:52:31.307810 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:52:31.310874 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:52:31.312663 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:52:31.319309 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:31.321715 [debug] [MainThread]: On master: BEGIN
[0m13:52:31.323590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:31.331574 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:52:31.333674 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:31.335955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:31.346180 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:52:31.352020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '095402c7-7cd8-4018-83ce-0a02d0d23acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375576c2f0>]}
[0m13:52:31.353619 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:31.355895 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:31.357539 [debug] [MainThread]: On master: BEGIN
[0m13:52:31.359879 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:52:31.361690 [debug] [MainThread]: On master: COMMIT
[0m13:52:31.362784 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:31.363884 [debug] [MainThread]: On master: COMMIT
[0m13:52:31.365416 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:31.366638 [debug] [MainThread]: On master: Close
[0m13:52:31.369345 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:52:31.370545 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:52:31.371804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:52:31.373468 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:52:31.390431 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:52:31.406350 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:52:31.450965 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:52:31.470034 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:52:31.471604 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:52:31.473430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:31.480634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:52:31.482773 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:52:31.485075 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:52:31.494166 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:52:31.504877 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:52:31.507927 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:52:31.512290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:52:31.518798 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:52:31.521380 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:52:31.525362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:31.548128 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:52:31.550788 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:52:31.553480 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:52:31.558629 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:52:31.567859 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:52:31.576782 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:52:31.583882 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:52:31.590383 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:52:31.595474 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:52:31.599515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '095402c7-7cd8-4018-83ce-0a02d0d23acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3758d3a6f0>]}
[0m13:52:31.602195 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.23s]
[0m13:52:31.603897 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:52:31.606047 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:52:31.607421 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:52:31.608609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:52:31.609667 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:52:31.617756 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:52:31.626133 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:52:31.651669 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:52:31.668201 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:52:31.669479 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:52:31.670626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:31.676990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:52:31.678400 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:52:31.680004 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case
    when VendorID = 1 then 'Creative Mobile Technologies'
    when VendorID = 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)
 as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:52:31.682790 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "vendorid" does not exist
LINE 18:     when VendorID = 1 then 'Creative Mobile Technologies'
                  ^
HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".

[0m13:52:31.684281 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:52:31.685478 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:52:31.689728 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 18:     when VendorID = 1 then 'Creative Mobile Technologies'
                    ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:52:31.691450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '095402c7-7cd8-4018-83ce-0a02d0d23acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374eb161e0>]}
[0m13:52:31.693078 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.08s]
[0m13:52:31.694653 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:52:31.695927 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 18:     when VendorID = 1 then 'Creative Mobile Technologies'
                    ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:52:31.698999 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:31.700073 [debug] [MainThread]: On master: BEGIN
[0m13:52:31.701032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:31.708413 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:52:31.709910 [debug] [MainThread]: On master: COMMIT
[0m13:52:31.711765 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:31.713450 [debug] [MainThread]: On master: COMMIT
[0m13:52:31.715150 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:31.716646 [debug] [MainThread]: On master: Close
[0m13:52:31.718168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:31.719192 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:52:31.720384 [info ] [MainThread]: 
[0m13:52:31.721606 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m13:52:31.723486 [debug] [MainThread]: Command end result
[0m13:52:31.793104 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:52:31.800073 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:52:31.817867 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:52:31.819439 [info ] [MainThread]: 
[0m13:52:31.820605 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:52:31.821905 [info ] [MainThread]: 
[0m13:52:31.823275 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "vendorid" does not exist
  LINE 18:     when VendorID = 1 then 'Creative Mobile Technologies'
                    ^
  HINT:  Perhaps you meant to reference the column "staging_green_tripdata_2019_all.VendorID".
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:52:31.824721 [info ] [MainThread]: 
[0m13:52:31.826086 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:52:31.828052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5442655, "process_in_blocks": "0", "process_kernel_time": 0.274279, "process_mem_max_rss": "115724", "process_out_blocks": "0", "process_user_time": 2.824064}
[0m13:52:31.830521 [debug] [MainThread]: Command `dbt run` failed at 13:52:31.830190 after 3.55 seconds
[0m13:52:31.833000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375738fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374f97f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374f97fbc0>]}
[0m13:52:31.834978 [debug] [MainThread]: Flushing usage events
[0m13:52:32.817439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:20.943648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2369f7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23821a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff236956c30>]}


============================== 13:53:20.950108 | dc9e769a-cd71-4d7e-8f3c-c8f85bc394ed ==============================
[0m13:53:20.950108 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:53:20.952821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:53:21.240824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc9e769a-cd71-4d7e-8f3c-c8f85bc394ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff236e07470>]}
[0m13:53:21.333591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc9e769a-cd71-4d7e-8f3c-c8f85bc394ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff236fd45f0>]}
[0m13:53:21.336133 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:53:21.457439 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:53:27.690695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:53:27.694409 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/vendor_label.sql
[0m13:53:28.080446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:53:28.098540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc9e769a-cd71-4d7e-8f3c-c8f85bc394ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff232f27860>]}
[0m13:53:28.323494 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:53:28.341125 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:53:28.385857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc9e769a-cd71-4d7e-8f3c-c8f85bc394ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff232ec2720>]}
[0m13:53:28.388485 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:53:28.390926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9e769a-cd71-4d7e-8f3c-c8f85bc394ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff232ee4350>]}
[0m13:53:28.396798 [info ] [MainThread]: 
[0m13:53:28.398488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:28.400042 [info ] [MainThread]: 
[0m13:53:28.402104 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:53:28.411410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:53:28.474169 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:53:28.476153 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:53:28.477794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:28.489828 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m13:53:28.493043 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:53:28.497327 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:53:28.498931 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:53:28.500389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:28.507244 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m13:53:28.509716 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:53:28.512617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_marts)
[0m13:53:28.521188 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:53:28.522465 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:53:28.523342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:28.529797 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:53:28.531161 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:53:28.532129 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:53:28.535568 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:53:28.537830 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:53:28.539072 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:53:28.540336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public)
[0m13:53:28.543016 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:53:28.543947 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:53:28.544771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:28.550315 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:53:28.551483 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:53:28.552387 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:53:28.555454 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:53:28.560137 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:53:28.562448 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:53:28.565219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:53:28.572693 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:53:28.575114 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:53:28.576951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:28.586947 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:53:28.589781 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:53:28.592625 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:53:28.598336 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:53:28.602171 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:53:28.604659 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:53:28.611564 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:28.613225 [debug] [MainThread]: On master: BEGIN
[0m13:53:28.614512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:28.621042 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:53:28.622693 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:28.624048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:53:28.633491 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m13:53:28.638709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9e769a-cd71-4d7e-8f3c-c8f85bc394ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff234a969c0>]}
[0m13:53:28.640202 [debug] [MainThread]: On master: ROLLBACK
[0m13:53:28.641661 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:28.642874 [debug] [MainThread]: On master: BEGIN
[0m13:53:28.644347 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:53:28.645496 [debug] [MainThread]: On master: COMMIT
[0m13:53:28.647392 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:28.649145 [debug] [MainThread]: On master: COMMIT
[0m13:53:28.651191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:53:28.652806 [debug] [MainThread]: On master: Close
[0m13:53:28.657179 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:53:28.658907 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:53:28.660329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:53:28.661611 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:53:28.675613 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:28.687365 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:53:28.728287 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:28.743624 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:28.745652 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:53:28.747076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:28.753767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:53:28.755423 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:28.756836 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:53:28.763835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:53:28.773620 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:28.775173 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:53:28.777509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:28.781638 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:28.783003 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:53:28.785535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:28.814073 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:53:28.816189 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:28.817740 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:53:28.821496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:53:28.829125 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:53:28.834897 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:28.836301 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:53:28.841088 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:53:28.844592 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:53:28.847306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9e769a-cd71-4d7e-8f3c-c8f85bc394ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2380ce450>]}
[0m13:53:28.849107 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.19s]
[0m13:53:28.851103 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:53:28.853437 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:53:28.854886 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:53:28.856412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:53:28.857793 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:53:28.867444 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:53:28.883472 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:53:28.909582 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:53:28.932597 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:53:28.935544 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:53:28.938970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:28.949631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:53:28.952253 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:53:28.955266 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case
    when "VendorID" = 1 then 'Creative Mobile Technologies'
    when "VendorID" = 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)
 as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:53:28.965945 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "pulocationid" does not exist
LINE 55:     count(distinct pulocationid) as unique_pickup_locations,
                            ^

[0m13:53:28.969949 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:53:28.975868 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:53:28.990984 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "pulocationid" does not exist
  LINE 55:     count(distinct pulocationid) as unique_pickup_locations,
                              ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:53:28.997034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9e769a-cd71-4d7e-8f3c-c8f85bc394ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff232179b50>]}
[0m13:53:29.003453 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.14s]
[0m13:53:29.009478 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:53:29.017213 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "pulocationid" does not exist
  LINE 55:     count(distinct pulocationid) as unique_pickup_locations,
                              ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:53:29.035281 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:29.041835 [debug] [MainThread]: On master: BEGIN
[0m13:53:29.049876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:29.081106 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m13:53:29.087956 [debug] [MainThread]: On master: COMMIT
[0m13:53:29.094726 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:29.102325 [debug] [MainThread]: On master: COMMIT
[0m13:53:29.111121 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:53:29.119559 [debug] [MainThread]: On master: Close
[0m13:53:29.130288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:29.140231 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:53:29.149112 [info ] [MainThread]: 
[0m13:53:29.157805 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m13:53:29.173856 [debug] [MainThread]: Command end result
[0m13:53:29.276087 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:53:29.291889 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:53:29.329600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:53:29.336767 [info ] [MainThread]: 
[0m13:53:29.345225 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:53:29.354275 [info ] [MainThread]: 
[0m13:53:29.367333 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "pulocationid" does not exist
  LINE 55:     count(distinct pulocationid) as unique_pickup_locations,
                              ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:53:29.374918 [info ] [MainThread]: 
[0m13:53:29.386642 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:53:29.404675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.590202, "process_in_blocks": "0", "process_kernel_time": 0.472076, "process_mem_max_rss": "115388", "process_out_blocks": "0", "process_user_time": 2.963032}
[0m13:53:29.416153 [debug] [MainThread]: Command `dbt run` failed at 13:53:29.415075 after 8.61 seconds
[0m13:53:29.421049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff236887c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff236e34bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff236e34200>]}
[0m13:53:29.426521 [debug] [MainThread]: Flushing usage events
[0m13:53:30.709486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:57.649480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4b169c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4b2345b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4b02e3b30>]}


============================== 13:53:57.653092 | 9502d957-b50f-4815-a5f7-0f03c55db529 ==============================
[0m13:53:57.653092 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:53:57.654347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:53:57.864515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9502d957-b50f-4815-a5f7-0f03c55db529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4b141f230>]}
[0m13:53:57.937953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9502d957-b50f-4815-a5f7-0f03c55db529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4af6c87a0>]}
[0m13:53:57.941309 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:53:58.079861 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:53:58.961064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:53:58.962519 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/vendor_label.sql
[0m13:53:59.367403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:53:59.388294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9502d957-b50f-4815-a5f7-0f03c55db529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ada11730>]}
[0m13:53:59.572420 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:53:59.579665 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:53:59.611214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9502d957-b50f-4815-a5f7-0f03c55db529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a7f667e0>]}
[0m13:53:59.612902 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:53:59.614588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9502d957-b50f-4815-a5f7-0f03c55db529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4af582f30>]}
[0m13:53:59.618499 [info ] [MainThread]: 
[0m13:53:59.620488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:59.622930 [info ] [MainThread]: 
[0m13:53:59.625600 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:53:59.632612 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:53:59.668326 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:53:59.670793 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:53:59.673725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:59.684017 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:53:59.687847 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:53:59.693780 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:53:59.696694 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:53:59.699958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:59.711435 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m13:53:59.716405 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:53:59.721916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:53:59.736881 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:53:59.739445 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:53:59.741606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:59.750882 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:53:59.752751 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:53:59.754096 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:53:59.757721 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:53:59.760780 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:53:59.763157 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:53:59.765707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:53:59.774659 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:53:59.776813 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:53:59.778853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:59.787764 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:53:59.790633 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:53:59.793210 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:53:59.798541 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:53:59.802313 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:53:59.805578 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:53:59.808598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:53:59.812629 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:53:59.814783 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:53:59.817703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:59.827789 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:53:59.829694 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:53:59.830680 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:53:59.833814 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:53:59.836188 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:53:59.837926 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:53:59.844405 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:59.846051 [debug] [MainThread]: On master: BEGIN
[0m13:53:59.848194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:59.855382 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:53:59.857290 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:59.859181 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:53:59.870459 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m13:53:59.876052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9502d957-b50f-4815-a5f7-0f03c55db529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4af5b3440>]}
[0m13:53:59.877684 [debug] [MainThread]: On master: ROLLBACK
[0m13:53:59.879169 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:59.880529 [debug] [MainThread]: On master: BEGIN
[0m13:53:59.882390 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:53:59.883613 [debug] [MainThread]: On master: COMMIT
[0m13:53:59.885113 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:59.886132 [debug] [MainThread]: On master: COMMIT
[0m13:53:59.887569 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:53:59.888870 [debug] [MainThread]: On master: Close
[0m13:53:59.894568 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:53:59.898415 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:53:59.900700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:53:59.902837 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:53:59.920829 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:59.933049 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:53:59.976092 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:59.986380 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:59.988008 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:53:59.989535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:59.996362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:53:59.997738 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:53:59.999110 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:54:00.007080 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:54:00.026985 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:54:00.029664 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:54:00.032754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:00.037550 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:54:00.039781 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:54:00.043771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:00.062893 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:54:00.065503 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:54:00.067972 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:54:00.072979 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:54:00.081882 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:54:00.089201 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:54:00.092050 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:54:00.099053 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:54:00.104493 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:54:00.108844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9502d957-b50f-4815-a5f7-0f03c55db529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4b141e480>]}
[0m13:54:00.111905 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.21s]
[0m13:54:00.113768 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:54:00.116429 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:54:00.117884 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:54:00.119057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:54:00.120117 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:54:00.129791 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:54:00.149173 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:54:00.173597 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:54:00.200237 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:54:00.202557 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:54:00.204756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:00.212599 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:54:00.214633 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:54:00.216873 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct pulocationid) as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:54:00.221093 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "pulocationid" does not exist
LINE 54:     count(distinct pulocationid) as unique_pickup_locations,
                            ^

[0m13:54:00.223017 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:54:00.226066 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:54:00.232087 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "pulocationid" does not exist
  LINE 54:     count(distinct pulocationid) as unique_pickup_locations,
                              ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:54:00.235132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9502d957-b50f-4815-a5f7-0f03c55db529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a7219040>]}
[0m13:54:00.239169 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.12s]
[0m13:54:00.241662 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:54:00.244397 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "pulocationid" does not exist
  LINE 54:     count(distinct pulocationid) as unique_pickup_locations,
                              ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:54:00.249040 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:00.251934 [debug] [MainThread]: On master: BEGIN
[0m13:54:00.253854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:00.262431 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:54:00.264241 [debug] [MainThread]: On master: COMMIT
[0m13:54:00.266780 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:00.269260 [debug] [MainThread]: On master: COMMIT
[0m13:54:00.271145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:00.273313 [debug] [MainThread]: On master: Close
[0m13:54:00.275826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:00.277573 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:54:00.279098 [info ] [MainThread]: 
[0m13:54:00.281006 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m13:54:00.283749 [debug] [MainThread]: Command end result
[0m13:54:00.360962 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:54:00.368998 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:54:00.382496 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:54:00.383813 [info ] [MainThread]: 
[0m13:54:00.385088 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:54:00.386578 [info ] [MainThread]: 
[0m13:54:00.388298 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "pulocationid" does not exist
  LINE 54:     count(distinct pulocationid) as unique_pickup_locations,
                              ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:54:00.389691 [info ] [MainThread]: 
[0m13:54:00.391022 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:54:00.394503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8614023, "process_in_blocks": "0", "process_kernel_time": 0.177, "process_mem_max_rss": "113480", "process_out_blocks": "0", "process_user_time": 2.782844}
[0m13:54:00.396534 [debug] [MainThread]: Command `dbt run` failed at 13:54:00.396334 after 2.86 seconds
[0m13:54:00.397760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4af86e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4af5ce9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4afa0fbf0>]}
[0m13:54:00.399427 [debug] [MainThread]: Flushing usage events
[0m13:54:01.373604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:32.876081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e425c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e57cfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e37ccf80>]}


============================== 13:55:32.880160 | 27a5ac7a-b779-49d2-9e01-6ad9c50d2102 ==============================
[0m13:55:32.880160 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:55:32.881734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:33.117910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27a5ac7a-b779-49d2-9e01-6ad9c50d2102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e3aa14f0>]}
[0m13:55:33.195606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27a5ac7a-b779-49d2-9e01-6ad9c50d2102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e35f4f80>]}
[0m13:55:33.197943 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:33.297607 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:55:35.242656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:35.245235 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:55:35.642527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:55:35.661661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27a5ac7a-b779-49d2-9e01-6ad9c50d2102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e0143a70>]}
[0m13:55:35.885941 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:55:35.906985 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:55:35.953596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27a5ac7a-b779-49d2-9e01-6ad9c50d2102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e00d6cf0>]}
[0m13:55:35.956249 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:55:35.958059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27a5ac7a-b779-49d2-9e01-6ad9c50d2102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e19acb30>]}
[0m13:55:35.962418 [info ] [MainThread]: 
[0m13:55:35.964074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:35.965732 [info ] [MainThread]: 
[0m13:55:35.967597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:35.974219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:55:36.010519 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:55:36.013033 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:55:36.015191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:36.025887 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m13:55:36.030697 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:55:36.038656 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:55:36.042561 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:55:36.046501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:36.061718 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.015 seconds
[0m13:55:36.067457 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:55:36.074429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:55:36.093856 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:55:36.097347 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:55:36.100870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:36.120435 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m13:55:36.125107 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:55:36.130165 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:36.143387 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.008 seconds
[0m13:55:36.151707 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:55:36.154667 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:55:36.158240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_staging)
[0m13:55:36.168751 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:55:36.170209 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:55:36.171427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:36.178121 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:55:36.179718 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:55:36.181080 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:55:36.185213 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:55:36.188544 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:55:36.190942 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:55:36.193529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:55:36.197065 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:55:36.199540 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:55:36.201679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:36.209593 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:55:36.211794 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:55:36.214705 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:55:36.220001 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:55:36.224742 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:55:36.228356 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:55:36.239829 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:36.243121 [debug] [MainThread]: On master: BEGIN
[0m13:55:36.246643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:36.259255 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:55:36.262546 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:36.266341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:36.294672 [debug] [MainThread]: SQL status: SELECT 12 in 0.025 seconds
[0m13:55:36.314280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27a5ac7a-b779-49d2-9e01-6ad9c50d2102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e34af1a0>]}
[0m13:55:36.319529 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:36.327252 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:36.333896 [debug] [MainThread]: On master: BEGIN
[0m13:55:36.342666 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:55:36.349033 [debug] [MainThread]: On master: COMMIT
[0m13:55:36.355296 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:36.360965 [debug] [MainThread]: On master: COMMIT
[0m13:55:36.371563 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:55:36.384406 [debug] [MainThread]: On master: Close
[0m13:55:36.397570 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:55:36.402770 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:55:36.411345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:55:36.418273 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:55:36.440858 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:55:36.499467 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:55:36.554272 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:55:36.583754 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:55:36.586908 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:55:36.589242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:36.599460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:55:36.602104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:55:36.604758 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:55:36.619888 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m13:55:36.635883 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:55:36.638713 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:55:36.643338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:36.655843 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:55:36.658743 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:55:36.663356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:55:36.687884 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:55:36.689554 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:55:36.690727 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:55:36.697297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:55:36.704730 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:55:36.711687 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:55:36.714194 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:55:36.719408 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:55:36.722701 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:55:36.726771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27a5ac7a-b779-49d2-9e01-6ad9c50d2102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e17f97c0>]}
[0m13:55:36.730551 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.31s]
[0m13:55:36.733368 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:55:36.735771 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:55:36.737916 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:55:36.740976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:55:36.743354 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:55:36.752822 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:55:36.773084 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:55:36.810411 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:55:36.843382 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:55:36.847773 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:55:36.853514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:36.882420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m13:55:36.888451 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:55:36.895113 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "pulocationid") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:55:36.913293 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "pulocationid" does not exist
LINE 54:     count(distinct "pulocationid") as unique_pickup_location...
                            ^

[0m13:55:36.918374 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:55:36.920971 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:55:36.945903 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "pulocationid" does not exist
  LINE 54:     count(distinct "pulocationid") as unique_pickup_location...
                              ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:55:36.950126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27a5ac7a-b779-49d2-9e01-6ad9c50d2102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d3118bf0>]}
[0m13:55:36.956536 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.21s]
[0m13:55:36.964284 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:55:36.973404 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "pulocationid" does not exist
  LINE 54:     count(distinct "pulocationid") as unique_pickup_location...
                              ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:55:36.982000 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:36.989523 [debug] [MainThread]: On master: BEGIN
[0m13:55:36.996574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:37.019335 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m13:55:37.023493 [debug] [MainThread]: On master: COMMIT
[0m13:55:37.028264 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:37.031475 [debug] [MainThread]: On master: COMMIT
[0m13:55:37.036384 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:55:37.040894 [debug] [MainThread]: On master: Close
[0m13:55:37.048425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:37.053896 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:55:37.060392 [info ] [MainThread]: 
[0m13:55:37.065389 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m13:55:37.067800 [debug] [MainThread]: Command end result
[0m13:55:37.227430 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:55:37.260628 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:55:37.291665 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:55:37.296652 [info ] [MainThread]: 
[0m13:55:37.305942 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:55:37.315532 [info ] [MainThread]: 
[0m13:55:37.325628 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "pulocationid" does not exist
  LINE 54:     count(distinct "pulocationid") as unique_pickup_location...
                              ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:55:37.331609 [info ] [MainThread]: 
[0m13:55:37.337360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:55:37.345363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5970798, "process_in_blocks": "0", "process_kernel_time": 0.246988, "process_mem_max_rss": "115792", "process_out_blocks": "0", "process_user_time": 3.013263}
[0m13:55:37.351543 [debug] [MainThread]: Command `dbt run` failed at 13:55:37.350990 after 4.60 seconds
[0m13:55:37.355334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e3638560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e4227ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e38346e0>]}
[0m13:55:37.359277 [debug] [MainThread]: Flushing usage events
[0m13:55:39.260532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:14.441947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5be863530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5be16e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5be8631a0>]}


============================== 13:56:14.449844 | d991f477-234f-4ff8-b796-1d00cbfd1cdc ==============================
[0m13:56:14.449844 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:56:14.452991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:14.723580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd991f477-234f-4ff8-b796-1d00cbfd1cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5be010620>]}
[0m13:56:14.795323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd991f477-234f-4ff8-b796-1d00cbfd1cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bdd7cc80>]}
[0m13:56:14.797886 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:56:14.944733 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:56:16.551142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:56:16.552409 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:56:16.962090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:56:16.978053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd991f477-234f-4ff8-b796-1d00cbfd1cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bc5360c0>]}
[0m13:56:17.184847 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:56:17.201298 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:56:17.232274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd991f477-234f-4ff8-b796-1d00cbfd1cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba6aeb10>]}
[0m13:56:17.234997 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:56:17.236566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd991f477-234f-4ff8-b796-1d00cbfd1cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ba6d7470>]}
[0m13:56:17.239609 [info ] [MainThread]: 
[0m13:56:17.241177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:17.242556 [info ] [MainThread]: 
[0m13:56:17.245209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:17.253183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:56:17.288665 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:56:17.290508 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:56:17.292616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:17.301763 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m13:56:17.305328 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:56:17.310367 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:56:17.312252 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:56:17.315373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:17.326043 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m13:56:17.332390 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:56:17.337329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_staging)
[0m13:56:17.349369 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:56:17.351536 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:56:17.354103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:17.367125 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:56:17.368559 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:56:17.369552 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:56:17.374658 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:56:17.378517 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:56:17.381041 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:56:17.383582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public_marts)
[0m13:56:17.388576 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:56:17.391556 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:56:17.394669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:17.404397 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:56:17.406413 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:56:17.408243 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:56:17.413313 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:56:17.417087 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:56:17.420176 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:56:17.422934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public)
[0m13:56:17.427660 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:56:17.429881 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:56:17.432403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:17.443508 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:56:17.445968 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:56:17.448470 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:56:17.454933 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m13:56:17.462035 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:56:17.464799 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:56:17.478905 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:17.481904 [debug] [MainThread]: On master: BEGIN
[0m13:56:17.484282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:17.492465 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:56:17.495061 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:17.497500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:56:17.508501 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m13:56:17.514354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd991f477-234f-4ff8-b796-1d00cbfd1cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bc5eafc0>]}
[0m13:56:17.516646 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:17.519085 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:17.521161 [debug] [MainThread]: On master: BEGIN
[0m13:56:17.524075 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:56:17.526125 [debug] [MainThread]: On master: COMMIT
[0m13:56:17.528365 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:17.530513 [debug] [MainThread]: On master: COMMIT
[0m13:56:17.532945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:17.535335 [debug] [MainThread]: On master: Close
[0m13:56:17.539190 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:56:17.541277 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:56:17.542736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:56:17.544167 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:56:17.559607 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:56:17.577591 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:56:17.614497 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:56:17.647230 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:56:17.650093 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:56:17.653439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:17.668689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:56:17.672776 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:56:17.677544 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:56:17.697881 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m13:56:17.724424 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:56:17.728076 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:56:17.735939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:56:17.751518 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:56:17.754948 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:56:17.761581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:56:17.784845 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:56:17.787692 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:56:17.791007 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:56:17.797641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:56:17.807920 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:56:17.815644 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:56:17.818122 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:56:17.824401 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:56:17.829461 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:56:17.833366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd991f477-234f-4ff8-b796-1d00cbfd1cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bfb1e480>]}
[0m13:56:17.835996 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.29s]
[0m13:56:17.838213 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:56:17.840299 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:56:17.841713 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:56:17.843363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:56:17.848583 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:56:17.857391 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:56:17.881952 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:56:17.910798 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:56:17.934870 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:56:17.937111 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:56:17.939461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:17.948507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:56:17.950998 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:56:17.953279 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,
    count(*) filter(where trip_hour between 6 and 9) as peak_morning_hours,
    count(*) filter(where trip_hour between 17 and 19) as peak_evening_hours,
    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate
from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m13:56:17.960085 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "trip_hour" does not exist
LINE 57:     count(*) filter(where trip_hour between 6 and 9) as peak...
                                   ^

[0m13:56:17.962389 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:56:17.964989 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:56:17.970279 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "trip_hour" does not exist
  LINE 57:     count(*) filter(where trip_hour between 6 and 9) as peak...
                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:56:17.971737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd991f477-234f-4ff8-b796-1d00cbfd1cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b9980050>]}
[0m13:56:17.973777 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.13s]
[0m13:56:17.975743 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:56:17.977499 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "trip_hour" does not exist
  LINE 57:     count(*) filter(where trip_hour between 6 and 9) as peak...
                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:56:17.980343 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:17.982005 [debug] [MainThread]: On master: BEGIN
[0m13:56:17.983978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:17.991137 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:56:17.992491 [debug] [MainThread]: On master: COMMIT
[0m13:56:17.994642 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:17.996419 [debug] [MainThread]: On master: COMMIT
[0m13:56:17.998320 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:17.999948 [debug] [MainThread]: On master: Close
[0m13:56:18.001508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:18.003294 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:56:18.004657 [info ] [MainThread]: 
[0m13:56:18.005764 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m13:56:18.008004 [debug] [MainThread]: Command end result
[0m13:56:18.087437 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:56:18.100037 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:56:18.157570 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:56:18.158967 [info ] [MainThread]: 
[0m13:56:18.160350 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:56:18.161800 [info ] [MainThread]: 
[0m13:56:18.163560 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "trip_hour" does not exist
  LINE 57:     count(*) filter(where trip_hour between 6 and 9) as peak...
                                     ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:56:18.165101 [info ] [MainThread]: 
[0m13:56:18.182565 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:56:18.187471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.89561, "process_in_blocks": "0", "process_kernel_time": 0.18979, "process_mem_max_rss": "113436", "process_out_blocks": "0", "process_user_time": 2.926764}
[0m13:56:18.189767 [debug] [MainThread]: Command `dbt run` failed at 13:56:18.189471 after 3.90 seconds
[0m13:56:18.191713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bfdac320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5be8600b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5be860a70>]}
[0m13:56:18.193246 [debug] [MainThread]: Flushing usage events
[0m13:56:21.722416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:54.231056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a313d08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2f386cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2fd1f0b0>]}


============================== 13:59:54.236664 | 8176bdc4-7b70-4449-bb5c-3c0409e97d6b ==============================
[0m13:59:54.236664 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:59:54.238548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:59:54.486866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8176bdc4-7b70-4449-bb5c-3c0409e97d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2ef6a420>]}
[0m13:59:54.561622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8176bdc4-7b70-4449-bb5c-3c0409e97d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2efcffe0>]}
[0m13:59:54.564641 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:59:54.669868 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:59:55.838628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:55.840447 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m13:59:56.342471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:59:56.369576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8176bdc4-7b70-4449-bb5c-3c0409e97d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0f9c7410>]}
[0m13:59:56.554709 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:59:56.564596 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:59:56.599292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8176bdc4-7b70-4449-bb5c-3c0409e97d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0f95eb40>]}
[0m13:59:56.600821 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m13:59:56.602121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8176bdc4-7b70-4449-bb5c-3c0409e97d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2d5d66f0>]}
[0m13:59:56.605645 [info ] [MainThread]: 
[0m13:59:56.607116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:56.608378 [info ] [MainThread]: 
[0m13:59:56.610299 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:56.617113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m13:59:56.650739 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:59:56.652735 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:59:56.654475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:56.662695 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m13:59:56.666078 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:59:56.669918 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m13:59:56.672439 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m13:59:56.676025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:56.686419 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m13:59:56.691406 [debug] [ThreadPool]: On list_ingest_db: Close
[0m13:59:56.697622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m13:59:56.717900 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:59:56.722758 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m13:59:56.726756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:56.743704 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m13:59:56.747353 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m13:59:56.750386 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:59:56.756841 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m13:59:56.761688 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m13:59:56.763746 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m13:59:56.767049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m13:59:56.773643 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:59:56.775867 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m13:59:56.778252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:56.787517 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:59:56.790571 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m13:59:56.794094 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m13:59:56.802466 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:59:56.809011 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m13:59:56.814937 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m13:59:56.820428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now list_ingest_db_public_staging)
[0m13:59:56.832511 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:59:56.835928 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m13:59:56.839331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:56.854450 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:59:56.858214 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m13:59:56.862473 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m13:59:56.875402 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m13:59:56.888573 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m13:59:56.896523 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m13:59:56.913407 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:56.917500 [debug] [MainThread]: On master: BEGIN
[0m13:59:56.921632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:56.946131 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m13:59:56.952403 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:56.957595 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:56.981279 [debug] [MainThread]: SQL status: SELECT 12 in 0.018 seconds
[0m13:59:56.991987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8176bdc4-7b70-4449-bb5c-3c0409e97d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2d3b8e00>]}
[0m13:59:56.996695 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:57.003972 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:57.010031 [debug] [MainThread]: On master: BEGIN
[0m13:59:57.021427 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:59:57.026323 [debug] [MainThread]: On master: COMMIT
[0m13:59:57.031455 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:57.035678 [debug] [MainThread]: On master: COMMIT
[0m13:59:57.040809 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:59:57.045138 [debug] [MainThread]: On master: Close
[0m13:59:57.054977 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:59:57.059327 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m13:59:57.063436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m13:59:57.066304 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:59:57.092696 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:59:57.115881 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:59:57.158425 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:59:57.202559 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:59:57.206194 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m13:59:57.210070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:57.228199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:59:57.233211 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:59:57.238079 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m13:59:57.255221 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m13:59:57.266801 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:59:57.269687 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m13:59:57.277860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:59:57.287998 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:59:57.292629 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m13:59:57.297905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:59:57.341966 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:59:57.344046 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:59:57.346084 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m13:59:57.350610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:59:57.359459 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m13:59:57.367651 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m13:59:57.369369 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m13:59:57.374222 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:59:57.379289 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m13:59:57.384222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8176bdc4-7b70-4449-bb5c-3c0409e97d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a30d624e0>]}
[0m13:59:57.386687 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.32s]
[0m13:59:57.388143 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m13:59:57.390096 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:59:57.391722 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m13:59:57.392848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m13:59:57.394023 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:59:57.400910 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:59:57.417485 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:59:57.447897 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:59:57.476832 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:59:57.479092 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m13:59:57.480891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:57.489983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:59:57.492888 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m13:59:57.495237 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,

    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,

    -- Classifying trip distance into types
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,

    -- Calculating tip rate
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate

from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    stg_trip_distance > 0
    AND stg_fare_amount > 0
    AND stg_passenger_count > 0
    AND EXTRACT(EPOCH FROM stg_dropoff_datetime - stg_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, extract(hour from lpep_pickup_datetime)
order by vendor_label, trip_month, trip_weekday, extract(hour from lpep_pickup_datetime)
  );
  
[0m13:59:57.499826 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "stg_trip_distance" does not exist
LINE 85:     stg_trip_distance > 0
             ^

[0m13:59:57.503174 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m13:59:57.506313 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m13:59:57.513593 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "stg_trip_distance" does not exist
  LINE 85:     stg_trip_distance > 0
               ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:59:57.517023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8176bdc4-7b70-4449-bb5c-3c0409e97d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a0d250bc0>]}
[0m13:59:57.520680 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.12s]
[0m13:59:57.524932 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m13:59:57.527810 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "stg_trip_distance" does not exist
  LINE 85:     stg_trip_distance > 0
               ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m13:59:57.533314 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:57.535976 [debug] [MainThread]: On master: BEGIN
[0m13:59:57.538959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:57.549906 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:59:57.551663 [debug] [MainThread]: On master: COMMIT
[0m13:59:57.553564 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:57.554962 [debug] [MainThread]: On master: COMMIT
[0m13:59:57.557529 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:59:57.559996 [debug] [MainThread]: On master: Close
[0m13:59:57.562907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:57.565517 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m13:59:57.568387 [info ] [MainThread]: 
[0m13:59:57.570559 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m13:59:57.572759 [debug] [MainThread]: Command end result
[0m13:59:57.682970 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m13:59:57.700157 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m13:59:57.771386 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m13:59:57.778438 [info ] [MainThread]: 
[0m13:59:57.787693 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:59:57.797301 [info ] [MainThread]: 
[0m13:59:57.809316 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "stg_trip_distance" does not exist
  LINE 85:     stg_trip_distance > 0
               ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m13:59:57.814241 [info ] [MainThread]: 
[0m13:59:57.822194 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:59:57.831147 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.735355, "process_in_blocks": "0", "process_kernel_time": 0.252155, "process_mem_max_rss": "115536", "process_out_blocks": "0", "process_user_time": 2.919185}
[0m13:59:57.836843 [debug] [MainThread]: Command `dbt run` failed at 13:59:57.836542 after 3.74 seconds
[0m13:59:57.841643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2fd1d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2fd1f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2d2cfb00>]}
[0m13:59:57.846013 [debug] [MainThread]: Flushing usage events
[0m13:59:58.842589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:35.888106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b7285c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b746ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b741cf80>]}


============================== 14:00:35.893693 | 3d8563c9-007b-4415-9640-82bb4d51fae3 ==============================
[0m14:00:35.893693 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:00:35.897210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:00:36.141947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d8563c9-007b-4415-9640-82bb4d51fae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b6e4ba40>]}
[0m14:00:36.268667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d8563c9-007b-4415-9640-82bb4d51fae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b701a540>]}
[0m14:00:36.273208 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:00:36.404163 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:00:37.936767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:37.939069 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:00:38.336179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m14:00:38.353131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d8563c9-007b-4415-9640-82bb4d51fae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47af98bcb0>]}
[0m14:00:38.519135 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:00:38.528428 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:00:38.563391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d8563c9-007b-4415-9640-82bb4d51fae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47af836d20>]}
[0m14:00:38.565310 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m14:00:38.566902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d8563c9-007b-4415-9640-82bb4d51fae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b538c770>]}
[0m14:00:38.569980 [info ] [MainThread]: 
[0m14:00:38.571449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:38.572918 [info ] [MainThread]: 
[0m14:00:38.574870 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:38.582102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m14:00:38.620786 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:00:38.622646 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:00:38.624261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:38.632383 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m14:00:38.635267 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:00:38.639518 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:00:38.641794 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:00:38.644944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:38.653732 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m14:00:38.657327 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:00:38.660657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_staging)
[0m14:00:38.670330 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m14:00:38.672139 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m14:00:38.674237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:38.682930 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:00:38.684995 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m14:00:38.687384 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:00:38.691211 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:00:38.693796 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m14:00:38.695339 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m14:00:38.696982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m14:00:38.700075 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:00:38.701762 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:00:38.703030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:38.709353 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:00:38.711127 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:00:38.712549 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:00:38.716850 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m14:00:38.731135 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:00:38.734129 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:00:38.737383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m14:00:38.752888 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m14:00:38.754648 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m14:00:38.755788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:38.763179 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:00:38.764596 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m14:00:38.765786 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:00:38.769837 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:00:38.772647 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m14:00:38.774221 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m14:00:38.781565 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.783161 [debug] [MainThread]: On master: BEGIN
[0m14:00:38.784545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:38.792501 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:00:38.793875 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.795190 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:38.813070 [debug] [MainThread]: SQL status: SELECT 12 in 0.016 seconds
[0m14:00:38.822504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d8563c9-007b-4415-9640-82bb4d51fae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b6c8b260>]}
[0m14:00:38.824138 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:38.825653 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.826962 [debug] [MainThread]: On master: BEGIN
[0m14:00:38.828913 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:00:38.830239 [debug] [MainThread]: On master: COMMIT
[0m14:00:38.831341 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:38.832365 [debug] [MainThread]: On master: COMMIT
[0m14:00:38.833639 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:00:38.834596 [debug] [MainThread]: On master: Close
[0m14:00:38.837791 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:00:38.839195 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m14:00:38.840584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:00:38.841673 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:00:38.857827 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:00:38.866682 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:00:38.905543 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:00:38.912746 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:00:38.913988 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m14:00:38.914915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:38.920537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:00:38.921654 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:00:38.922660 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m14:00:38.929251 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:00:38.938085 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:00:38.939526 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m14:00:38.941532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:00:38.945268 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:00:38.946343 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m14:00:38.948149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:00:38.965851 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:00:38.967568 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:00:38.969169 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:00:38.973410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:00:38.981438 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m14:00:38.988694 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:00:38.990660 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m14:00:38.995334 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:00:38.999574 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m14:00:39.003116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d8563c9-007b-4415-9640-82bb4d51fae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b8afa1b0>]}
[0m14:00:39.005593 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.16s]
[0m14:00:39.007299 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:00:39.009311 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:00:39.010489 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m14:00:39.011596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:00:39.012647 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:00:39.020667 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:00:39.038754 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:00:39.068715 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:00:39.079807 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:00:39.080824 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m14:00:39.081641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:39.087543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:00:39.089115 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:00:39.090644 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,

    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,

    -- Classifying trip distance into types
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,

    -- Calculating tip rate
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate

from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM dropoff_datetime - pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, extract(hour from lpep_pickup_datetime)
order by vendor_label, trip_month, trip_weekday, extract(hour from lpep_pickup_datetime)
  );
  
[0m14:00:39.096701 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "dropoff_datetime" does not exist
LINE 88:     AND EXTRACT(EPOCH FROM dropoff_datetime - pickup_datetim...
                                    ^

[0m14:00:39.098167 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m14:00:39.099769 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m14:00:39.103776 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "dropoff_datetime" does not exist
  LINE 88:     AND EXTRACT(EPOCH FROM dropoff_datetime - pickup_datetim...
                                      ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m14:00:39.105290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d8563c9-007b-4415-9640-82bb4d51fae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ad1377a0>]}
[0m14:00:39.106690 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.09s]
[0m14:00:39.108022 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:00:39.109273 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "dropoff_datetime" does not exist
  LINE 88:     AND EXTRACT(EPOCH FROM dropoff_datetime - pickup_datetim...
                                      ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m14:00:39.112073 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:39.113216 [debug] [MainThread]: On master: BEGIN
[0m14:00:39.114396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:39.120415 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:00:39.121542 [debug] [MainThread]: On master: COMMIT
[0m14:00:39.122486 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:39.123436 [debug] [MainThread]: On master: COMMIT
[0m14:00:39.124613 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:00:39.125642 [debug] [MainThread]: On master: Close
[0m14:00:39.127089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:39.127992 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:00:39.128916 [info ] [MainThread]: 
[0m14:00:39.130551 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m14:00:39.133012 [debug] [MainThread]: Command end result
[0m14:00:39.183085 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:00:39.189113 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:00:39.199644 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:00:39.200969 [info ] [MainThread]: 
[0m14:00:39.202313 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:00:39.203800 [info ] [MainThread]: 
[0m14:00:39.205067 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "dropoff_datetime" does not exist
  LINE 88:     AND EXTRACT(EPOCH FROM dropoff_datetime - pickup_datetim...
                                      ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m14:00:39.206241 [info ] [MainThread]: 
[0m14:00:39.207548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:00:39.209803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4519389, "process_in_blocks": "0", "process_kernel_time": 0.159711, "process_mem_max_rss": "115632", "process_out_blocks": "0", "process_user_time": 2.745044}
[0m14:00:39.211772 [debug] [MainThread]: Command `dbt run` failed at 14:00:39.211476 after 3.45 seconds
[0m14:00:39.213678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b72e4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b72e5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47b783cd10>]}
[0m14:00:39.216095 [debug] [MainThread]: Flushing usage events
[0m14:00:40.168291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:57.859599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75273b27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75272f8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f752746b9e0>]}


============================== 14:03:57.865365 | 81205c65-912e-45d7-9a95-902760c5c524 ==============================
[0m14:03:57.865365 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:03:57.867725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:03:58.082852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81205c65-912e-45d7-9a95-902760c5c524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7526f84470>]}
[0m14:03:58.156147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81205c65-912e-45d7-9a95-902760c5c524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7527a7f4a0>]}
[0m14:03:58.158052 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:03:58.259544 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:03:59.602090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:03:59.604060 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:03:59.605566 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/is_valid_trip.sql
[0m14:03:59.841064 [error] [MainThread]: Encountered an error:
Compilation Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  macro 'dbt_macro__is_valid_trip' takes not more than 0 argument(s)
[0m14:03:59.845517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1037462, "process_in_blocks": "0", "process_kernel_time": 0.130058, "process_mem_max_rss": "102040", "process_out_blocks": "0", "process_user_time": 2.110954}
[0m14:03:59.847540 [debug] [MainThread]: Command `dbt run` failed at 14:03:59.847361 after 2.11 seconds
[0m14:03:59.849392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75278b3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7525232d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75275e8ad0>]}
[0m14:03:59.851149 [debug] [MainThread]: Flushing usage events
[0m14:04:00.710562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:34.220933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af04d8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af07d8bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af0b72bd0>]}


============================== 14:04:34.229036 | 2eb17669-f8ec-4fbd-a4b7-ddf402a32d53 ==============================
[0m14:04:34.229036 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:04:34.232431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:34.471285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb17669-f8ec-4fbd-a4b7-ddf402a32d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aeff59730>]}
[0m14:04:34.540058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb17669-f8ec-4fbd-a4b7-ddf402a32d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af0abf1a0>]}
[0m14:04:34.542070 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:04:34.645432 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:04:39.607338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:04:39.614242 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/is_valid_trip.sql
[0m14:04:39.618537 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:04:39.623777 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token '(', got 'end of statement block'
    line 1
      {% macro is_valid_trip %}
[0m14:04:39.628848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.555442, "process_in_blocks": "0", "process_kernel_time": 0.273599, "process_mem_max_rss": "97872", "process_out_blocks": "0", "process_user_time": 1.874659}
[0m14:04:39.632092 [debug] [MainThread]: Command `dbt run` failed at 14:04:39.631868 after 5.56 seconds
[0m14:04:39.634568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af0b71a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af04db500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aee6716d0>]}
[0m14:04:39.636244 [debug] [MainThread]: Flushing usage events
[0m14:04:40.492116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:43.000164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262bad4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262bb8e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262bcb8a70>]}


============================== 14:05:43.005971 | 0187d60b-c8ba-446f-a18b-08bafb6c3687 ==============================
[0m14:05:43.005971 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:05:43.008281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:43.228980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0187d60b-c8ba-446f-a18b-08bafb6c3687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262b482360>]}
[0m14:05:43.298744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0187d60b-c8ba-446f-a18b-08bafb6c3687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262eb7be60>]}
[0m14:05:43.301083 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:43.439775 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:05:44.869766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:05:44.871165 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/is_valid_trip.sql
[0m14:05:44.872080 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:05:44.873624 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token '(', got 'end of statement block'
    line 1
      {% macro is_valid_trip%}
[0m14:05:44.875775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0326548, "process_in_blocks": "0", "process_kernel_time": 0.182163, "process_mem_max_rss": "97672", "process_out_blocks": "0", "process_user_time": 1.781149}
[0m14:05:44.876905 [debug] [MainThread]: Command `dbt run` failed at 14:05:44.876761 after 2.03 seconds
[0m14:05:44.877792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262bb317c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262ec27860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2629b73470>]}
[0m14:05:44.878674 [debug] [MainThread]: Flushing usage events
[0m14:05:45.721903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:21.683677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bc482750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55baf67bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ba9e0bc0>]}


============================== 14:06:21.692728 | 16377a43-9cb9-4fdf-902d-346112d2b4c2 ==============================
[0m14:06:21.692728 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:06:21.698330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:06:21.961547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16377a43-9cb9-4fdf-902d-346112d2b4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ba9ca780>]}
[0m14:06:22.036081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16377a43-9cb9-4fdf-902d-346112d2b4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bab99550>]}
[0m14:06:22.038487 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:06:22.185495 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:06:24.364675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:06:24.367563 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/is_valid_trip.sql
[0m14:06:24.369731 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:06:24.372711 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token '(', got 'end of statement block'
    line 1
      {% macro is_valid_trip%}
[0m14:06:24.375432 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8446298, "process_in_blocks": "0", "process_kernel_time": 0.178224, "process_mem_max_rss": "97704", "process_out_blocks": "0", "process_user_time": 1.851557}
[0m14:06:24.377283 [debug] [MainThread]: Command `dbt run` failed at 14:06:24.376949 after 2.85 seconds
[0m14:06:24.378475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55bab422a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b8d614f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b8d615b0>]}
[0m14:06:24.379826 [debug] [MainThread]: Flushing usage events
[0m14:06:25.251604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:44.054183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdab62d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdaba0e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdacf565a0>]}


============================== 14:06:44.057878 | 100da3b7-aff1-4de7-a15c-c50500f4abc7 ==============================
[0m14:06:44.057878 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:06:44.060277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:44.273729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '100da3b7-aff1-4de7-a15c-c50500f4abc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdae862990>]}
[0m14:06:44.351454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '100da3b7-aff1-4de7-a15c-c50500f4abc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdab588a40>]}
[0m14:06:44.353641 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:06:44.504397 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:06:45.396867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:06:45.398115 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:06:45.399344 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/is_valid_trip.sql
[0m14:06:45.617084 [error] [MainThread]: Encountered an error:
Compilation Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  macro 'dbt_macro__is_valid_trip' takes not more than 0 argument(s)
[0m14:06:45.620153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6711122, "process_in_blocks": "0", "process_kernel_time": 0.161052, "process_mem_max_rss": "102252", "process_out_blocks": "0", "process_user_time": 1.912503}
[0m14:06:45.621813 [debug] [MainThread]: Command `dbt run` failed at 14:06:45.621608 after 1.67 seconds
[0m14:06:45.622702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdabfe2ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdab3489b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdabd798b0>]}
[0m14:06:45.623534 [debug] [MainThread]: Flushing usage events
[0m14:06:46.792533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:09.408282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20d25d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20d67f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20d25d3d0>]}


============================== 14:08:09.412911 | 3a1e23d3-68da-418d-95ae-69970cae7f86 ==============================
[0m14:08:09.412911 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:08:09.415659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:09.648732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a1e23d3-68da-418d-95ae-69970cae7f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20d1f1af0>]}
[0m14:08:09.720422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a1e23d3-68da-418d-95ae-69970cae7f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20e13f7d0>]}
[0m14:08:09.735756 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:09.970011 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:08:17.134206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:08:17.138071 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/is_valid_trip.sql
[0m14:08:17.140645 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:08:17.485442 [error] [MainThread]: Encountered an error:
Compilation Error in test test_is_valid_trip (tests/test_is_valid_trip.sql)
  macro 'dbt_macro__is_valid_trip' takes not more than 0 argument(s)
[0m14:08:17.487919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.203323, "process_in_blocks": "0", "process_kernel_time": 0.353754, "process_mem_max_rss": "101308", "process_out_blocks": "0", "process_user_time": 2.405528}
[0m14:08:17.489680 [debug] [MainThread]: Command `dbt run` failed at 14:08:17.489538 after 8.21 seconds
[0m14:08:17.491151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20d618ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20d1f2b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20d1a1580>]}
[0m14:08:17.492556 [debug] [MainThread]: Flushing usage events
[0m14:08:18.421664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:50.372237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07222d85f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0721de1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07222db740>]}


============================== 14:08:50.379269 | 03445dc8-ca22-47fd-916f-308bdcf2e8cc ==============================
[0m14:08:50.379269 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:08:50.382907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:08:50.582273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03445dc8-ca22-47fd-916f-308bdcf2e8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07217f6a20>]}
[0m14:08:50.679445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03445dc8-ca22-47fd-916f-308bdcf2e8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07218d4f80>]}
[0m14:08:50.682297 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:50.839335 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:08:52.238542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:08:52.240031 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://tests/test_is_valid_trip.sql
[0m14:08:52.241303 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/is_valid_trip.sql
[0m14:08:52.242599 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:08:52.800151 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m14:08:52.816909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03445dc8-ca22-47fd-916f-308bdcf2e8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071e307fb0>]}
[0m14:08:53.009557 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:08:53.019392 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:08:53.045573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03445dc8-ca22-47fd-916f-308bdcf2e8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071fc0b410>]}
[0m14:08:53.047114 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m14:08:53.048486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03445dc8-ca22-47fd-916f-308bdcf2e8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071e285c10>]}
[0m14:08:53.052129 [info ] [MainThread]: 
[0m14:08:53.053769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:53.055183 [info ] [MainThread]: 
[0m14:08:53.056815 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:08:53.062047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m14:08:53.096295 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:08:53.097773 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:08:53.098905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:53.106089 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m14:08:53.108098 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:08:53.111092 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:08:53.112088 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:08:53.112844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:53.118343 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m14:08:53.120228 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:08:53.122309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_staging)
[0m14:08:53.128495 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m14:08:53.129474 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m14:08:53.130334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:53.135792 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:08:53.136833 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m14:08:53.137961 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:08:53.142395 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:08:53.145873 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m14:08:53.147972 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m14:08:53.150787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m14:08:53.155719 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:08:53.158673 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:08:53.161808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:53.179525 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m14:08:53.184051 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:08:53.188423 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:08:53.198994 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.006 seconds
[0m14:08:53.206323 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:08:53.209958 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:08:53.213646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m14:08:53.224786 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m14:08:53.226668 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m14:08:53.228671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:53.237842 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:08:53.239970 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m14:08:53.241928 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:08:53.246345 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:08:53.249271 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m14:08:53.251096 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m14:08:53.257009 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.258455 [debug] [MainThread]: On master: BEGIN
[0m14:08:53.260087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:53.266937 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:08:53.268465 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.269904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:08:53.279325 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m14:08:53.284079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03445dc8-ca22-47fd-916f-308bdcf2e8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072178f140>]}
[0m14:08:53.285564 [debug] [MainThread]: On master: ROLLBACK
[0m14:08:53.287143 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.288468 [debug] [MainThread]: On master: BEGIN
[0m14:08:53.290510 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:08:53.291939 [debug] [MainThread]: On master: COMMIT
[0m14:08:53.293391 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.294801 [debug] [MainThread]: On master: COMMIT
[0m14:08:53.296485 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:53.297996 [debug] [MainThread]: On master: Close
[0m14:08:53.301654 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:08:53.303539 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m14:08:53.305365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:08:53.306598 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:08:53.320085 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:08:53.342069 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:08:53.379299 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:08:53.402142 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:08:53.405660 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m14:08:53.408276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:53.425528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m14:08:53.429684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:08:53.434013 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m14:08:53.450757 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:08:53.462684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:08:53.465057 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m14:08:53.468577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:08:53.473381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:08:53.475184 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m14:08:53.477405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:08:53.497613 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:08:53.499618 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:08:53.501513 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:08:53.508937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:08:53.521040 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m14:08:53.534070 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:08:53.536764 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m14:08:53.544814 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:08:53.552470 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m14:08:53.558048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03445dc8-ca22-47fd-916f-308bdcf2e8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07235f2c00>]}
[0m14:08:53.561455 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.25s]
[0m14:08:53.564637 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:08:53.567798 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:08:53.569927 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m14:08:53.572144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:08:53.573881 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:08:53.581307 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:08:53.597093 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:08:53.625425 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:08:53.643078 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:08:53.645152 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m14:08:53.646957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:53.654638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:08:53.656872 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:08:53.658989 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,

    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,

    -- Classifying trip distance into types
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,

    -- Calculating tip rate
    
    case
        when fare_amount is null or fare_amount = 0 then null
        else cast(tip_amount as float) / fare_amount
    end
 AS tip_rate

from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m14:08:53.665797 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "staging_green_tripdata_2019_all.fare_amount" must appear in the GROUP BY clause or be used in an aggregate function
LINE 78:         when fare_amount is null or fare_amount = 0 then nul...
                      ^

[0m14:08:53.668099 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: ROLLBACK
[0m14:08:53.671282 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m14:08:53.681289 [debug] [Thread-1 (]: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "staging_green_tripdata_2019_all.fare_amount" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 78:         when fare_amount is null or fare_amount = 0 then nul...
                        ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m14:08:53.684738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03445dc8-ca22-47fd-916f-308bdcf2e8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071d372ba0>]}
[0m14:08:53.689341 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model public_marts.green_tripdata_summary_2019 . [[31mERROR[0m in 0.11s]
[0m14:08:53.694033 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:08:53.698115 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.marts_green_tripdata_summary_2019' to be skipped because of status 'error'.  Reason: Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "staging_green_tripdata_2019_all.fare_amount" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 78:         when fare_amount is null or fare_amount = 0 then nul...
                        ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql.
[0m14:08:53.705957 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.708370 [debug] [MainThread]: On master: BEGIN
[0m14:08:53.711000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:53.720493 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:08:53.723527 [debug] [MainThread]: On master: COMMIT
[0m14:08:53.725827 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:53.729214 [debug] [MainThread]: On master: COMMIT
[0m14:08:53.732779 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:08:53.736693 [debug] [MainThread]: On master: Close
[0m14:08:53.741341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:53.745057 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:08:53.748828 [info ] [MainThread]: 
[0m14:08:53.752075 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m14:08:53.757236 [debug] [MainThread]: Command end result
[0m14:08:53.852397 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:08:53.861764 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:08:53.878982 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:08:53.881459 [info ] [MainThread]: 
[0m14:08:53.883015 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:08:53.884411 [info ] [MainThread]: 
[0m14:08:53.885660 [error] [MainThread]:   Database Error in model marts_green_tripdata_summary_2019 (models/marts/marts_green_tripdata_summary_2019.sql)
  column "staging_green_tripdata_2019_all.fare_amount" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 78:         when fare_amount is null or fare_amount = 0 then nul...
                        ^
  compiled code at target/run/my_dbt_project/models/marts/marts_green_tripdata_summary_2019.sql
[0m14:08:53.886733 [info ] [MainThread]: 
[0m14:08:53.887985 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:08:53.890811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6525793, "process_in_blocks": "0", "process_kernel_time": 0.164663, "process_mem_max_rss": "115980", "process_out_blocks": "0", "process_user_time": 2.922775}
[0m14:08:53.892514 [debug] [MainThread]: Command `dbt run` failed at 14:08:53.892239 after 3.65 seconds
[0m14:08:53.893950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07223392e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071e1b8740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0721b1a4e0>]}
[0m14:08:53.895630 [debug] [MainThread]: Flushing usage events
[0m14:08:54.885248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:53.083095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2d453860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2ded0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2d453830>]}


============================== 14:16:53.088165 | de839341-a726-4626-b69c-5e0ada8cbd21 ==============================
[0m14:16:53.088165 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:16:53.089924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:16:53.325939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de839341-a726-4626-b69c-5e0ada8cbd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2d8ee8d0>]}
[0m14:16:53.394220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de839341-a726-4626-b69c-5e0ada8cbd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2d3e3f20>]}
[0m14:16:53.397121 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:16:53.551302 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:16:54.680771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:16:54.682312 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://macros/calculate_tip_rate.sql
[0m14:16:55.156350 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m14:16:55.173876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de839341-a726-4626-b69c-5e0ada8cbd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d29dea9c0>]}
[0m14:16:55.373444 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:16:55.385064 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:16:55.425746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de839341-a726-4626-b69c-5e0ada8cbd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d29d2ac30>]}
[0m14:16:55.427543 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 551 macros
[0m14:16:55.429126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de839341-a726-4626-b69c-5e0ada8cbd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d29d6bef0>]}
[0m14:16:55.432250 [info ] [MainThread]: 
[0m14:16:55.433612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:55.435498 [info ] [MainThread]: 
[0m14:16:55.437078 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:55.443294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m14:16:55.482422 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:16:55.484286 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:16:55.486880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:55.496207 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m14:16:55.499275 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:16:55.502932 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:16:55.505252 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:16:55.506756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:55.514456 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m14:16:55.518449 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:16:55.522914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_staging)
[0m14:16:55.536597 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m14:16:55.540053 [debug] [ThreadPool]: On list_ingest_db_public_staging: BEGIN
[0m14:16:55.544215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:55.563862 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:16:55.566402 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_staging"
[0m14:16:55.568703 [debug] [ThreadPool]: On list_ingest_db_public_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_staging"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m14:16:55.574939 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:16:55.579383 [debug] [ThreadPool]: On list_ingest_db_public_staging: ROLLBACK
[0m14:16:55.582849 [debug] [ThreadPool]: On list_ingest_db_public_staging: Close
[0m14:16:55.586423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_staging, now list_ingest_db_public)
[0m14:16:55.591268 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:16:55.594393 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:16:55.598242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:55.611601 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m14:16:55.615436 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:16:55.618550 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:16:55.626757 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m14:16:55.634267 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:16:55.639999 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:16:55.645738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_marts)
[0m14:16:55.666051 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m14:16:55.671518 [debug] [ThreadPool]: On list_ingest_db_public_marts: BEGIN
[0m14:16:55.676835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:55.697584 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m14:16:55.700549 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_marts"
[0m14:16:55.702885 [debug] [ThreadPool]: On list_ingest_db_public_marts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_marts"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m14:16:55.707417 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:16:55.710526 [debug] [ThreadPool]: On list_ingest_db_public_marts: ROLLBACK
[0m14:16:55.713193 [debug] [ThreadPool]: On list_ingest_db_public_marts: Close
[0m14:16:55.720373 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:55.722680 [debug] [MainThread]: On master: BEGIN
[0m14:16:55.724453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:55.732505 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:16:55.735724 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:55.738810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:55.755626 [debug] [MainThread]: SQL status: SELECT 12 in 0.014 seconds
[0m14:16:55.762918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de839341-a726-4626-b69c-5e0ada8cbd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e29b380>]}
[0m14:16:55.765731 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:55.768846 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:55.772137 [debug] [MainThread]: On master: BEGIN
[0m14:16:55.777168 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:16:55.780997 [debug] [MainThread]: On master: COMMIT
[0m14:16:55.785209 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:55.790238 [debug] [MainThread]: On master: COMMIT
[0m14:16:55.794897 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:55.798361 [debug] [MainThread]: On master: Close
[0m14:16:55.806686 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:16:55.810367 [info ] [Thread-1 (]: 1 of 2 START sql view model public_staging.staging_green_tripdata_2019_all ..... [RUN]
[0m14:16:55.812865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_marts, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:16:55.814888 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:16:55.832365 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:16:55.850548 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:16:55.888219 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:16:55.904464 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:16:55.907127 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m14:16:55.910182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:55.918501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:16:55.920681 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:16:55.923393 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m14:16:55.933397 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:16:55.948303 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:16:55.951841 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m14:16:55.958179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:16:55.969458 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:16:55.973649 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m14:16:55.980068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:16:56.029560 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:16:56.033976 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:16:56.039303 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:16:56.046294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:16:56.057298 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup"
[0m14:16:56.067760 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:16:56.072085 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_staging"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m14:16:56.083455 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m14:16:56.090658 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m14:16:56.097474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de839341-a726-4626-b69c-5e0ada8cbd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2f02e630>]}
[0m14:16:56.100283 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_staging.staging_green_tripdata_2019_all  [[32mCREATE VIEW[0m in 0.28s]
[0m14:16:56.103650 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:16:56.107520 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:16:56.111202 [info ] [Thread-1 (]: 2 of 2 START sql table model public_marts.green_tripdata_summary_2019 .......... [RUN]
[0m14:16:56.113986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:16:56.123353 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:16:56.130463 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:16:56.149872 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:16:56.180893 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:16:56.202438 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:16:56.204457 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m14:16:56.206368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:56.213880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:16:56.215797 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:16:56.217513 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,

    max(
      case
        when lpep_dropoff_datetime is not null then
          extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime)/60
        else null end
    ) as trip_duration_minutes,

    -- Classifying trip distance into types
    case
      when avg(trip_distance)<=2 then 'Short'
      when avg(trip_distance)<=5 then 'Medium'
      else 'Long' end as trip_type,

    -- Calculating tip rate
    
    avg(
        case
            when fare_amount is null or fare_amount = 0 then null
            else cast(tip_amount as float) / fare_amount
        end
    )
 AS tip_rate

from "ingest_db"."public_staging"."staging_green_tripdata_2019_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m14:17:53.822187 [debug] [Thread-1 (]: SQL status: SELECT 45041 in 57.609 seconds
[0m14:17:53.828207 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:17:53.830125 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_tmp" rename to "green_tripdata_summary_2019"
[0m14:17:53.832552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:53.840104 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:17:53.843109 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:17:53.845280 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:17:53.850351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:17:53.855697 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_backup"
[0m14:17:53.862507 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:17:53.864743 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
drop table if exists "ingest_db"."public_marts"."green_tripdata_summary_2019__dbt_backup" cascade
[0m14:17:53.867313 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:17:53.870627 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m14:17:53.872735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de839341-a726-4626-b69c-5e0ada8cbd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d28ffaa50>]}
[0m14:17:53.874950 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public_marts.green_tripdata_summary_2019 ..... [[32mSELECT 45041[0m in 57.76s]
[0m14:17:53.876659 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:17:53.880065 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:53.881438 [debug] [MainThread]: On master: BEGIN
[0m14:17:53.882718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:53.891043 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:17:53.892352 [debug] [MainThread]: On master: COMMIT
[0m14:17:53.893675 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:53.895284 [debug] [MainThread]: On master: COMMIT
[0m14:17:53.896978 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:53.898269 [debug] [MainThread]: On master: Close
[0m14:17:53.899868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:53.901462 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:17:53.903163 [info ] [MainThread]: 
[0m14:17:53.904813 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 58.47 seconds (58.47s).
[0m14:17:53.906960 [debug] [MainThread]: Command end result
[0m14:17:54.065016 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:17:54.078990 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:17:54.095448 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:17:54.097724 [info ] [MainThread]: 
[0m14:17:54.099358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:54.100753 [info ] [MainThread]: 
[0m14:17:54.102348 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:17:54.104487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 61.18452, "process_in_blocks": "0", "process_kernel_time": 0.151628, "process_mem_max_rss": "115716", "process_out_blocks": "0", "process_user_time": 2.992131}
[0m14:17:54.106106 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:54.105958 after 61.19 seconds
[0m14:17:54.107542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2ded0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d29050200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d290530b0>]}
[0m14:17:54.108920 [debug] [MainThread]: Flushing usage events
[0m14:17:55.213811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:54.759040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e40317d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e4096cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e404f1d90>]}


============================== 14:28:54.774241 | 9ed8f9eb-cf89-4b7d-9a0a-32060297fab6 ==============================
[0m14:28:54.774241 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:28:54.777760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:55.021159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ed8f9eb-cf89-4b7d-9a0a-32060297fab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e3ff64fe0>]}
[0m14:28:55.089248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ed8f9eb-cf89-4b7d-9a0a-32060297fab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e402f5820>]}
[0m14:28:55.092101 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:28:55.205046 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:28:56.655589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m14:28:56.656996 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros/trip_type.sql
[0m14:28:56.658227 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros/trip_duration.sql
[0m14:28:56.659628 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/staging/staging_green_tripdata_2019_all.sql
[0m14:28:56.661165 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:28:57.116040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m14:28:57.135084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ed8f9eb-cf89-4b7d-9a0a-32060297fab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e3ca137d0>]}
[0m14:28:57.310387 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:28:57.324003 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:28:57.363486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ed8f9eb-cf89-4b7d-9a0a-32060297fab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e3c872960>]}
[0m14:28:57.365058 [info ] [MainThread]: Found 1 seed, 3 data tests, 2 models, 12 sources, 553 macros
[0m14:28:57.366587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed8f9eb-cf89-4b7d-9a0a-32060297fab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e3e2591c0>]}
[0m14:28:57.369987 [info ] [MainThread]: 
[0m14:28:57.371720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:57.373300 [info ] [MainThread]: 
[0m14:28:57.375186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:57.382412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m14:28:57.423051 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:28:57.425287 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:28:57.427438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:57.436424 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m14:28:57.439493 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:28:57.441858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now create_ingest_db_public_public)
[0m14:28:57.443497 [debug] [ThreadPool]: Creating schema "database: "ingest_db"
schema: "public_public"
"
[0m14:28:57.451106 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_public"
[0m14:28:57.453374 [debug] [ThreadPool]: On create_ingest_db_public_public: BEGIN
[0m14:28:57.455334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:57.463279 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:28:57.465282 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_public"
[0m14:28:57.467667 [debug] [ThreadPool]: On create_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_ingest_db_public_public"} */
create schema if not exists "public_public"
[0m14:28:57.470640 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:28:57.473471 [debug] [ThreadPool]: On create_ingest_db_public_public: COMMIT
[0m14:28:57.475701 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_public"
[0m14:28:57.477901 [debug] [ThreadPool]: On create_ingest_db_public_public: COMMIT
[0m14:28:57.486794 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m14:28:57.489779 [debug] [ThreadPool]: On create_ingest_db_public_public: Close
[0m14:28:57.494236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ingest_db_public_public, now list_ingest_db_public)
[0m14:28:57.505548 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:28:57.507425 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:28:57.508980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:57.517884 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:28:57.519309 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:28:57.520622 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:28:57.525805 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m14:28:57.529560 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:28:57.532726 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:28:57.535402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_public)
[0m14:28:57.543474 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:28:57.545716 [debug] [ThreadPool]: On list_ingest_db_public_public: BEGIN
[0m14:28:57.547494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:57.555998 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:28:57.558480 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:28:57.560757 [debug] [ThreadPool]: On list_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:28:57.565652 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:28:57.568942 [debug] [ThreadPool]: On list_ingest_db_public_public: ROLLBACK
[0m14:28:57.571543 [debug] [ThreadPool]: On list_ingest_db_public_public: Close
[0m14:28:57.579088 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.580847 [debug] [MainThread]: On master: BEGIN
[0m14:28:57.582626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:57.591109 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:28:57.593573 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.595196 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:57.606132 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m14:28:57.611949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed8f9eb-cf89-4b7d-9a0a-32060297fab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e41d1c740>]}
[0m14:28:57.614071 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:57.616568 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.618566 [debug] [MainThread]: On master: BEGIN
[0m14:28:57.620706 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:28:57.622036 [debug] [MainThread]: On master: COMMIT
[0m14:28:57.623272 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:57.624559 [debug] [MainThread]: On master: COMMIT
[0m14:28:57.626432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:57.628040 [debug] [MainThread]: On master: Close
[0m14:28:57.631825 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:28:57.634002 [info ] [Thread-1 (]: 1 of 2 START sql view model public_public.staging_green_tripdata_2019_all ...... [RUN]
[0m14:28:57.635617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:28:57.637293 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:28:57.648489 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:28:57.670144 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:28:57.712260 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:28:57.736683 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:28:57.739055 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m14:28:57.741142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:57.751047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:28:57.753210 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:28:57.755425 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m14:28:57.763759 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:28:57.773065 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:28:57.775424 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m14:28:57.779005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:28:57.798404 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:28:57.800982 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:28:57.803492 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:28:57.807888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:28:57.817070 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup"
[0m14:28:57.824929 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:28:57.827892 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m14:28:57.830581 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:28:57.835514 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m14:28:57.839153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed8f9eb-cf89-4b7d-9a0a-32060297fab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e41c76750>]}
[0m14:28:57.841673 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_public.staging_green_tripdata_2019_all . [[32mCREATE VIEW[0m in 0.20s]
[0m14:28:57.843759 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:28:57.845644 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:28:57.847046 [info ] [Thread-1 (]: 2 of 2 START sql table model public_public.green_tripdata_summary_2019 ......... [RUN]
[0m14:28:57.848363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:28:57.849669 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:28:57.856722 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:28:57.872657 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:28:57.901752 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:28:57.923862 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:28:57.926309 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m14:28:57.928610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:57.936471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:28:57.938949 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:28:57.941126 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    
    case
      when avg(trip_distance) <= 2 then 'Short'
      when avg(trip_distance) <= 5 then 'Medium'
      else 'Long'
    end
 as trip_type,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,
    
    round(
      max(
        case
          when lpep_dropoff_datetime is not null then
            extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime) / 60
          else null
        end
      ), 2
    )
 as trip_duration_minutes,
    -- Calculating average tip rate
    round(
    avg(
        case
            when fare_amount is null or fare_amount = 0 then null
            else cast(tip_amount as float) / fare_amount
        end
    )
::numeric, 2) as tip_rate


from "ingest_db"."public_public"."staging_green_tripdata_2019_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m14:29:52.304384 [debug] [Thread-1 (]: SQL status: SELECT 45041 in 54.362 seconds
[0m14:29:52.313056 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:29:52.315884 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp" rename to "green_tripdata_summary_2019"
[0m14:29:52.320186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:29:52.331915 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:29:52.334186 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:29:52.336908 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:29:52.342360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:29:52.347856 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup"
[0m14:29:52.356541 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:29:52.358991 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
drop table if exists "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup" cascade
[0m14:29:52.364705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:52.369333 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m14:29:52.372823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed8f9eb-cf89-4b7d-9a0a-32060297fab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e3c333f80>]}
[0m14:29:52.377961 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public_public.green_tripdata_summary_2019 .... [[32mSELECT 45041[0m in 54.52s]
[0m14:29:52.381967 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:29:52.389912 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:52.393208 [debug] [MainThread]: On master: BEGIN
[0m14:29:52.395502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:52.422218 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m14:29:52.426569 [debug] [MainThread]: On master: COMMIT
[0m14:29:52.429057 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:52.432074 [debug] [MainThread]: On master: COMMIT
[0m14:29:52.436096 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:29:52.438731 [debug] [MainThread]: On master: Close
[0m14:29:52.442738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:52.444456 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:29:52.447290 [info ] [MainThread]: 
[0m14:29:52.449742 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 55.07 seconds (55.07s).
[0m14:29:52.453582 [debug] [MainThread]: Command end result
[0m14:29:52.537254 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:29:52.546293 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:29:52.561840 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:29:52.563702 [info ] [MainThread]: 
[0m14:29:52.568210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:52.569971 [info ] [MainThread]: 
[0m14:29:52.573100 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:29:52.576328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 57.99622, "process_in_blocks": "200", "process_kernel_time": 0.161215, "process_mem_max_rss": "112992", "process_out_blocks": "0", "process_user_time": 2.881734}
[0m14:29:52.579052 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:52.578783 after 58.00 seconds
[0m14:29:52.580614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e40420590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e40151b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e3e6a92e0>]}
[0m14:29:52.588045 [debug] [MainThread]: Flushing usage events
[0m14:29:57.215194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:56.203068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca58c2d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca58f60ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca58bccbc0>]}


============================== 14:31:56.209447 | 2a1519cc-eed0-4d76-8946-6c1a2acd1e35 ==============================
[0m14:31:56.209447 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:31:56.211351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:31:56.435523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a1519cc-eed0-4d76-8946-6c1a2acd1e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca587838f0>]}
[0m14:31:56.516042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a1519cc-eed0-4d76-8946-6c1a2acd1e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca58b2a1e0>]}
[0m14:31:56.518094 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:31:56.612760 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:31:56.754819 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:31:56.756948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a1519cc-eed0-4d76-8946-6c1a2acd1e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5869d790>]}
[0m14:32:03.259237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m14:32:03.278686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a1519cc-eed0-4d76-8946-6c1a2acd1e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca56f5b8c0>]}
[0m14:32:03.833585 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:32:03.882509 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:32:03.957235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a1519cc-eed0-4d76-8946-6c1a2acd1e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca569d6d20>]}
[0m14:32:03.966607 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 553 macros
[0m14:32:03.971265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a1519cc-eed0-4d76-8946-6c1a2acd1e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca54fa5fa0>]}
[0m14:32:03.977183 [info ] [MainThread]: 
[0m14:32:03.985829 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:03.988104 [info ] [MainThread]: 
[0m14:32:03.989901 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:32:03.997897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m14:32:04.059868 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:32:04.062264 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:32:04.063980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:04.078147 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m14:32:04.082915 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:32:04.089724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m14:32:04.162067 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:32:04.166395 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:32:04.170432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:04.198553 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m14:32:04.204940 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:32:04.211891 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:32:04.232955 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.017 seconds
[0m14:32:04.239055 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:32:04.243479 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:32:04.248808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_public)
[0m14:32:04.282995 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:32:04.300685 [debug] [ThreadPool]: On list_ingest_db_public_public: BEGIN
[0m14:32:04.305327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:04.317326 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m14:32:04.319505 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:32:04.321957 [debug] [ThreadPool]: On list_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:32:04.327302 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:32:04.331194 [debug] [ThreadPool]: On list_ingest_db_public_public: ROLLBACK
[0m14:32:04.333490 [debug] [ThreadPool]: On list_ingest_db_public_public: Close
[0m14:32:04.342276 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:04.344918 [debug] [MainThread]: On master: BEGIN
[0m14:32:04.347215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:04.361929 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m14:32:04.398993 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:04.411341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:32:04.436265 [debug] [MainThread]: SQL status: SELECT 24 in 0.017 seconds
[0m14:32:04.482285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a1519cc-eed0-4d76-8946-6c1a2acd1e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca56d2c980>]}
[0m14:32:04.503466 [debug] [MainThread]: On master: ROLLBACK
[0m14:32:04.513844 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:04.521834 [debug] [MainThread]: On master: BEGIN
[0m14:32:04.533946 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:32:04.546871 [debug] [MainThread]: On master: COMMIT
[0m14:32:04.560089 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:04.581621 [debug] [MainThread]: On master: COMMIT
[0m14:32:04.593782 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:32:04.604436 [debug] [MainThread]: On master: Close
[0m14:32:04.622918 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:32:04.629212 [info ] [Thread-1 (]: 1 of 2 START sql view model public_public.staging_green_tripdata_2019_all ...... [RUN]
[0m14:32:04.637206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:32:04.642564 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:32:04.669348 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:32:04.715569 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:32:04.772249 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:32:04.851101 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:32:04.854763 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m14:32:04.858250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:04.891264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m14:32:04.901070 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:32:04.908858 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m14:32:04.927404 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:32:04.974075 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:32:04.983161 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_public"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m14:32:04.998697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:32:05.024173 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:32:05.029624 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m14:32:05.038914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:32:05.078978 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:32:05.082159 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:32:05.084306 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:32:05.092133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:32:05.102446 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup"
[0m14:32:05.111374 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:32:05.114631 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m14:32:05.122342 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:32:05.129746 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m14:32:05.140188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1519cc-eed0-4d76-8946-6c1a2acd1e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5a3ae3f0>]}
[0m14:32:05.147584 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_public.staging_green_tripdata_2019_all . [[32mCREATE VIEW[0m in 0.50s]
[0m14:32:05.152173 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:32:05.157567 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:32:05.161090 [info ] [Thread-1 (]: 2 of 2 START sql table model public_public.green_tripdata_summary_2019 ......... [RUN]
[0m14:32:05.164829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:32:05.169456 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:32:05.193455 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:32:05.235769 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:32:05.284163 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:32:05.330996 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:32:05.335084 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m14:32:05.339211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:05.358257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m14:32:05.360568 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:32:05.363319 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    
    case
      when avg(trip_distance) <= 2 then 'Short'
      when avg(trip_distance) <= 5 then 'Medium'
      else 'Long'
    end
 as trip_type,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,
    
    round(
      max(
        case
          when lpep_dropoff_datetime is not null then
            extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime) / 60
          else null
        end
      ), 2
    )
 as trip_duration_minutes,
    -- Calculating average tip rate
    round(
    avg(
        case
            when fare_amount is null or fare_amount = 0 then null
            else cast(tip_amount as float) / fare_amount
        end
    )
::numeric, 2) as tip_rate


from "ingest_db"."public_public"."staging_green_tripdata_2019_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m14:32:59.781349 [debug] [Thread-1 (]: SQL status: SELECT 45041 in 54.418 seconds
[0m14:32:59.795502 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:32:59.797988 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public_public"."green_tripdata_summary_2019" rename to "green_tripdata_summary_2019__dbt_backup"
[0m14:32:59.802252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:32:59.810198 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:32:59.812996 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp" rename to "green_tripdata_summary_2019"
[0m14:32:59.816960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:32:59.832145 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:32:59.834742 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:32:59.836898 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:32:59.844684 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:32:59.849880 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup"
[0m14:32:59.859616 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:32:59.861705 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
drop table if exists "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup" cascade
[0m14:32:59.874332 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m14:32:59.879956 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m14:32:59.884792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a1519cc-eed0-4d76-8946-6c1a2acd1e35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca541d6600>]}
[0m14:32:59.890758 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public_public.green_tripdata_summary_2019 .... [[32mSELECT 45041[0m in 54.72s]
[0m14:32:59.895389 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:32:59.905070 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:59.907521 [debug] [MainThread]: On master: BEGIN
[0m14:32:59.909884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:59.928091 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m14:32:59.930502 [debug] [MainThread]: On master: COMMIT
[0m14:32:59.932807 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:59.934690 [debug] [MainThread]: On master: COMMIT
[0m14:32:59.937228 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:32:59.940062 [debug] [MainThread]: On master: Close
[0m14:32:59.945114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:59.948122 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:32:59.950396 [info ] [MainThread]: 
[0m14:32:59.953839 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 55.96 seconds (55.96s).
[0m14:32:59.956244 [debug] [MainThread]: Command end result
[0m14:33:00.045271 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:33:00.053635 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:33:00.071068 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:33:00.075325 [info ] [MainThread]: 
[0m14:33:00.079745 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:00.081525 [info ] [MainThread]: 
[0m14:33:00.083726 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:33:00.088631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 64.091576, "process_in_blocks": "168", "process_kernel_time": 0.38521, "process_mem_max_rss": "116136", "process_out_blocks": "0", "process_user_time": 5.146015}
[0m14:33:00.091883 [debug] [MainThread]: Command `dbt run` succeeded at 14:33:00.091545 after 64.10 seconds
[0m14:33:00.095582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca589b9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5be06990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca55114200>]}
[0m14:33:00.099378 [debug] [MainThread]: Flushing usage events
[0m14:33:01.595137 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:28.370687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca3520a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca34dfd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca408e090>]}


============================== 14:35:28.377291 | e7ca4ed8-ab9f-4946-9562-c724f5e5fabb ==============================
[0m14:35:28.377291 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:35:28.379880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:35:28.625971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7ca4ed8-ab9f-4946-9562-c724f5e5fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca2d7b140>]}
[0m14:35:28.698680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7ca4ed8-ab9f-4946-9562-c724f5e5fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca330fef0>]}
[0m14:35:28.700790 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:35:28.851578 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:35:29.020912 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:35:29.023129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7ca4ed8-ab9f-4946-9562-c724f5e5fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca1467b60>]}
[0m14:35:33.570796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m14:35:33.585136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7ca4ed8-ab9f-4946-9562-c724f5e5fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca10ec6b0>]}
[0m14:35:33.930226 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:35:33.972923 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:35:34.070727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7ca4ed8-ab9f-4946-9562-c724f5e5fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9b93dbb0>]}
[0m14:35:34.090260 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 553 macros
[0m14:35:34.098984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ca4ed8-ab9f-4946-9562-c724f5e5fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9b879460>]}
[0m14:35:34.115214 [info ] [MainThread]: 
[0m14:35:34.124507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:34.132747 [info ] [MainThread]: 
[0m14:35:34.147725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:35:34.173105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m14:35:34.214766 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:35:34.217495 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:35:34.220346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:34.231560 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m14:35:34.235724 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:35:34.239948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now create_ingest_db_public_public)
[0m14:35:34.242761 [debug] [ThreadPool]: Creating schema "database: "ingest_db"
schema: "public_public"
"
[0m14:35:34.254399 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_public"
[0m14:35:34.256787 [debug] [ThreadPool]: On create_ingest_db_public_public: BEGIN
[0m14:35:34.259748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:34.273930 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:35:34.277605 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_public"
[0m14:35:34.281293 [debug] [ThreadPool]: On create_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_ingest_db_public_public"} */
create schema if not exists "public_public"
[0m14:35:34.286369 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:35:34.292356 [debug] [ThreadPool]: On create_ingest_db_public_public: COMMIT
[0m14:35:34.297547 [debug] [ThreadPool]: Using postgres connection "create_ingest_db_public_public"
[0m14:35:34.302852 [debug] [ThreadPool]: On create_ingest_db_public_public: COMMIT
[0m14:35:34.317105 [debug] [ThreadPool]: SQL status: COMMIT in 0.008 seconds
[0m14:35:34.322677 [debug] [ThreadPool]: On create_ingest_db_public_public: Close
[0m14:35:34.331799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ingest_db_public_public, now list_ingest_db_public_public)
[0m14:35:34.346878 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:35:34.350018 [debug] [ThreadPool]: On list_ingest_db_public_public: BEGIN
[0m14:35:34.353120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:34.370118 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m14:35:34.375149 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:35:34.379889 [debug] [ThreadPool]: On list_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:35:34.392112 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m14:35:34.398410 [debug] [ThreadPool]: On list_ingest_db_public_public: ROLLBACK
[0m14:35:34.402318 [debug] [ThreadPool]: On list_ingest_db_public_public: Close
[0m14:35:34.406838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_public, now list_ingest_db_public)
[0m14:35:34.415014 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:35:34.418592 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:35:34.421954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:34.441253 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m14:35:34.445224 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:35:34.449069 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:35:34.463474 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.010 seconds
[0m14:35:34.468919 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:35:34.473483 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:35:34.490763 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:34.494252 [debug] [MainThread]: On master: BEGIN
[0m14:35:34.499117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:34.510421 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:35:34.514799 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:34.518913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:35:34.536070 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m14:35:34.541685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ca4ed8-ab9f-4946-9562-c724f5e5fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9b90d2e0>]}
[0m14:35:34.547773 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:34.554606 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:34.561605 [debug] [MainThread]: On master: BEGIN
[0m14:35:34.572772 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:35:34.578785 [debug] [MainThread]: On master: COMMIT
[0m14:35:34.584132 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:34.588182 [debug] [MainThread]: On master: COMMIT
[0m14:35:34.593331 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:35:34.597384 [debug] [MainThread]: On master: Close
[0m14:35:34.605342 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:35:34.608713 [info ] [Thread-1 (]: 1 of 2 START sql view model public_public.staging_green_tripdata_2019_all ...... [RUN]
[0m14:35:34.611754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:35:34.613235 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:35:34.625484 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:35:34.673712 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:35:34.726969 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:35:34.752974 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:35:34.754520 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m14:35:34.756642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:34.764502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:35:34.766438 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:35:34.768441 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m14:35:34.777012 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:35:34.786367 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:35:34.788401 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m14:35:34.791544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:34.808103 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:35:34.810063 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:35:34.811951 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:35:34.816289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:35:34.824635 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup"
[0m14:35:34.831614 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:35:34.833502 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m14:35:34.835814 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:35:34.839708 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m14:35:34.842785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ca4ed8-ab9f-4946-9562-c724f5e5fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9b89b080>]}
[0m14:35:34.844550 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_public.staging_green_tripdata_2019_all . [[32mCREATE VIEW[0m in 0.23s]
[0m14:35:34.846057 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:35:34.848024 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:35:34.849110 [info ] [Thread-1 (]: 2 of 2 START sql table model public_public.green_tripdata_summary_2019 ......... [RUN]
[0m14:35:34.850765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:35:34.851995 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:35:34.858236 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:35:34.874131 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:35:34.902866 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:35:34.940317 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:35:34.945292 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m14:35:34.950640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:34.983471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m14:35:34.989720 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:35:34.994645 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    
    case
      when avg(trip_distance) <= 2 then 'Short'
      when avg(trip_distance) <= 5 then 'Medium'
      else 'Long'
    end
 as trip_type,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,
    
    round(
      max(
        case
          when lpep_dropoff_datetime is not null then
            extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime) / 60
          else null
        end
      ), 2
    )
 as trip_duration_minutes,
    -- Calculating average tip rate
    round(
    avg(
        case
            when fare_amount is null or fare_amount = 0 then null
            else cast(tip_amount as float) / fare_amount
        end
    )
::numeric, 2) as tip_rate


from "ingest_db"."public_public"."staging_green_tripdata_2019_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m14:36:26.265983 [debug] [Thread-1 (]: SQL status: SELECT 45041 in 51.273 seconds
[0m14:36:26.273988 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:36:26.276759 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp" rename to "green_tripdata_summary_2019"
[0m14:36:26.279386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:36:26.286482 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:36:26.288197 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:36:26.289967 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:36:26.296212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:36:26.301269 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup"
[0m14:36:26.309381 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:36:26.312209 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
drop table if exists "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup" cascade
[0m14:36:26.315266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:36:26.318867 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m14:36:26.321480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ca4ed8-ab9f-4946-9562-c724f5e5fabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9a96f770>]}
[0m14:36:26.325179 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public_public.green_tripdata_summary_2019 .... [[32mSELECT 45041[0m in 51.47s]
[0m14:36:26.328027 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:36:26.332029 [debug] [MainThread]: Using postgres connection "master"
[0m14:36:26.334121 [debug] [MainThread]: On master: BEGIN
[0m14:36:26.336218 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:36:26.346990 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:36:26.350301 [debug] [MainThread]: On master: COMMIT
[0m14:36:26.353541 [debug] [MainThread]: Using postgres connection "master"
[0m14:36:26.366139 [debug] [MainThread]: On master: COMMIT
[0m14:36:26.370665 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:36:26.373705 [debug] [MainThread]: On master: Close
[0m14:36:26.378395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:26.380979 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:36:26.383444 [info ] [MainThread]: 
[0m14:36:26.389035 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 52.24 seconds (52.24s).
[0m14:36:26.395411 [debug] [MainThread]: Command end result
[0m14:36:26.492107 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:36:26.501907 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:36:26.517402 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:36:26.519718 [info ] [MainThread]: 
[0m14:36:26.521708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:36:26.525711 [info ] [MainThread]: 
[0m14:36:26.527798 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:36:26.533674 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 58.304558, "process_in_blocks": "0", "process_kernel_time": 0.282294, "process_mem_max_rss": "117144", "process_out_blocks": "0", "process_user_time": 4.536173}
[0m14:36:26.537019 [debug] [MainThread]: Command `dbt run` succeeded at 14:36:26.536664 after 58.31 seconds
[0m14:36:26.539022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca408e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca3256ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ca3257e00>]}
[0m14:36:26.540632 [debug] [MainThread]: Flushing usage events
[0m14:36:30.239105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:48.979134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c57e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c528bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c57d9a0>]}


============================== 14:39:48.983622 | e94ac473-0bd6-452c-aa74-49eefd4d4c65 ==============================
[0m14:39:48.983622 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:39:48.985297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:39:49.213789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e94ac473-0bd6-452c-aa74-49eefd4d4c65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54bece270>]}
[0m14:39:49.288081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e94ac473-0bd6-452c-aa74-49eefd4d4c65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54cc7dc70>]}
[0m14:39:49.290455 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:39:49.431645 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:39:49.599505 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:39:49.601736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e94ac473-0bd6-452c-aa74-49eefd4d4c65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c553ef0>]}
[0m14:39:53.428211 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m14:39:53.444397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e94ac473-0bd6-452c-aa74-49eefd4d4c65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa548ad1580>]}
[0m14:39:53.635252 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:39:53.647216 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:39:53.678221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e94ac473-0bd6-452c-aa74-49eefd4d4c65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa548a15dc0>]}
[0m14:39:53.679423 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 553 macros
[0m14:39:53.680907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94ac473-0bd6-452c-aa74-49eefd4d4c65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa548825040>]}
[0m14:39:53.684389 [info ] [MainThread]: 
[0m14:39:53.685866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:53.687746 [info ] [MainThread]: 
[0m14:39:53.689553 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:53.696995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public_public'
[0m14:39:53.736176 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:39:53.738618 [debug] [ThreadPool]: On list_ingest_db_public_public: BEGIN
[0m14:39:53.740664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:53.748928 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:39:53.751271 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:39:53.754253 [debug] [ThreadPool]: On list_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:39:53.759413 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:39:53.763301 [debug] [ThreadPool]: On list_ingest_db_public_public: ROLLBACK
[0m14:39:53.766409 [debug] [ThreadPool]: On list_ingest_db_public_public: Close
[0m14:39:53.770115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_public, now list_ingest_db_public)
[0m14:39:53.777207 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:39:53.780632 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:39:53.783901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:53.799592 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m14:39:53.803821 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:39:53.807970 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:39:53.817696 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.005 seconds
[0m14:39:53.826112 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:39:53.832470 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:39:53.862693 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:53.866182 [debug] [MainThread]: On master: BEGIN
[0m14:39:53.868165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:53.879061 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:39:53.884794 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:53.886614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:53.902522 [debug] [MainThread]: SQL status: SELECT 12 in 0.013 seconds
[0m14:39:53.908481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e94ac473-0bd6-452c-aa74-49eefd4d4c65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa548a15af0>]}
[0m14:39:53.911053 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:53.912932 [debug] [MainThread]: On master: Close
[0m14:39:53.922654 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:39:53.927429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:39:53.931381 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:39:53.949253 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:39:53.999951 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:39:54.009309 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:39:54.017140 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.lookup_data
[0m14:39:54.025907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now seed.my_dbt_project.lookup_data)
[0m14:39:54.035380 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.lookup_data
[0m14:39:54.056195 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.lookup_data
[0m14:39:54.069080 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.lookup_data
[0m14:39:54.078634 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m14:39:54.088928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.lookup_data, now test.my_dbt_project.test_calculate_tip_rate)
[0m14:39:54.098198 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m14:39:54.127525 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_calculate_tip_rate"
[0m14:39:54.189477 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_calculate_tip_rate
[0m14:39:54.199075 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m14:39:54.202918 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m14:39:54.205462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m14:39:54.208321 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m14:39:54.220058 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_is_valid_trip"
[0m14:39:54.255088 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_is_valid_trip
[0m14:39:54.266960 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m14:39:54.279907 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m14:39:54.288263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m14:39:54.295725 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m14:39:54.319733 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m14:39:54.370895 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m14:39:54.379523 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m14:39:54.388495 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:39:54.399264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_standardize_payment_type, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:39:54.408961 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:39:54.440370 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:39:54.509237 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:39:54.513403 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:39:54.518087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:54.520598 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:39:54.525310 [debug] [MainThread]: Command end result
[0m14:39:54.609787 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:39:54.618700 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:39:54.649271 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:39:54.652964 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.8207784, "process_in_blocks": "0", "process_kernel_time": 0.271708, "process_mem_max_rss": "114408", "process_out_blocks": "0", "process_user_time": 4.317151}
[0m14:39:54.686802 [debug] [MainThread]: Command `dbt compile` succeeded at 14:39:54.685709 after 5.85 seconds
[0m14:39:54.694077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c95b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54c73d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54cca7f80>]}
[0m14:39:54.699709 [debug] [MainThread]: Flushing usage events
[0m14:39:57.577312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:56.013074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca18b9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca17bb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca17a0f80>]}


============================== 14:40:56.020446 | 4050eaa5-e6cb-433c-8355-3966d287c21e ==============================
[0m14:40:56.020446 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:40:56.022547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:40:56.266365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4050eaa5-e6cb-433c-8355-3966d287c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca312f260>]}
[0m14:40:56.337120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4050eaa5-e6cb-433c-8355-3966d287c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca12bf950>]}
[0m14:40:56.339791 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:40:56.481078 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:40:58.302409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:58.303743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:58.312954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m14:40:58.384073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4050eaa5-e6cb-433c-8355-3966d287c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9fb80a10>]}
[0m14:40:58.557289 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:40:58.567788 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:40:58.599415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4050eaa5-e6cb-433c-8355-3966d287c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9f702bd0>]}
[0m14:40:58.601087 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 553 macros
[0m14:40:58.602535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4050eaa5-e6cb-433c-8355-3966d287c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca18b93a0>]}
[0m14:40:58.605499 [info ] [MainThread]: 
[0m14:40:58.606804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:58.607940 [info ] [MainThread]: 
[0m14:40:58.609482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:58.616312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m14:40:58.658036 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:40:58.659301 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:40:58.660358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:58.668683 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m14:40:58.671796 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:40:58.675413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m14:40:58.683245 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:40:58.684903 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:40:58.686536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:58.693847 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:40:58.696003 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:40:58.697841 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:40:58.702666 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m14:40:58.706487 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:40:58.708252 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:40:58.710689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_public)
[0m14:40:58.719716 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:40:58.721313 [debug] [ThreadPool]: On list_ingest_db_public_public: BEGIN
[0m14:40:58.723177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:58.730533 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:40:58.732524 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:40:58.735647 [debug] [ThreadPool]: On list_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:40:58.741001 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:40:58.744164 [debug] [ThreadPool]: On list_ingest_db_public_public: ROLLBACK
[0m14:40:58.746195 [debug] [ThreadPool]: On list_ingest_db_public_public: Close
[0m14:40:58.753625 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:58.756530 [debug] [MainThread]: On master: BEGIN
[0m14:40:58.759249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:58.770610 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:40:58.773957 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:58.777532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:40:58.791995 [debug] [MainThread]: SQL status: SELECT 12 in 0.012 seconds
[0m14:40:58.799328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4050eaa5-e6cb-433c-8355-3966d287c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9f705cd0>]}
[0m14:40:58.802880 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:58.806772 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:58.809782 [debug] [MainThread]: On master: BEGIN
[0m14:40:58.814522 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:40:58.817700 [debug] [MainThread]: On master: COMMIT
[0m14:40:58.821941 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:58.827017 [debug] [MainThread]: On master: COMMIT
[0m14:40:58.833221 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:40:58.837339 [debug] [MainThread]: On master: Close
[0m14:40:58.847956 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:40:58.853003 [info ] [Thread-1 (]: 1 of 2 START sql view model public_public.staging_green_tripdata_2019_all ...... [RUN]
[0m14:40:58.857450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:40:58.860207 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:40:58.879145 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:40:58.899922 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:40:58.938717 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:40:58.979000 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:40:58.983572 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m14:40:58.988413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:59.006336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m14:40:59.010260 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:40:59.014740 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m14:40:59.033012 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:40:59.051262 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:40:59.053643 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_public"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m14:40:59.059141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:40:59.070337 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:40:59.075025 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m14:40:59.082530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:40:59.131976 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:40:59.134819 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:40:59.137537 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:40:59.145058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:40:59.156760 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup"
[0m14:40:59.164867 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:40:59.167365 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m14:40:59.174897 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:40:59.180222 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m14:40:59.184237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4050eaa5-e6cb-433c-8355-3966d287c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca2036240>]}
[0m14:40:59.186633 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_public.staging_green_tripdata_2019_all . [[32mCREATE VIEW[0m in 0.33s]
[0m14:40:59.188651 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:40:59.191219 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:40:59.193195 [info ] [Thread-1 (]: 2 of 2 START sql table model public_public.green_tripdata_summary_2019 ......... [RUN]
[0m14:40:59.195032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:40:59.196590 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:40:59.212686 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:40:59.234833 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:40:59.259382 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:40:59.299587 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:40:59.302657 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m14:40:59.305755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:59.318737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:40:59.321746 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:40:59.323824 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    
    case
      when avg(trip_distance) <= 2 then 'Short'
      when avg(trip_distance) <= 5 then 'Medium'
      else 'Long'
    end
 as trip_type,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,
    
    round(
      max(
        case
          when lpep_dropoff_datetime is not null then
            extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime) / 60
          else null
        end
      ), 2
    )
 as trip_duration_minutes,
    -- Calculating average tip rate
    round(
    avg(
        case
            when fare_amount is null or fare_amount = 0 then null
            else cast(tip_amount as float) / fare_amount
        end
    )
::numeric, 2) as tip_rate


from "ingest_db"."public_public"."staging_green_tripdata_2019_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m14:41:49.736855 [debug] [Thread-1 (]: SQL status: SELECT 45041 in 50.415 seconds
[0m14:41:49.742597 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:41:49.743962 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public_public"."green_tripdata_summary_2019" rename to "green_tripdata_summary_2019__dbt_backup"
[0m14:41:49.746530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:49.752184 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:41:49.754634 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp" rename to "green_tripdata_summary_2019"
[0m14:41:49.757415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:49.764748 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:41:49.767414 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:41:49.769955 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:41:49.777432 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:41:49.782798 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup"
[0m14:41:49.789290 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:41:49.792816 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
drop table if exists "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup" cascade
[0m14:41:49.800684 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:41:49.805005 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m14:41:49.808528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4050eaa5-e6cb-433c-8355-3966d287c21e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9ea43a70>]}
[0m14:41:49.811110 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public_public.green_tripdata_summary_2019 .... [[32mSELECT 45041[0m in 50.61s]
[0m14:41:49.815106 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:41:49.819996 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:49.823362 [debug] [MainThread]: On master: BEGIN
[0m14:41:49.826037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:49.835292 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:41:49.837832 [debug] [MainThread]: On master: COMMIT
[0m14:41:49.839995 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:49.841910 [debug] [MainThread]: On master: COMMIT
[0m14:41:49.844637 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:49.847165 [debug] [MainThread]: On master: Close
[0m14:41:49.849897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:49.852460 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:41:49.854745 [info ] [MainThread]: 
[0m14:41:49.856902 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 51.25 seconds (51.25s).
[0m14:41:49.859308 [debug] [MainThread]: Command end result
[0m14:41:49.956218 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:41:49.970501 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:41:49.989416 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:41:49.991499 [info ] [MainThread]: 
[0m14:41:49.994133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:49.998560 [info ] [MainThread]: 
[0m14:41:50.002890 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:41:50.009098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 54.16883, "process_in_blocks": "0", "process_kernel_time": 0.242622, "process_mem_max_rss": "109048", "process_out_blocks": "0", "process_user_time": 2.648625}
[0m14:41:50.011368 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:50.011149 after 54.17 seconds
[0m14:41:50.014051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1a5ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9f8cb9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c9f8cb560>]}
[0m14:41:50.016295 [debug] [MainThread]: Flushing usage events
[0m14:41:52.624890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:05.080307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66c0b2a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66c0ac7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66c0ac52b0>]}


============================== 14:43:05.084607 | d815e099-8830-4b5d-8487-09a7d32e5d50 ==============================
[0m14:43:05.084607 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:43:05.085884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:43:05.311684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd815e099-8830-4b5d-8487-09a7d32e5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66c06ad190>]}
[0m14:43:05.393319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd815e099-8830-4b5d-8487-09a7d32e5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66c0b87ef0>]}
[0m14:43:05.395779 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:43:05.499303 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:43:05.645717 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:43:05.647969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd815e099-8830-4b5d-8487-09a7d32e5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bebd01a0>]}
[0m14:43:08.510670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m14:43:08.527562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd815e099-8830-4b5d-8487-09a7d32e5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bcef76b0>]}
[0m14:43:08.746264 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:43:08.814137 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:43:08.905918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd815e099-8830-4b5d-8487-09a7d32e5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bead81a0>]}
[0m14:43:08.912275 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 553 macros
[0m14:43:08.918622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd815e099-8830-4b5d-8487-09a7d32e5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66bcf156a0>]}
[0m14:43:08.945694 [info ] [MainThread]: 
[0m14:43:08.955488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:08.969176 [info ] [MainThread]: 
[0m14:43:08.975810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:08.986320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public'
[0m14:43:09.032810 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:43:09.035115 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:43:09.038552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:09.053800 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m14:43:09.056284 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:43:09.059932 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:43:09.066069 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.004 seconds
[0m14:43:09.070382 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:43:09.072068 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:43:09.073929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public, now list_ingest_db_public_public)
[0m14:43:09.089046 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:43:09.095666 [debug] [ThreadPool]: On list_ingest_db_public_public: BEGIN
[0m14:43:09.099788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:09.113238 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:43:09.115986 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:43:09.118607 [debug] [ThreadPool]: On list_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:43:09.123800 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:43:09.127160 [debug] [ThreadPool]: On list_ingest_db_public_public: ROLLBACK
[0m14:43:09.129787 [debug] [ThreadPool]: On list_ingest_db_public_public: Close
[0m14:43:09.139985 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:09.142517 [debug] [MainThread]: On master: BEGIN
[0m14:43:09.145272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:09.160074 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m14:43:09.162368 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:09.164888 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:43:09.176389 [debug] [MainThread]: SQL status: SELECT 12 in 0.009 seconds
[0m14:43:09.181604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd815e099-8830-4b5d-8487-09a7d32e5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66be9aac90>]}
[0m14:43:09.184002 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:09.187428 [debug] [MainThread]: On master: Close
[0m14:43:09.196107 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:09.199564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:43:09.202830 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:09.220992 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:09.259956 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:09.264975 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:09.268678 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.lookup_data
[0m14:43:09.272094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now seed.my_dbt_project.lookup_data)
[0m14:43:09.274992 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.lookup_data
[0m14:43:09.279632 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.lookup_data
[0m14:43:09.283287 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.lookup_data
[0m14:43:09.285448 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m14:43:09.288033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.lookup_data, now test.my_dbt_project.test_calculate_tip_rate)
[0m14:43:09.290323 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m14:43:09.294658 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_calculate_tip_rate"
[0m14:43:09.318996 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_calculate_tip_rate
[0m14:43:09.322306 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m14:43:09.326096 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m14:43:09.329519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m14:43:09.332837 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m14:43:09.340385 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_is_valid_trip"
[0m14:43:09.360918 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_is_valid_trip
[0m14:43:09.363598 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m14:43:09.366041 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m14:43:09.368868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m14:43:09.371857 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m14:43:09.377915 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m14:43:09.406078 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m14:43:09.410174 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m14:43:09.412556 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:09.415242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_standardize_payment_type, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:43:09.417505 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:09.428378 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:43:09.462237 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:09.467835 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:09.477796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:09.482153 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:43:09.485842 [debug] [MainThread]: Command end result
[0m14:43:09.572637 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:43:09.587119 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:43:09.612960 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:43:09.617682 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.6763453, "process_in_blocks": "0", "process_kernel_time": 0.189391, "process_mem_max_rss": "114592", "process_out_blocks": "0", "process_user_time": 4.415808}
[0m14:43:09.619844 [debug] [MainThread]: Command `dbt compile` succeeded at 14:43:09.619612 after 4.68 seconds
[0m14:43:09.622523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66c126a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66be8fe240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66beaa2db0>]}
[0m14:43:09.624296 [debug] [MainThread]: Flushing usage events
[0m14:43:16.186828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:28.770039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52dee38a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52dee389e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52dee38bc0>]}


============================== 14:43:28.778986 | 0853b8d7-b47d-453f-ab4d-ea3964ec969d ==============================
[0m14:43:28.778986 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:43:28.782575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:43:29.063011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0853b8d7-b47d-453f-ab4d-ea3964ec969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52de588920>]}
[0m14:43:29.132990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0853b8d7-b47d-453f-ab4d-ea3964ec969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52de314080>]}
[0m14:43:29.135529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:43:29.256404 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:43:31.628606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:31.630598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:31.637754 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m14:43:31.699261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0853b8d7-b47d-453f-ab4d-ea3964ec969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52dca90230>]}
[0m14:43:31.846489 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:43:31.856026 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:43:31.888220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0853b8d7-b47d-453f-ab4d-ea3964ec969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52dc62fb00>]}
[0m14:43:31.890354 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 553 macros
[0m14:43:31.891687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0853b8d7-b47d-453f-ab4d-ea3964ec969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52de1cf560>]}
[0m14:43:31.895451 [info ] [MainThread]: 
[0m14:43:31.897417 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:31.900370 [info ] [MainThread]: 
[0m14:43:31.902747 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:31.910170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public_public'
[0m14:43:31.958218 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:43:31.960420 [debug] [ThreadPool]: On list_ingest_db_public_public: BEGIN
[0m14:43:31.962013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:31.973859 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m14:43:31.975459 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:43:31.976662 [debug] [ThreadPool]: On list_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:43:31.980352 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:43:31.983203 [debug] [ThreadPool]: On list_ingest_db_public_public: ROLLBACK
[0m14:43:31.985309 [debug] [ThreadPool]: On list_ingest_db_public_public: Close
[0m14:43:31.986939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_public, now list_ingest_db_public)
[0m14:43:31.990427 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:43:31.992325 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:43:31.993980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:32.003442 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:43:32.005569 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:43:32.007197 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:43:32.012461 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m14:43:32.017602 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:43:32.020998 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:43:32.034185 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:32.036453 [debug] [MainThread]: On master: BEGIN
[0m14:43:32.038834 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:32.047646 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:43:32.049810 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:32.052216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:43:32.064689 [debug] [MainThread]: SQL status: SELECT 12 in 0.010 seconds
[0m14:43:32.071085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0853b8d7-b47d-453f-ab4d-ea3964ec969d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52dca794f0>]}
[0m14:43:32.073462 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:32.076108 [debug] [MainThread]: On master: Close
[0m14:43:32.082323 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:32.085389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:43:32.088784 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:32.105105 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:32.135877 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:32.139094 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:32.141793 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.lookup_data
[0m14:43:32.144657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now seed.my_dbt_project.lookup_data)
[0m14:43:32.147085 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.lookup_data
[0m14:43:32.151838 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.lookup_data
[0m14:43:32.155086 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.lookup_data
[0m14:43:32.157864 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m14:43:32.160608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.lookup_data, now test.my_dbt_project.test_calculate_tip_rate)
[0m14:43:32.163435 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m14:43:32.171160 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_calculate_tip_rate"
[0m14:43:32.191893 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_calculate_tip_rate
[0m14:43:32.194647 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m14:43:32.196486 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m14:43:32.198577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m14:43:32.200680 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m14:43:32.206815 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_is_valid_trip"
[0m14:43:32.230765 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_is_valid_trip
[0m14:43:32.234631 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m14:43:32.237252 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m14:43:32.239549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m14:43:32.242193 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m14:43:32.250541 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m14:43:32.269273 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m14:43:32.272100 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m14:43:32.274416 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:32.277405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_standardize_payment_type, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:43:32.280694 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:32.293938 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:43:32.312025 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:32.313631 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:32.316206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:32.317514 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:43:32.320581 [debug] [MainThread]: Command end result
[0m14:43:32.398536 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:43:32.409745 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:43:32.430039 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:43:32.432854 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.8376415, "process_in_blocks": "0", "process_kernel_time": 0.284822, "process_mem_max_rss": "107572", "process_out_blocks": "0", "process_user_time": 2.357148}
[0m14:43:32.434791 [debug] [MainThread]: Command `dbt compile` succeeded at 14:43:32.434611 after 3.84 seconds
[0m14:43:32.436476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52de3b7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52de6bb500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52de1eff50>]}
[0m14:43:32.438055 [debug] [MainThread]: Flushing usage events
[0m14:43:34.495110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:39.396476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71619843e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715feb7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715fe53a70>]}


============================== 14:43:39.402061 | 637b6471-21c9-496e-9889-823e9b588934 ==============================
[0m14:43:39.402061 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:43:39.403510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:43:39.624070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '637b6471-21c9-496e-9889-823e9b588934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f866a50>]}
[0m14:43:39.728488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '637b6471-21c9-496e-9889-823e9b588934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715fd127e0>]}
[0m14:43:39.730438 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:43:39.827833 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:43:41.372142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:41.375718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:41.389793 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m14:43:41.453933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '637b6471-21c9-496e-9889-823e9b588934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715e110920>]}
[0m14:43:41.648530 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:43:41.660206 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:43:41.697114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '637b6471-21c9-496e-9889-823e9b588934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715dccabd0>]}
[0m14:43:41.699925 [info ] [MainThread]: Found 2 models, 3 data tests, 1 seed, 12 sources, 553 macros
[0m14:43:41.701465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '637b6471-21c9-496e-9889-823e9b588934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715feeb230>]}
[0m14:43:41.704973 [info ] [MainThread]: 
[0m14:43:41.706695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:41.708239 [info ] [MainThread]: 
[0m14:43:41.710654 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:41.717884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m14:43:41.757098 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:43:41.759128 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:43:41.761470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:41.770488 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m14:43:41.774234 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:43:41.777585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public_public)
[0m14:43:41.787894 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:43:41.790113 [debug] [ThreadPool]: On list_ingest_db_public_public: BEGIN
[0m14:43:41.792515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:41.802947 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:43:41.805449 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public_public"
[0m14:43:41.807724 [debug] [ThreadPool]: On list_ingest_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m14:43:41.814532 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m14:43:41.819203 [debug] [ThreadPool]: On list_ingest_db_public_public: ROLLBACK
[0m14:43:41.822537 [debug] [ThreadPool]: On list_ingest_db_public_public: Close
[0m14:43:41.826112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db_public_public, now list_ingest_db_public)
[0m14:43:41.832714 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:43:41.836040 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:43:41.839522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:41.852814 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m14:43:41.854915 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:43:41.856877 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:43:41.861579 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m14:43:41.866663 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:43:41.869812 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:43:41.887468 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:41.891712 [debug] [MainThread]: On master: BEGIN
[0m14:43:41.896146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:41.911148 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m14:43:41.915292 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:41.918979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:43:41.937140 [debug] [MainThread]: SQL status: SELECT 12 in 0.015 seconds
[0m14:43:41.945594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '637b6471-21c9-496e-9889-823e9b588934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715feeb230>]}
[0m14:43:41.948828 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:41.952755 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:41.956250 [debug] [MainThread]: On master: BEGIN
[0m14:43:41.961297 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:43:41.965198 [debug] [MainThread]: On master: COMMIT
[0m14:43:41.969072 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:41.972773 [debug] [MainThread]: On master: COMMIT
[0m14:43:41.977675 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:43:41.980617 [debug] [MainThread]: On master: Close
[0m14:43:41.987120 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:41.990985 [info ] [Thread-1 (]: 1 of 2 START sql view model public_public.staging_green_tripdata_2019_all ...... [RUN]
[0m14:43:41.993905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:43:41.996793 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:42.017005 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:42.040771 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:42.081175 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:42.108524 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:42.111092 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m14:43:42.113706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:42.125397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:43:42.128948 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:42.132589 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m14:43:42.145368 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:43:42.165910 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:42.171087 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_public"."staging_green_tripdata_2019_all" rename to "staging_green_tripdata_2019_all__dbt_backup"
[0m14:43:42.178402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:43:42.189749 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:42.192859 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m14:43:42.197511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:43:42.232909 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:43:42.236150 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:42.239005 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:43:42.247989 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:43:42.270920 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup"
[0m14:43:42.284226 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:43:42.288362 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public_public"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m14:43:42.299265 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m14:43:42.307922 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m14:43:42.314500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637b6471-21c9-496e-9889-823e9b588934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715cf450d0>]}
[0m14:43:42.318594 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_public.staging_green_tripdata_2019_all . [[32mCREATE VIEW[0m in 0.32s]
[0m14:43:42.321694 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:43:42.324525 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:42.326194 [info ] [Thread-1 (]: 2 of 2 START sql table model public_public.green_tripdata_summary_2019 ......... [RUN]
[0m14:43:42.328164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:43:42.329507 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:42.344190 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:43:42.364587 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:43:42.392600 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:43:42.432575 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:43:42.435806 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m14:43:42.439844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:42.464985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m14:43:42.469614 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:43:42.474438 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    
    case
      when avg(trip_distance) <= 2 then 'Short'
      when avg(trip_distance) <= 5 then 'Medium'
      else 'Long'
    end
 as trip_type,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,
    
    round(
      max(
        case
          when lpep_dropoff_datetime is not null then
            extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime) / 60
          else null
        end
      ), 2
    )
 as trip_duration_minutes,
    -- Calculating average tip rate
    round(
    avg(
        case
            when fare_amount is null or fare_amount = 0 then null
            else cast(tip_amount as float) / fare_amount
        end
    )
::numeric, 2) as tip_rate


from "ingest_db"."public_public"."staging_green_tripdata_2019_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m14:44:33.604721 [debug] [Thread-1 (]: SQL status: SELECT 45041 in 51.131 seconds
[0m14:44:33.611013 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:44:33.613418 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public_public"."green_tripdata_summary_2019" rename to "green_tripdata_summary_2019__dbt_backup"
[0m14:44:33.616497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:33.622358 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:44:33.624701 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_tmp" rename to "green_tripdata_summary_2019"
[0m14:44:33.627814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:33.638219 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:44:33.641496 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:44:33.644810 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:44:33.652173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:44:33.660150 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup"
[0m14:44:33.667261 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:44:33.670167 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
drop table if exists "ingest_db"."public_public"."green_tripdata_summary_2019__dbt_backup" cascade
[0m14:44:33.677723 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:44:33.682587 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m14:44:33.685777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '637b6471-21c9-496e-9889-823e9b588934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715cf0b710>]}
[0m14:44:33.688115 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public_public.green_tripdata_summary_2019 .... [[32mSELECT 45041[0m in 51.36s]
[0m14:44:33.691891 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:44:33.694886 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:33.696480 [debug] [MainThread]: On master: BEGIN
[0m14:44:33.698347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:33.713123 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m14:44:33.715397 [debug] [MainThread]: On master: COMMIT
[0m14:44:33.717964 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:33.720219 [debug] [MainThread]: On master: COMMIT
[0m14:44:33.724068 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:33.726720 [debug] [MainThread]: On master: Close
[0m14:44:33.728425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:33.731778 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:44:33.734112 [info ] [MainThread]: 
[0m14:44:33.737116 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 52.02 seconds (52.02s).
[0m14:44:33.739335 [debug] [MainThread]: Command end result
[0m14:44:33.854951 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:44:33.871226 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:44:33.956162 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:44:33.975498 [info ] [MainThread]: 
[0m14:44:33.984382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:33.989913 [info ] [MainThread]: 
[0m14:44:33.997680 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:44:34.004354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 54.767216, "process_in_blocks": "0", "process_kernel_time": 0.114109, "process_mem_max_rss": "110268", "process_out_blocks": "0", "process_user_time": 2.769754}
[0m14:44:34.008301 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:34.008018 after 54.77 seconds
[0m14:44:34.012522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71619843e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715cff4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715cff41d0>]}
[0m14:44:34.015720 [debug] [MainThread]: Flushing usage events
[0m14:44:39.176895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:48.324838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e8895ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e8ff1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e8b65160>]}


============================== 14:44:48.334019 | 7d05f069-74c7-4ee9-8200-9a0bfd3d5132 ==============================
[0m14:44:48.334019 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:44:48.339039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:44:48.416898 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "default", target "dev" invalid: 'schema' is a required property
[0m14:44:48.419681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.27189854, "process_in_blocks": "0", "process_kernel_time": 0.059419, "process_mem_max_rss": "89760", "process_out_blocks": "0", "process_user_time": 1.346852}
[0m14:44:48.421928 [debug] [MainThread]: Command `dbt run` failed at 14:44:48.421781 after 0.27 seconds
[0m14:44:48.423713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e8738f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e8ff2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72e837cc50>]}
[0m14:44:48.425058 [debug] [MainThread]: Flushing usage events
[0m14:44:52.697390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:32.484577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f45538620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f45f18500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f45538680>]}


============================== 14:46:32.490522 | 217b1e7c-8f86-4896-89c7-bb1c2cf0c622 ==============================
[0m14:46:32.490522 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:46:32.492754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m14:46:32.711752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '217b1e7c-8f86-4896-89c7-bb1c2cf0c622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f45033f50>]}
[0m14:46:32.785276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '217b1e7c-8f86-4896-89c7-bb1c2cf0c622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f46dd4740>]}
[0m14:46:32.787294 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:46:32.892999 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:46:33.854218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:46:33.855809 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/staging/staging_green_tripdata_2019_all.sql
[0m14:46:33.857285 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m14:46:34.299033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m14:46:34.326211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '217b1e7c-8f86-4896-89c7-bb1c2cf0c622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f4336f470>]}
[0m14:46:34.490106 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:46:34.498129 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:46:34.530793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '217b1e7c-8f86-4896-89c7-bb1c2cf0c622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f4351a2d0>]}
[0m14:46:34.532395 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 553 macros
[0m14:46:34.533961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '217b1e7c-8f86-4896-89c7-bb1c2cf0c622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f4553b9b0>]}
[0m14:46:34.537734 [info ] [MainThread]: 
[0m14:46:34.539116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:46:34.540725 [info ] [MainThread]: 
[0m14:46:34.543079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:46:34.551946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db_public'
[0m14:46:34.591434 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:46:34.593850 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:46:34.596176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:34.604951 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:46:34.606629 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:46:34.608242 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:46:34.612385 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m14:46:34.615691 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:46:34.617610 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:46:34.630894 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:34.633586 [debug] [MainThread]: On master: BEGIN
[0m14:46:34.635632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:34.644335 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:46:34.646812 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:34.649153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:46:34.661709 [debug] [MainThread]: SQL status: SELECT 12 in 0.010 seconds
[0m14:46:34.666874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '217b1e7c-8f86-4896-89c7-bb1c2cf0c622', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f432f34d0>]}
[0m14:46:34.668996 [debug] [MainThread]: On master: ROLLBACK
[0m14:46:34.671729 [debug] [MainThread]: On master: Close
[0m14:46:34.677036 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:46:34.678871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:46:34.680434 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:46:34.696151 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:46:34.706981 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:46:34.709029 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:46:34.710776 [debug] [Thread-1 (]: Began running node seed.my_dbt_project.lookup_data
[0m14:46:34.712429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now seed.my_dbt_project.lookup_data)
[0m14:46:34.713602 [debug] [Thread-1 (]: Began compiling node seed.my_dbt_project.lookup_data
[0m14:46:34.718933 [debug] [Thread-1 (]: Began executing node seed.my_dbt_project.lookup_data
[0m14:46:34.721104 [debug] [Thread-1 (]: Finished running node seed.my_dbt_project.lookup_data
[0m14:46:34.722418 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_calculate_tip_rate
[0m14:46:34.724907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.my_dbt_project.lookup_data, now test.my_dbt_project.test_calculate_tip_rate)
[0m14:46:34.728905 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_calculate_tip_rate
[0m14:46:34.734463 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_calculate_tip_rate"
[0m14:46:34.750156 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_calculate_tip_rate
[0m14:46:34.752517 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_calculate_tip_rate
[0m14:46:34.756073 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_is_valid_trip
[0m14:46:34.757926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_calculate_tip_rate, now test.my_dbt_project.test_is_valid_trip)
[0m14:46:34.759481 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_is_valid_trip
[0m14:46:34.767366 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_is_valid_trip"
[0m14:46:34.778192 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_is_valid_trip
[0m14:46:34.780552 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_is_valid_trip
[0m14:46:34.782489 [debug] [Thread-1 (]: Began running node test.my_dbt_project.test_standardize_payment_type
[0m14:46:34.783952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_is_valid_trip, now test.my_dbt_project.test_standardize_payment_type)
[0m14:46:34.785249 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.test_standardize_payment_type
[0m14:46:34.790661 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.test_standardize_payment_type"
[0m14:46:34.799332 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.test_standardize_payment_type
[0m14:46:34.801485 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.test_standardize_payment_type
[0m14:46:34.802840 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:46:34.804177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.test_standardize_payment_type, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:46:34.805339 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:46:34.812589 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:46:34.824347 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:46:34.828024 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:46:34.832186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:34.833654 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:46:34.837407 [debug] [MainThread]: Command end result
[0m14:46:34.895274 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:46:34.902413 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:46:34.915028 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:46:34.917102 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.5864732, "process_in_blocks": "0", "process_kernel_time": 0.167379, "process_mem_max_rss": "113264", "process_out_blocks": "0", "process_user_time": 2.618992}
[0m14:46:34.918437 [debug] [MainThread]: Command `dbt compile` succeeded at 14:46:34.918258 after 2.59 seconds
[0m14:46:34.919484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f45f18500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f45a94b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f45a94200>]}
[0m14:46:34.920511 [debug] [MainThread]: Flushing usage events
[0m14:46:39.821329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:48.959688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b2860c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89aa32390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b22ca70>]}


============================== 14:46:48.967274 | 2eb1f742-e6a2-4376-9d6a-98259b73f331 ==============================
[0m14:46:48.967274 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:46:48.970255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:46:49.207260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb1f742-e6a2-4376-9d6a-98259b73f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89c467260>]}
[0m14:46:49.290924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb1f742-e6a2-4376-9d6a-98259b73f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89b697f80>]}
[0m14:46:49.293851 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:46:49.426970 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:46:51.013291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:51.015068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:51.026927 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m14:46:51.098451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb1f742-e6a2-4376-9d6a-98259b73f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ae3b8f0>]}
[0m14:46:51.306058 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:46:51.320984 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:46:51.353777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb1f742-e6a2-4376-9d6a-98259b73f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa898be4410>]}
[0m14:46:51.354956 [info ] [MainThread]: Found 3 data tests, 1 seed, 2 models, 12 sources, 553 macros
[0m14:46:51.356157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb1f742-e6a2-4376-9d6a-98259b73f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa898c951f0>]}
[0m14:46:51.359025 [info ] [MainThread]: 
[0m14:46:51.360322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:46:51.361503 [info ] [MainThread]: 
[0m14:46:51.363819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:46:51.371415 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m14:46:51.412322 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m14:46:51.414614 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m14:46:51.417372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:51.426775 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m14:46:51.430933 [debug] [ThreadPool]: On list_ingest_db: Close
[0m14:46:51.435875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m14:46:51.444769 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:46:51.447068 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m14:46:51.449502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:51.457899 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:46:51.460060 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m14:46:51.463198 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:46:51.469347 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.003 seconds
[0m14:46:51.474437 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m14:46:51.478365 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m14:46:51.503707 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:51.506263 [debug] [MainThread]: On master: BEGIN
[0m14:46:51.507969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:51.514777 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:46:51.516703 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:51.518745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:46:51.529278 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m14:46:51.535538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb1f742-e6a2-4376-9d6a-98259b73f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa898c425a0>]}
[0m14:46:51.538465 [debug] [MainThread]: On master: ROLLBACK
[0m14:46:51.542134 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:51.545105 [debug] [MainThread]: On master: BEGIN
[0m14:46:51.548777 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:46:51.551004 [debug] [MainThread]: On master: COMMIT
[0m14:46:51.552877 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:51.554832 [debug] [MainThread]: On master: COMMIT
[0m14:46:51.556650 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:46:51.558851 [debug] [MainThread]: On master: Close
[0m14:46:51.563483 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:46:51.566352 [info ] [Thread-1 (]: 1 of 2 START sql view model public.staging_green_tripdata_2019_all ............. [RUN]
[0m14:46:51.568105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_2019_all)
[0m14:46:51.569352 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:46:51.584188 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:46:51.597011 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:46:51.640138 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:46:51.668661 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:46:51.670007 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: BEGIN
[0m14:46:51.671074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:51.679161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:46:51.680342 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:46:51.681579 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */

  create view "ingest_db"."public"."staging_green_tripdata_2019_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
)

select * from combined
  );
[0m14:46:51.689048 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:46:51.698434 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:46:51.700830 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
alter table "ingest_db"."public"."staging_green_tripdata_2019_all__dbt_tmp" rename to "staging_green_tripdata_2019_all"
[0m14:46:51.704797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:46:51.735468 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:46:51.738659 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:46:51.741392 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: COMMIT
[0m14:46:51.745765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:46:51.755854 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public"."staging_green_tripdata_2019_all__dbt_backup"
[0m14:46:51.762972 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_2019_all"
[0m14:46:51.766318 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_2019_all"} */
drop view if exists "ingest_db"."public"."staging_green_tripdata_2019_all__dbt_backup" cascade
[0m14:46:51.770346 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:46:51.775533 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_2019_all: Close
[0m14:46:51.778592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb1f742-e6a2-4376-9d6a-98259b73f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89c466450>]}
[0m14:46:51.781249 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.staging_green_tripdata_2019_all ........ [[32mCREATE VIEW[0m in 0.21s]
[0m14:46:51.782957 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_2019_all
[0m14:46:51.785594 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:46:51.787204 [info ] [Thread-1 (]: 2 of 2 START sql table model public.green_tripdata_summary_2019 ................ [RUN]
[0m14:46:51.788439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.staging_green_tripdata_2019_all, now model.my_dbt_project.marts_green_tripdata_summary_2019)
[0m14:46:51.789722 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:46:51.806658 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:46:51.829414 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:46:51.855901 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:46:51.864867 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:46:51.865940 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: BEGIN
[0m14:46:51.867166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:51.873572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:46:51.875182 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:46:51.876929 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */

  
    

  create  table "ingest_db"."public"."green_tripdata_summary_2019__dbt_tmp"
  
  
    as
  
  (
    

select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    
    case
      when avg(trip_distance) <= 2 then 'Short'
      when avg(trip_distance) <= 5 then 'Medium'
      else 'Long'
    end
 as trip_type,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,
    
    round(
      max(
        case
          when lpep_dropoff_datetime is not null then
            extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime) / 60
          else null
        end
      ), 2
    )
 as trip_duration_minutes,
    -- Calculating average tip rate
    round(
    avg(
        case
            when fare_amount is null or fare_amount = 0 then null
            else cast(tip_amount as float) / fare_amount
        end
    )
::numeric, 2) as tip_rate


from "ingest_db"."public"."staging_green_tripdata_2019_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour
  );
  
[0m14:47:45.339610 [debug] [Thread-1 (]: SQL status: SELECT 45041 in 53.466 seconds
[0m14:47:45.345957 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:47:45.348107 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
alter table "ingest_db"."public"."green_tripdata_summary_2019__dbt_tmp" rename to "green_tripdata_summary_2019"
[0m14:47:45.351946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:47:45.361729 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:47:45.364640 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:47:45.367428 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: COMMIT
[0m14:47:45.373463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:47:45.379558 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public"."green_tripdata_summary_2019__dbt_backup"
[0m14:47:45.385787 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_2019"
[0m14:47:45.388499 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_2019"} */
drop table if exists "ingest_db"."public"."green_tripdata_summary_2019__dbt_backup" cascade
[0m14:47:45.391903 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:47:45.395949 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_2019: Close
[0m14:47:45.398579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eb1f742-e6a2-4376-9d6a-98259b73f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89245cf80>]}
[0m14:47:45.401123 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public.green_tripdata_summary_2019 ........... [[32mSELECT 45041[0m in 53.61s]
[0m14:47:45.404572 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_2019
[0m14:47:45.408345 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:45.410126 [debug] [MainThread]: On master: BEGIN
[0m14:47:45.411782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:45.422593 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:47:45.425758 [debug] [MainThread]: On master: COMMIT
[0m14:47:45.427752 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:45.429322 [debug] [MainThread]: On master: COMMIT
[0m14:47:45.431588 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:47:45.433401 [debug] [MainThread]: On master: Close
[0m14:47:45.434928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:45.436167 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_2019' was properly closed.
[0m14:47:45.437972 [info ] [MainThread]: 
[0m14:47:45.440422 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 54.07 seconds (54.07s).
[0m14:47:45.444819 [debug] [MainThread]: Command end result
[0m14:47:45.700856 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m14:47:45.709677 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m14:47:45.724786 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m14:47:45.726577 [info ] [MainThread]: 
[0m14:47:45.728895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:45.730826 [info ] [MainThread]: 
[0m14:47:45.732830 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:47:45.735960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 56.93104, "process_in_blocks": "0", "process_kernel_time": 0.258356, "process_mem_max_rss": "108816", "process_out_blocks": "0", "process_user_time": 2.552558}
[0m14:47:45.738090 [debug] [MainThread]: Command `dbt run` succeeded at 14:47:45.737806 after 56.93 seconds
[0m14:47:45.740524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89ac2da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89abfe6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89a6c5d90>]}
[0m14:47:45.743638 [debug] [MainThread]: Flushing usage events
[0m14:47:49.581971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:10:21.235034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2a8f8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2d4b1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2a8fb260>]}


============================== 15:10:21.239170 | 0b41ebc7-8a48-43ba-badc-0b6acd7a4b10 ==============================
[0m15:10:21.239170 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:10:21.240849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging_green_tripdata_all', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:10:21.453087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b41ebc7-8a48-43ba-badc-0b6acd7a4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2bf5f320>]}
[0m15:10:21.525868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b41ebc7-8a48-43ba-badc-0b6acd7a4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2b20f200>]}
[0m15:10:21.527930 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:10:21.633200 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:10:23.394764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:10:23.397700 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/staging/staging_green_tripdata_all.sql
[0m15:10:23.400551 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/schema.yml
[0m15:10:23.985209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m15:10:24.001763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b41ebc7-8a48-43ba-badc-0b6acd7a4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2a15c740>]}
[0m15:10:24.157341 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:10:24.165264 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:10:24.199902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b41ebc7-8a48-43ba-badc-0b6acd7a4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d26bbc2f0>]}
[0m15:10:24.202417 [info ] [MainThread]: Found 3 data tests, 1 seed, 3 models, 36 sources, 553 macros
[0m15:10:24.204003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b41ebc7-8a48-43ba-badc-0b6acd7a4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2841ffb0>]}
[0m15:10:24.207909 [info ] [MainThread]: 
[0m15:10:24.209674 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:10:24.211275 [info ] [MainThread]: 
[0m15:10:24.212687 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:24.214697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m15:10:24.249816 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m15:10:24.252004 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m15:10:24.254079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:24.267879 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m15:10:24.271363 [debug] [ThreadPool]: On list_ingest_db: Close
[0m15:10:24.280598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m15:10:24.293900 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m15:10:24.296561 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m15:10:24.298087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:24.307853 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:10:24.310607 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m15:10:24.312997 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:10:24.318549 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.003 seconds
[0m15:10:24.322506 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m15:10:24.324535 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m15:10:24.340574 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:24.342902 [debug] [MainThread]: On master: BEGIN
[0m15:10:24.345326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:24.353494 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:10:24.355723 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:24.357922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:24.373193 [debug] [MainThread]: SQL status: SELECT 12 in 0.013 seconds
[0m15:10:24.378979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b41ebc7-8a48-43ba-badc-0b6acd7a4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2846a120>]}
[0m15:10:24.380849 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:24.383791 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:24.386501 [debug] [MainThread]: On master: BEGIN
[0m15:10:24.389275 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:10:24.391738 [debug] [MainThread]: On master: COMMIT
[0m15:10:24.394257 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:24.396977 [debug] [MainThread]: On master: COMMIT
[0m15:10:24.400180 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:10:24.402123 [debug] [MainThread]: On master: Close
[0m15:10:24.407186 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_all
[0m15:10:24.409747 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_green_tripdata_all .................. [RUN]
[0m15:10:24.411481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_all)
[0m15:10:24.412873 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_all
[0m15:10:24.425678 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_all"
[0m15:10:24.444742 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_all
[0m15:10:24.487634 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_all"
[0m15:10:24.511909 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:10:24.513857 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: BEGIN
[0m15:10:24.515823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:24.524168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:10:24.526467 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:10:24.528846 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_all"} */

  create view "ingest_db"."public"."staging_green_tripdata_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
  select * from "ingest_db"."public"."green_tripdata_2020-01" union all select * from "ingest_db"."public"."green_tripdata_2020-02" union all select * from "ingest_db"."public"."green_tripdata_2020-03" union all select * from "ingest_db"."public"."green_tripdata_2020-04" union all select * from "ingest_db"."public"."green_tripdata_2020-05" union all select * from "ingest_db"."public"."green_tripdata_2020-06" union all select * from "ingest_db"."public"."green_tripdata_2020-07" union all select * from "ingest_db"."public"."green_tripdata_2020-08" union all select * from "ingest_db"."public"."green_tripdata_2020-09" union all select * from "ingest_db"."public"."green_tripdata_2020-10" union all select * from "ingest_db"."public"."green_tripdata_2020-11" union all select * from "ingest_db"."public"."green_tripdata_2020-12"
  select * from "ingest_db"."public"."green_tripdata_2021-01" union all select * from "ingest_db"."public"."green_tripdata_2021-02" union all select * from "ingest_db"."public"."green_tripdata_2021-03" union all select * from "ingest_db"."public"."green_tripdata_2021-04" union all select * from "ingest_db"."public"."green_tripdata_2021-05" union all select * from "ingest_db"."public"."green_tripdata_2021-06" union all select * from "ingest_db"."public"."green_tripdata_2021-07" union all select * from "ingest_db"."public"."green_tripdata_2021-08" union all select * from "ingest_db"."public"."green_tripdata_2021-09" union all select * from "ingest_db"."public"."green_tripdata_2021-10" union all select * from "ingest_db"."public"."green_tripdata_2021-11" union all select * from "ingest_db"."public"."green_tripdata_2021-12"
)

select * from combined
  );
[0m15:10:24.534261 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 11:   select * from "ingest_db"."public"."green_tripdata_2020-01...
           ^

[0m15:10:24.537183 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: ROLLBACK
[0m15:10:24.539841 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: Close
[0m15:10:24.548896 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_all (models/staging/staging_green_tripdata_all.sql)
  syntax error at or near "select"
  LINE 11:   select * from "ingest_db"."public"."green_tripdata_2020-01...
             ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_all.sql
[0m15:10:24.553426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b41ebc7-8a48-43ba-badc-0b6acd7a4b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d26bbc0e0>]}
[0m15:10:24.556044 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_green_tripdata_all ......... [[31mERROR[0m in 0.14s]
[0m15:10:24.558391 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_all
[0m15:10:24.560513 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_all (models/staging/staging_green_tripdata_all.sql)
  syntax error at or near "select"
  LINE 11:   select * from "ingest_db"."public"."green_tripdata_2020-01...
             ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_all.sql.
[0m15:10:24.564753 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:24.566725 [debug] [MainThread]: On master: BEGIN
[0m15:10:24.568662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:24.578050 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:10:24.580584 [debug] [MainThread]: On master: COMMIT
[0m15:10:24.582781 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:24.584553 [debug] [MainThread]: On master: COMMIT
[0m15:10:24.587790 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:10:24.590003 [debug] [MainThread]: On master: Close
[0m15:10:24.592050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:24.593941 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_all' was properly closed.
[0m15:10:24.595725 [info ] [MainThread]: 
[0m15:10:24.597258 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:10:24.598986 [debug] [MainThread]: Command end result
[0m15:10:24.694946 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:10:24.707718 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:10:24.727008 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m15:10:24.729318 [info ] [MainThread]: 
[0m15:10:24.730765 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:10:24.732211 [info ] [MainThread]: 
[0m15:10:24.734038 [error] [MainThread]:   Database Error in model staging_green_tripdata_all (models/staging/staging_green_tripdata_all.sql)
  syntax error at or near "select"
  LINE 11:   select * from "ingest_db"."public"."green_tripdata_2020-01...
             ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_all.sql
[0m15:10:24.735348 [info ] [MainThread]: 
[0m15:10:24.737055 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:10:24.739572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6211798, "process_in_blocks": "48", "process_kernel_time": 0.192717, "process_mem_max_rss": "114184", "process_out_blocks": "0", "process_user_time": 2.86033}
[0m15:10:24.742070 [debug] [MainThread]: Command `dbt run` failed at 15:10:24.741874 after 3.62 seconds
[0m15:10:24.743751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2ae61bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d28568920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d28501d60>]}
[0m15:10:24.745785 [debug] [MainThread]: Flushing usage events
[0m15:10:25.795881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:43.621240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7142b38920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7144639370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71423be540>]}


============================== 15:12:43.625748 | e07ac9a9-8e10-414a-abc8-811ee8436f6d ==============================
[0m15:12:43.625748 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:12:43.627495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging_green_tripdata_all', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:12:43.842445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e07ac9a9-8e10-414a-abc8-811ee8436f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7141fcf980>]}
[0m15:12:43.923554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e07ac9a9-8e10-414a-abc8-811ee8436f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7142ad4620>]}
[0m15:12:43.926695 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:12:44.043730 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:12:45.335718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:45.336639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:45.343058 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m15:12:45.403253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e07ac9a9-8e10-414a-abc8-811ee8436f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7140628410>]}
[0m15:12:45.593248 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:12:45.605562 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:12:45.643042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e07ac9a9-8e10-414a-abc8-811ee8436f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71402b3a70>]}
[0m15:12:45.646120 [info ] [MainThread]: Found 3 data tests, 1 seed, 3 models, 36 sources, 553 macros
[0m15:12:45.648183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07ac9a9-8e10-414a-abc8-811ee8436f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714062a780>]}
[0m15:12:45.652024 [info ] [MainThread]: 
[0m15:12:45.653398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:45.655025 [info ] [MainThread]: 
[0m15:12:45.657788 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:12:45.662986 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m15:12:45.704720 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m15:12:45.707446 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m15:12:45.709411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:45.719255 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m15:12:45.723544 [debug] [ThreadPool]: On list_ingest_db: Close
[0m15:12:45.734927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m15:12:45.749620 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m15:12:45.752803 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m15:12:45.754994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:45.766518 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:12:45.771745 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m15:12:45.774095 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:12:45.779030 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.002 seconds
[0m15:12:45.782600 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m15:12:45.784985 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m15:12:45.795904 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.798311 [debug] [MainThread]: On master: BEGIN
[0m15:12:45.800791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:45.808937 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:12:45.811363 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.814715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:12:45.830990 [debug] [MainThread]: SQL status: SELECT 12 in 0.014 seconds
[0m15:12:45.841410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07ac9a9-8e10-414a-abc8-811ee8436f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71402c0140>]}
[0m15:12:45.844791 [debug] [MainThread]: On master: ROLLBACK
[0m15:12:45.848308 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.851159 [debug] [MainThread]: On master: BEGIN
[0m15:12:45.854964 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:12:45.857967 [debug] [MainThread]: On master: COMMIT
[0m15:12:45.860616 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.863226 [debug] [MainThread]: On master: COMMIT
[0m15:12:45.866362 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:12:45.869805 [debug] [MainThread]: On master: Close
[0m15:12:45.875369 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_all
[0m15:12:45.879058 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_green_tripdata_all .................. [RUN]
[0m15:12:45.884920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_all)
[0m15:12:45.890339 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_all
[0m15:12:45.915090 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_all"
[0m15:12:45.939051 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_all
[0m15:12:45.978423 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_all"
[0m15:12:46.009380 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:12:46.011829 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: BEGIN
[0m15:12:46.014433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:46.023386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:12:46.026033 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:12:46.028634 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_all"} */

  create view "ingest_db"."public"."staging_green_tripdata_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
  select * from "ingest_db"."public"."green_tripdata_2020-01" union all select * from "ingest_db"."public"."green_tripdata_2020-02" union all select * from "ingest_db"."public"."green_tripdata_2020-03" union all select * from "ingest_db"."public"."green_tripdata_2020-04" union all select * from "ingest_db"."public"."green_tripdata_2020-05" union all select * from "ingest_db"."public"."green_tripdata_2020-06" union all select * from "ingest_db"."public"."green_tripdata_2020-07" union all select * from "ingest_db"."public"."green_tripdata_2020-08" union all select * from "ingest_db"."public"."green_tripdata_2020-09" union all select * from "ingest_db"."public"."green_tripdata_2020-10" union all select * from "ingest_db"."public"."green_tripdata_2020-11" union all select * from "ingest_db"."public"."green_tripdata_2020-12"
  select * from "ingest_db"."public"."green_tripdata_2021-01" union all select * from "ingest_db"."public"."green_tripdata_2021-02" union all select * from "ingest_db"."public"."green_tripdata_2021-03" union all select * from "ingest_db"."public"."green_tripdata_2021-04" union all select * from "ingest_db"."public"."green_tripdata_2021-05" union all select * from "ingest_db"."public"."green_tripdata_2021-06" union all select * from "ingest_db"."public"."green_tripdata_2021-07" union all select * from "ingest_db"."public"."green_tripdata_2021-08" union all select * from "ingest_db"."public"."green_tripdata_2021-09" union all select * from "ingest_db"."public"."green_tripdata_2021-10" union all select * from "ingest_db"."public"."green_tripdata_2021-11" union all select * from "ingest_db"."public"."green_tripdata_2021-12"
)

select * from combined
  );
[0m15:12:46.031826 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 11:   select * from "ingest_db"."public"."green_tripdata_2020-01...
           ^

[0m15:12:46.034268 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: ROLLBACK
[0m15:12:46.037354 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: Close
[0m15:12:46.042744 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_all (models/staging/staging_green_tripdata_all.sql)
  syntax error at or near "select"
  LINE 11:   select * from "ingest_db"."public"."green_tripdata_2020-01...
             ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_all.sql
[0m15:12:46.046531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07ac9a9-8e10-414a-abc8-811ee8436f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71402e5220>]}
[0m15:12:46.049666 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_green_tripdata_all ......... [[31mERROR[0m in 0.16s]
[0m15:12:46.052052 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_all
[0m15:12:46.054671 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_all (models/staging/staging_green_tripdata_all.sql)
  syntax error at or near "select"
  LINE 11:   select * from "ingest_db"."public"."green_tripdata_2020-01...
             ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_all.sql.
[0m15:12:46.058789 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:46.060981 [debug] [MainThread]: On master: BEGIN
[0m15:12:46.063476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:46.071708 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:12:46.074058 [debug] [MainThread]: On master: COMMIT
[0m15:12:46.076128 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:46.078321 [debug] [MainThread]: On master: COMMIT
[0m15:12:46.080900 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:12:46.083080 [debug] [MainThread]: On master: Close
[0m15:12:46.085470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:46.087701 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_all' was properly closed.
[0m15:12:46.089730 [info ] [MainThread]: 
[0m15:12:46.092076 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m15:12:46.094238 [debug] [MainThread]: Command end result
[0m15:12:46.243562 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:12:46.270777 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:12:46.292398 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m15:12:46.294164 [info ] [MainThread]: 
[0m15:12:46.296460 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:12:46.298140 [info ] [MainThread]: 
[0m15:12:46.299550 [error] [MainThread]:   Database Error in model staging_green_tripdata_all (models/staging/staging_green_tripdata_all.sql)
  syntax error at or near "select"
  LINE 11:   select * from "ingest_db"."public"."green_tripdata_2020-01...
             ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_all.sql
[0m15:12:46.300792 [info ] [MainThread]: 
[0m15:12:46.302355 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:12:46.304979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8057618, "process_in_blocks": "0", "process_kernel_time": 0.143221, "process_mem_max_rss": "108872", "process_out_blocks": "0", "process_user_time": 2.373381}
[0m15:12:46.306605 [debug] [MainThread]: Command `dbt run` failed at 15:12:46.306377 after 2.81 seconds
[0m15:12:46.308589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71423d6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7142b38920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7140628170>]}
[0m15:12:46.311235 [debug] [MainThread]: Flushing usage events
[0m15:12:47.243120 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:26.810455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562efffe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562ed81bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562efff740>]}


============================== 15:14:26.814351 | bd28af42-4042-42f3-924d-b295317de153 ==============================
[0m15:14:26.814351 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:14:26.815667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging_green_tripdata_all', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:14:27.014676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd28af42-4042-42f3-924d-b295317de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562f184470>]}
[0m15:14:27.083282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd28af42-4042-42f3-924d-b295317de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562ea6f8c0>]}
[0m15:14:27.086332 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:14:27.223144 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:14:30.984707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:30.985919 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/staging/staging_green_tripdata_all.sql
[0m15:14:31.303535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m15:14:31.331419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd28af42-4042-42f3-924d-b295317de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562cb15c40>]}
[0m15:14:31.512060 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:14:31.578095 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:14:31.714041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd28af42-4042-42f3-924d-b295317de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562c953080>]}
[0m15:14:31.725837 [info ] [MainThread]: Found 3 data tests, 1 seed, 3 models, 36 sources, 553 macros
[0m15:14:31.735672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd28af42-4042-42f3-924d-b295317de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562c8bab70>]}
[0m15:14:31.750068 [info ] [MainThread]: 
[0m15:14:31.757661 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:31.764140 [info ] [MainThread]: 
[0m15:14:31.771115 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:31.778926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m15:14:31.842158 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m15:14:31.844334 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m15:14:31.846755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:31.859920 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m15:14:31.862579 [debug] [ThreadPool]: On list_ingest_db: Close
[0m15:14:31.868872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m15:14:31.877155 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m15:14:31.878497 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m15:14:31.879545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:31.885535 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:14:31.887191 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m15:14:31.888267 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:14:31.892233 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.003 seconds
[0m15:14:31.895362 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m15:14:31.896865 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m15:14:31.908749 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:31.910051 [debug] [MainThread]: On master: BEGIN
[0m15:14:31.911006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:31.917278 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:14:31.918630 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:31.919755 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:31.930939 [debug] [MainThread]: SQL status: SELECT 12 in 0.010 seconds
[0m15:14:31.936176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd28af42-4042-42f3-924d-b295317de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562ca11d00>]}
[0m15:14:31.939604 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:31.943378 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:31.947340 [debug] [MainThread]: On master: BEGIN
[0m15:14:31.951999 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:14:31.956615 [debug] [MainThread]: On master: COMMIT
[0m15:14:31.961426 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:31.966236 [debug] [MainThread]: On master: COMMIT
[0m15:14:31.972565 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:14:31.978479 [debug] [MainThread]: On master: Close
[0m15:14:31.991833 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_all
[0m15:14:32.000086 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_green_tripdata_all .................. [RUN]
[0m15:14:32.008746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_all)
[0m15:14:32.015361 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_all
[0m15:14:32.048600 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:32.116781 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_all
[0m15:14:32.178524 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:32.204596 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:32.206583 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: BEGIN
[0m15:14:32.208319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:32.216818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:14:32.227786 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:32.251516 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_all"} */

  create view "ingest_db"."public"."staging_green_tripdata_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
  union all
  select * from "ingest_db"."public"."green_tripdata_2020-01" union all select * from "ingest_db"."public"."green_tripdata_2020-02" union all select * from "ingest_db"."public"."green_tripdata_2020-03" union all select * from "ingest_db"."public"."green_tripdata_2020-04" union all select * from "ingest_db"."public"."green_tripdata_2020-05" union all select * from "ingest_db"."public"."green_tripdata_2020-06" union all select * from "ingest_db"."public"."green_tripdata_2020-07" union all select * from "ingest_db"."public"."green_tripdata_2020-08" union all select * from "ingest_db"."public"."green_tripdata_2020-09" union all select * from "ingest_db"."public"."green_tripdata_2020-10" union all select * from "ingest_db"."public"."green_tripdata_2020-11" union all select * from "ingest_db"."public"."green_tripdata_2020-12"
    union all
  select * from "ingest_db"."public"."green_tripdata_2021-01" union all select * from "ingest_db"."public"."green_tripdata_2021-02" union all select * from "ingest_db"."public"."green_tripdata_2021-03" union all select * from "ingest_db"."public"."green_tripdata_2021-04" union all select * from "ingest_db"."public"."green_tripdata_2021-05" union all select * from "ingest_db"."public"."green_tripdata_2021-06" union all select * from "ingest_db"."public"."green_tripdata_2021-07" union all select * from "ingest_db"."public"."green_tripdata_2021-08" union all select * from "ingest_db"."public"."green_tripdata_2021-09" union all select * from "ingest_db"."public"."green_tripdata_2021-10" union all select * from "ingest_db"."public"."green_tripdata_2021-11" union all select * from "ingest_db"."public"."green_tripdata_2021-12"
)

select * from combined
  );
[0m15:14:32.268092 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.green_tripdata_2021-08" does not exist
LINE 14: ...."green_tripdata_2021-07" union all select * from "ingest_db...
                                                              ^

[0m15:14:32.274290 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: ROLLBACK
[0m15:14:32.282946 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: Close
[0m15:14:32.303979 [debug] [Thread-1 (]: Database Error in model staging_green_tripdata_all (models/staging/staging_green_tripdata_all.sql)
  relation "public.green_tripdata_2021-08" does not exist
  LINE 14: ...."green_tripdata_2021-07" union all select * from "ingest_db...
                                                                ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_all.sql
[0m15:14:32.311792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd28af42-4042-42f3-924d-b295317de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562f321e20>]}
[0m15:14:32.315872 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging_green_tripdata_all ......... [[31mERROR[0m in 0.30s]
[0m15:14:32.320467 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_all
[0m15:14:32.323120 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.staging_green_tripdata_all' to be skipped because of status 'error'.  Reason: Database Error in model staging_green_tripdata_all (models/staging/staging_green_tripdata_all.sql)
  relation "public.green_tripdata_2021-08" does not exist
  LINE 14: ...."green_tripdata_2021-07" union all select * from "ingest_db...
                                                                ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_all.sql.
[0m15:14:32.327575 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:32.329162 [debug] [MainThread]: On master: BEGIN
[0m15:14:32.330849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:32.337275 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:14:32.338851 [debug] [MainThread]: On master: COMMIT
[0m15:14:32.347314 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:32.350661 [debug] [MainThread]: On master: COMMIT
[0m15:14:32.353030 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:14:32.355736 [debug] [MainThread]: On master: Close
[0m15:14:32.360643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:32.361772 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_all' was properly closed.
[0m15:14:32.363237 [info ] [MainThread]: 
[0m15:14:32.364781 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m15:14:32.367289 [debug] [MainThread]: Command end result
[0m15:14:32.459814 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:14:32.483206 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:14:32.509020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m15:14:32.511422 [info ] [MainThread]: 
[0m15:14:32.513543 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:14:32.515479 [info ] [MainThread]: 
[0m15:14:32.517402 [error] [MainThread]:   Database Error in model staging_green_tripdata_all (models/staging/staging_green_tripdata_all.sql)
  relation "public.green_tripdata_2021-08" does not exist
  LINE 14: ...."green_tripdata_2021-07" union all select * from "ingest_db...
                                                                ^
  compiled code at target/run/my_dbt_project/models/staging/staging_green_tripdata_all.sql
[0m15:14:32.518970 [info ] [MainThread]: 
[0m15:14:32.521503 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:14:32.524895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.8208356, "process_in_blocks": "0", "process_kernel_time": 0.36083, "process_mem_max_rss": "114116", "process_out_blocks": "0", "process_user_time": 2.623334}
[0m15:14:32.527540 [debug] [MainThread]: Command `dbt run` failed at 15:14:32.527202 after 5.82 seconds
[0m15:14:32.530608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562ebfd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562c9b50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f562c8bf950>]}
[0m15:14:32.533195 [debug] [MainThread]: Flushing usage events
[0m15:14:33.466149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:47.557165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0b7bb9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0c653f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0b9873b0>]}


============================== 15:14:47.565570 | adea13cf-26dc-4fe9-9fec-cfe8823d9ff3 ==============================
[0m15:14:47.565570 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:14:47.569291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging_green_tripdata_all', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:14:47.809855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adea13cf-26dc-4fe9-9fec-cfe8823d9ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0b61daf0>]}
[0m15:14:47.879515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adea13cf-26dc-4fe9-9fec-cfe8823d9ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0ba2fe60>]}
[0m15:14:47.881103 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:14:48.048559 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:14:49.223973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:49.225276 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/staging/staging_green_tripdata_all.sql
[0m15:14:49.543592 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m15:14:49.561045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adea13cf-26dc-4fe9-9fec-cfe8823d9ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d09967830>]}
[0m15:14:49.755939 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:14:49.764090 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:14:49.798675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adea13cf-26dc-4fe9-9fec-cfe8823d9ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d099b28a0>]}
[0m15:14:49.800635 [info ] [MainThread]: Found 3 data tests, 1 seed, 3 models, 36 sources, 553 macros
[0m15:14:49.801856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adea13cf-26dc-4fe9-9fec-cfe8823d9ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d09ccc950>]}
[0m15:14:49.805341 [info ] [MainThread]: 
[0m15:14:49.806989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:49.809331 [info ] [MainThread]: 
[0m15:14:49.811613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:49.813539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m15:14:49.852020 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m15:14:49.854649 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m15:14:49.856979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:49.868386 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m15:14:49.871804 [debug] [ThreadPool]: On list_ingest_db: Close
[0m15:14:49.879277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m15:14:49.887403 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m15:14:49.889826 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m15:14:49.892283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:49.903349 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:14:49.907159 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m15:14:49.911119 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:14:49.920034 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.005 seconds
[0m15:14:49.927466 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m15:14:49.931006 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m15:14:49.954678 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:49.957718 [debug] [MainThread]: On master: BEGIN
[0m15:14:49.961181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:49.974304 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:14:49.976886 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:49.979236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:49.995340 [debug] [MainThread]: SQL status: SELECT 12 in 0.013 seconds
[0m15:14:50.003633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adea13cf-26dc-4fe9-9fec-cfe8823d9ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdb279040>]}
[0m15:14:50.006946 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:50.010869 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:50.014474 [debug] [MainThread]: On master: BEGIN
[0m15:14:50.019476 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:14:50.023090 [debug] [MainThread]: On master: COMMIT
[0m15:14:50.026546 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:50.029861 [debug] [MainThread]: On master: COMMIT
[0m15:14:50.033857 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:14:50.036956 [debug] [MainThread]: On master: Close
[0m15:14:50.043748 [debug] [Thread-1 (]: Began running node model.my_dbt_project.staging_green_tripdata_all
[0m15:14:50.047065 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging_green_tripdata_all .................. [RUN]
[0m15:14:50.050713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.staging_green_tripdata_all)
[0m15:14:50.053188 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.staging_green_tripdata_all
[0m15:14:50.066552 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:50.078415 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.staging_green_tripdata_all
[0m15:14:50.122329 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:50.152446 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:50.156666 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: BEGIN
[0m15:14:50.160822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:50.173345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:14:50.176525 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:50.179690 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_all"} */

  create view "ingest_db"."public"."staging_green_tripdata_all__dbt_tmp"
    
    
  as (
    

with combined as (
  select * from "ingest_db"."public"."green_tripdata_2019-01" union all select * from "ingest_db"."public"."green_tripdata_2019-02" union all select * from "ingest_db"."public"."green_tripdata_2019-03" union all select * from "ingest_db"."public"."green_tripdata_2019-04" union all select * from "ingest_db"."public"."green_tripdata_2019-05" union all select * from "ingest_db"."public"."green_tripdata_2019-06" union all select * from "ingest_db"."public"."green_tripdata_2019-07" union all select * from "ingest_db"."public"."green_tripdata_2019-08" union all select * from "ingest_db"."public"."green_tripdata_2019-09" union all select * from "ingest_db"."public"."green_tripdata_2019-10" union all select * from "ingest_db"."public"."green_tripdata_2019-11" union all select * from "ingest_db"."public"."green_tripdata_2019-12"
  union all
  select * from "ingest_db"."public"."green_tripdata_2020-01" union all select * from "ingest_db"."public"."green_tripdata_2020-02" union all select * from "ingest_db"."public"."green_tripdata_2020-03" union all select * from "ingest_db"."public"."green_tripdata_2020-04" union all select * from "ingest_db"."public"."green_tripdata_2020-05" union all select * from "ingest_db"."public"."green_tripdata_2020-06" union all select * from "ingest_db"."public"."green_tripdata_2020-07" union all select * from "ingest_db"."public"."green_tripdata_2020-08" union all select * from "ingest_db"."public"."green_tripdata_2020-09" union all select * from "ingest_db"."public"."green_tripdata_2020-10" union all select * from "ingest_db"."public"."green_tripdata_2020-11" union all select * from "ingest_db"."public"."green_tripdata_2020-12"
    union all
  select * from "ingest_db"."public"."green_tripdata_2021-01" union all select * from "ingest_db"."public"."green_tripdata_2021-02" union all select * from "ingest_db"."public"."green_tripdata_2021-03" union all select * from "ingest_db"."public"."green_tripdata_2021-04" union all select * from "ingest_db"."public"."green_tripdata_2021-05" union all select * from "ingest_db"."public"."green_tripdata_2021-06" union all select * from "ingest_db"."public"."green_tripdata_2021-07"
)

select * from combined
  );
[0m15:14:50.235390 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m15:14:50.263163 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:50.265896 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_all"} */
alter table "ingest_db"."public"."staging_green_tripdata_all__dbt_tmp" rename to "staging_green_tripdata_all"
[0m15:14:50.271395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:14:50.310374 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: COMMIT
[0m15:14:50.313052 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:50.316962 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: COMMIT
[0m15:14:50.324235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:14:50.335907 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public"."staging_green_tripdata_all__dbt_backup"
[0m15:14:50.344207 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.staging_green_tripdata_all"
[0m15:14:50.346797 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.staging_green_tripdata_all"} */
drop view if exists "ingest_db"."public"."staging_green_tripdata_all__dbt_backup" cascade
[0m15:14:50.349397 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:14:50.354071 [debug] [Thread-1 (]: On model.my_dbt_project.staging_green_tripdata_all: Close
[0m15:14:50.358729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adea13cf-26dc-4fe9-9fec-cfe8823d9ff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0d472a20>]}
[0m15:14:50.361052 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.staging_green_tripdata_all ............. [[32mCREATE VIEW[0m in 0.31s]
[0m15:14:50.363719 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.staging_green_tripdata_all
[0m15:14:50.366426 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:50.367408 [debug] [MainThread]: On master: BEGIN
[0m15:14:50.368329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:50.374081 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:14:50.376436 [debug] [MainThread]: On master: COMMIT
[0m15:14:50.377156 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:50.377791 [debug] [MainThread]: On master: COMMIT
[0m15:14:50.378589 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:14:50.379348 [debug] [MainThread]: On master: Close
[0m15:14:50.380152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:50.381643 [debug] [MainThread]: Connection 'model.my_dbt_project.staging_green_tripdata_all' was properly closed.
[0m15:14:50.384289 [info ] [MainThread]: 
[0m15:14:50.385516 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m15:14:50.388424 [debug] [MainThread]: Command end result
[0m15:14:50.504917 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m15:14:50.522210 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m15:14:50.557065 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m15:14:50.558368 [info ] [MainThread]: 
[0m15:14:50.560210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:50.561850 [info ] [MainThread]: 
[0m15:14:50.563259 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:14:50.565550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1679819, "process_in_blocks": "0", "process_kernel_time": 0.172683, "process_mem_max_rss": "111356", "process_out_blocks": "0", "process_user_time": 2.712146}
[0m15:14:50.567589 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:50.567405 after 3.17 seconds
[0m15:14:50.569387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0bbbc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d09cccf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0c127860>]}
[0m15:14:50.571087 [debug] [MainThread]: Flushing usage events
[0m15:14:51.527244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:15.486944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ab4aa450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ab908cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8abbc7500>]}


============================== 08:39:15.525457 | df5c29dd-0620-4b4e-a1f5-47abdba8b17d ==============================
[0m08:39:15.525457 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:39:15.535931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts_green_tripdata_all', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:39:16.162019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df5c29dd-0620-4b4e-a1f5-47abdba8b17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8aae4f740>]}
[0m08:39:16.342760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df5c29dd-0620-4b4e-a1f5-47abdba8b17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ad19fa10>]}
[0m08:39:16.348748 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:39:16.633000 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:39:20.076642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m08:39:20.078096 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models/marts/marts_green_tripdata_summary_all.sql
[0m08:39:20.079172 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://macros/tripdata_summary.sql
[0m08:39:20.080548 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/schema.yml
[0m08:39:20.081609 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models/marts/marts_green_tripdata_summary_2019.sql
[0m08:39:20.748192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m08:39:20.771588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df5c29dd-0620-4b4e-a1f5-47abdba8b17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8a91b1ee0>]}
[0m08:39:21.144158 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m08:39:21.158222 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m08:39:21.224389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df5c29dd-0620-4b4e-a1f5-47abdba8b17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8a80da780>]}
[0m08:39:21.226794 [info ] [MainThread]: Found 3 data tests, 1 seed, 4 models, 36 sources, 554 macros
[0m08:39:21.228888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df5c29dd-0620-4b4e-a1f5-47abdba8b17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8a916dca0>]}
[0m08:39:21.231180 [warn ] [MainThread]: The selection criterion 'marts_green_tripdata_all' does not match any enabled nodes
[0m08:39:21.234085 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:39:21.235947 [debug] [MainThread]: Command end result
[0m08:39:21.451551 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m08:39:21.470813 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m08:39:21.489506 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m08:39:21.498413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3897357, "process_in_blocks": "10168", "process_kernel_time": 0.361833, "process_mem_max_rss": "106440", "process_out_blocks": "0", "process_user_time": 4.492767}
[0m08:39:21.502408 [debug] [MainThread]: Command `dbt run` succeeded at 08:39:21.502072 after 6.39 seconds
[0m08:39:21.505870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ab175400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8abbd7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ae6fa990>]}
[0m08:39:21.509517 [debug] [MainThread]: Flushing usage events
[0m08:39:22.575245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:42.700872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb659f53650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65b364860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb659589b80>]}


============================== 08:39:42.707405 | 27a4702d-bfe9-4c13-b939-e2ee1a4bb088 ==============================
[0m08:39:42.707405 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:39:42.710812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts_green_tripdata_summary_all', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:39:43.269144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27a4702d-bfe9-4c13-b939-e2ee1a4bb088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65b0cf920>]}
[0m08:39:43.366444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27a4702d-bfe9-4c13-b939-e2ee1a4bb088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6592874d0>]}
[0m08:39:43.370040 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:39:43.646291 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:39:52.172436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:39:52.177682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:39:52.203874 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m08:39:52.344890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27a4702d-bfe9-4c13-b939-e2ee1a4bb088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657b1eba0>]}
[0m08:39:52.755804 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m08:39:52.810801 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m08:39:52.916803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27a4702d-bfe9-4c13-b939-e2ee1a4bb088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6576bec60>]}
[0m08:39:52.924566 [info ] [MainThread]: Found 3 data tests, 1 seed, 4 models, 36 sources, 554 macros
[0m08:39:52.939490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27a4702d-bfe9-4c13-b939-e2ee1a4bb088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb659285ee0>]}
[0m08:39:52.958103 [info ] [MainThread]: 
[0m08:39:52.965045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:39:52.973147 [info ] [MainThread]: 
[0m08:39:52.979328 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:39:52.983503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ingest_db'
[0m08:39:53.076394 [debug] [ThreadPool]: Using postgres connection "list_ingest_db"
[0m08:39:53.079114 [debug] [ThreadPool]: On list_ingest_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db"} */

    select distinct nspname from pg_namespace
  
[0m08:39:53.081707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:53.124794 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m08:39:53.132323 [debug] [ThreadPool]: On list_ingest_db: Close
[0m08:39:53.166339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ingest_db, now list_ingest_db_public)
[0m08:39:53.216077 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m08:39:53.224141 [debug] [ThreadPool]: On list_ingest_db_public: BEGIN
[0m08:39:53.231612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:39:53.258397 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m08:39:53.263621 [debug] [ThreadPool]: Using postgres connection "list_ingest_db_public"
[0m08:39:53.266949 [debug] [ThreadPool]: On list_ingest_db_public: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_ingest_db_public"} */
select
      'ingest_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ingest_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:39:53.295033 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.024 seconds
[0m08:39:53.306491 [debug] [ThreadPool]: On list_ingest_db_public: ROLLBACK
[0m08:39:53.311328 [debug] [ThreadPool]: On list_ingest_db_public: Close
[0m08:39:53.370223 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:53.376391 [debug] [MainThread]: On master: BEGIN
[0m08:39:53.382363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:53.417417 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m08:39:53.424474 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:53.431817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:39:53.532239 [debug] [MainThread]: SQL status: SELECT 43 in 0.092 seconds
[0m08:39:53.565540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27a4702d-bfe9-4c13-b939-e2ee1a4bb088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65926b350>]}
[0m08:39:53.571166 [debug] [MainThread]: On master: ROLLBACK
[0m08:39:53.577845 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:53.582246 [debug] [MainThread]: On master: BEGIN
[0m08:39:53.588542 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m08:39:53.593783 [debug] [MainThread]: On master: COMMIT
[0m08:39:53.598680 [debug] [MainThread]: Using postgres connection "master"
[0m08:39:53.604647 [debug] [MainThread]: On master: COMMIT
[0m08:39:53.611484 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:39:53.616692 [debug] [MainThread]: On master: Close
[0m08:39:53.637355 [debug] [Thread-1 (]: Began running node model.my_dbt_project.marts_green_tripdata_summary_all
[0m08:39:53.644226 [info ] [Thread-1 (]: 1 of 1 START sql table model public.green_tripdata_summary_all ................. [RUN]
[0m08:39:53.652252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ingest_db_public, now model.my_dbt_project.marts_green_tripdata_summary_all)
[0m08:39:53.661517 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.marts_green_tripdata_summary_all
[0m08:39:53.755380 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.marts_green_tripdata_summary_all"
[0m08:39:53.803773 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.marts_green_tripdata_summary_all
[0m08:39:53.945442 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.marts_green_tripdata_summary_all"
[0m08:39:53.998810 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_all"
[0m08:39:54.008025 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_all: BEGIN
[0m08:39:54.015478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:54.061911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m08:39:54.067055 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_all"
[0m08:39:54.075372 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_all"} */

  
    

  create  table "ingest_db"."public"."green_tripdata_summary_all__dbt_tmp"
  
  
    as
  
  (
    


select
    
coalesce(
  case "VendorID"
    when 1 then 'Creative Mobile Technologies'
    when 2 then 'VeriFone Inc.'
    else 'Other'
  end,
  'Unknown'
)  as vendor_label,
    
  extract(month  from lpep_pickup_datetime) as trip_month,
  extract(quarter from lpep_pickup_datetime) as trip_quarter,
  extract(day    from lpep_pickup_datetime) as trip_day,
  extract(dow    from lpep_pickup_datetime) as trip_weekday,
  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,
  extract(hour   from lpep_pickup_datetime) as trip_hour
,
    
coalesce(
  case payment_type
    when 1 then 'Credit Card'
    when 2 then 'Cash'
    when 3 then 'No Charge'
    when 4 then 'Dispute'
    when 5 then 'Unknown'
    when 6 then 'Voided Trip'
    else 'Other'
  end,
  'Unknown'
)  as payment_type_label,
    
    case
      when avg(trip_distance) <= 2 then 'Short'
      when avg(trip_distance) <= 5 then 'Medium'
      else 'Long'
    end
 as trip_type,
    count(*) as trip_count,
    round(avg(trip_distance)::numeric,2) as avg_distance,
    round(sum(trip_distance)::numeric,2) as total_distance,
    round(avg(fare_amount)::numeric,2) as avg_fare,
    round(sum(fare_amount)::numeric,2) as total_fare,
    round(sum(tip_amount)::numeric,2) as total_tip,
    round(avg(tip_amount)::numeric,2) as avg_tip,
    round(avg(total_amount)::numeric,2) as avg_total,
    round(avg(passenger_count)::numeric,2) as avg_passenger_count,
    count(distinct "PULocationID") as unique_pickup_locations,
    min(lpep_pickup_datetime) as first_trip,
    max(lpep_pickup_datetime) as last_trip,

    -- Peak morning and evening hours using the hour extracted from pickup datetime
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,
    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,
    
    round(
      max(
        case
          when lpep_dropoff_datetime is not null then
            extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime) / 60
          else null
        end
      ), 2
    )
 as trip_duration_minutes,
    -- Calculating average tip rate
    round(
    avg(
        case
            when fare_amount is null or fare_amount = 0 then null
            else cast(tip_amount as float) / fare_amount
        end
    )
::numeric, 2) as tip_rate

from "ingest_db"."public"."staging_green_tripdata_all"
where 
    trip_distance > 0
    AND fare_amount > 0
    AND passenger_count > 0
    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60

group by vendor_label, trip_month, trip_quarter, trip_day,
         trip_weekday, day_type, payment_type_label, trip_hour
order by vendor_label, trip_month, trip_weekday, trip_hour

  );
  
[0m08:41:58.970340 [debug] [Thread-1 (]: SQL status: SELECT 97874 in 124.903 seconds
[0m08:41:58.982572 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_all"
[0m08:41:58.985377 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_all"} */
alter table "ingest_db"."public"."green_tripdata_summary_all__dbt_tmp" rename to "green_tripdata_summary_all"
[0m08:41:58.988973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:41:59.014237 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_all: COMMIT
[0m08:41:59.017231 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_all"
[0m08:41:59.019819 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_all: COMMIT
[0m08:41:59.025577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:41:59.036729 [debug] [Thread-1 (]: Applying DROP to: "ingest_db"."public"."green_tripdata_summary_all__dbt_backup"
[0m08:41:59.045536 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.marts_green_tripdata_summary_all"
[0m08:41:59.047985 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_all: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_dbt_project.marts_green_tripdata_summary_all"} */
drop table if exists "ingest_db"."public"."green_tripdata_summary_all__dbt_backup" cascade
[0m08:41:59.050362 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:41:59.055358 [debug] [Thread-1 (]: On model.my_dbt_project.marts_green_tripdata_summary_all: Close
[0m08:41:59.061098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27a4702d-bfe9-4c13-b939-e2ee1a4bb088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65b0ceb70>]}
[0m08:41:59.063922 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.green_tripdata_summary_all ............ [[32mSELECT 97874[0m in 125.41s]
[0m08:41:59.066781 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.marts_green_tripdata_summary_all
[0m08:41:59.071261 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:59.073280 [debug] [MainThread]: On master: BEGIN
[0m08:41:59.074909 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:41:59.083896 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:41:59.088077 [debug] [MainThread]: On master: COMMIT
[0m08:41:59.092216 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:59.096552 [debug] [MainThread]: On master: COMMIT
[0m08:41:59.103446 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:41:59.110612 [debug] [MainThread]: On master: Close
[0m08:41:59.114601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:59.122345 [debug] [MainThread]: Connection 'model.my_dbt_project.marts_green_tripdata_summary_all' was properly closed.
[0m08:41:59.129561 [info ] [MainThread]: 
[0m08:41:59.136447 [info ] [MainThread]: Finished running 1 table model in 0 hours 2 minutes and 6.15 seconds (126.15s).
[0m08:41:59.146971 [debug] [MainThread]: Command end result
[0m08:41:59.388211 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt/target/manifest.json
[0m08:41:59.449495 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json
[0m08:41:59.514425 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt/target/run_results.json
[0m08:41:59.522008 [info ] [MainThread]: 
[0m08:41:59.530497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:41:59.541227 [info ] [MainThread]: 
[0m08:41:59.551053 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:41:59.570448 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 137.11008, "process_in_blocks": "6024", "process_kernel_time": 0.588978, "process_mem_max_rss": "108644", "process_out_blocks": "0", "process_user_time": 4.589969}
[0m08:41:59.583556 [debug] [MainThread]: Command `dbt run` succeeded at 08:41:59.582590 after 137.12 seconds
[0m08:41:59.593962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65988be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657ae5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb657679160>]}
[0m08:41:59.601578 [debug] [MainThread]: Flushing usage events
[0m08:42:00.664964 [debug] [MainThread]: An error was encountered while trying to flush usage events
