{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-05-02T08:41:59.142519Z", "invocation_id": "27a4702d-bfe9-4c13-b939-e2ee1a4bb088", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-02T08:39:53.667247Z", "completed_at": "2025-05-02T08:39:53.802415Z"}, {"name": "execute", "started_at": "2025-05-02T08:39:53.812756Z", "completed_at": "2025-05-02T08:41:59.055147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 125.4070656299591, "adapter_response": {"_message": "SELECT 97874", "code": "SELECT", "rows_affected": 97874}, "message": "SELECT 97874", "failures": null, "unique_id": "model.my_dbt_project.marts_green_tripdata_summary_all", "compiled": true, "compiled_code": "\n\n\nselect\n    \ncoalesce(\n  case \"VendorID\"\n    when 1 then 'Creative Mobile Technologies'\n    when 2 then 'VeriFone Inc.'\n    else 'Other'\n  end,\n  'Unknown'\n)  as vendor_label,\n    \n  extract(month  from lpep_pickup_datetime) as trip_month,\n  extract(quarter from lpep_pickup_datetime) as trip_quarter,\n  extract(day    from lpep_pickup_datetime) as trip_day,\n  extract(dow    from lpep_pickup_datetime) as trip_weekday,\n  case when extract(dow from lpep_pickup_datetime) in (0,6) then 'Weekend' else 'Weekday' end as day_type,\n  extract(hour   from lpep_pickup_datetime) as trip_hour\n,\n    \ncoalesce(\n  case payment_type\n    when 1 then 'Credit Card'\n    when 2 then 'Cash'\n    when 3 then 'No Charge'\n    when 4 then 'Dispute'\n    when 5 then 'Unknown'\n    when 6 then 'Voided Trip'\n    else 'Other'\n  end,\n  'Unknown'\n)  as payment_type_label,\n    \n    case\n      when avg(trip_distance) <= 2 then 'Short'\n      when avg(trip_distance) <= 5 then 'Medium'\n      else 'Long'\n    end\n as trip_type,\n    count(*) as trip_count,\n    round(avg(trip_distance)::numeric,2) as avg_distance,\n    round(sum(trip_distance)::numeric,2) as total_distance,\n    round(avg(fare_amount)::numeric,2) as avg_fare,\n    round(sum(fare_amount)::numeric,2) as total_fare,\n    round(sum(tip_amount)::numeric,2) as total_tip,\n    round(avg(tip_amount)::numeric,2) as avg_tip,\n    round(avg(total_amount)::numeric,2) as avg_total,\n    round(avg(passenger_count)::numeric,2) as avg_passenger_count,\n    count(distinct \"PULocationID\") as unique_pickup_locations,\n    min(lpep_pickup_datetime) as first_trip,\n    max(lpep_pickup_datetime) as last_trip,\n\n    -- Peak morning and evening hours using the hour extracted from pickup datetime\n    count(*) filter(where extract(hour from lpep_pickup_datetime) between 6 and 9) as peak_morning_hours,\n    count(*) filter(where extract(hour from lpep_pickup_datetime) between 17 and 19) as peak_evening_hours,\n    \n    round(\n      max(\n        case\n          when lpep_dropoff_datetime is not null then\n            extract(epoch from lpep_dropoff_datetime - lpep_pickup_datetime) / 60\n          else null\n        end\n      ), 2\n    )\n as trip_duration_minutes,\n    -- Calculating average tip rate\n    round(\n    avg(\n        case\n            when fare_amount is null or fare_amount = 0 then null\n            else cast(tip_amount as float) / fare_amount\n        end\n    )\n::numeric, 2) as tip_rate\n\nfrom \"ingest_db\".\"public\".\"staging_green_tripdata_all\"\nwhere \n    trip_distance > 0\n    AND fare_amount > 0\n    AND passenger_count > 0\n    AND EXTRACT(EPOCH FROM lpep_dropoff_datetime - lpep_pickup_datetime) > 60\n\ngroup by vendor_label, trip_month, trip_quarter, trip_day,\n         trip_weekday, day_type, payment_type_label, trip_hour\norder by vendor_label, trip_month, trip_weekday, trip_hour\n", "relation_name": "\"ingest_db\".\"public\".\"green_tripdata_summary_all\"", "batch_results": null}], "elapsed_time": 126.15108680725098, "args": {"which": "run", "select": ["marts_green_tripdata_summary_all"], "log_file_max_bytes": 10485760, "show_resource_report": false, "favor_state": false, "introspect": true, "partial_parse_file_diff": true, "version_check": true, "empty": false, "send_anonymous_usage_stats": true, "state_modified_compare_vars": false, "indirect_selection": "eager", "log_level_file": "debug", "vars": {}, "populate_cache": true, "log_format": "default", "project_dir": "/dbt", "require_nested_cumulative_type_params": false, "quiet": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "log_path": "/dbt/logs", "state_modified_compare_more_unrendered_values": false, "exclude": [], "require_resource_names_without_spaces": false, "require_yaml_configuration_for_mf_time_spines": false, "macro_debugging": false, "invocation_command": "dbt run --select marts_green_tripdata_summary_all", "print": true, "printer_width": 80, "write_json": true, "source_freshness_run_project_hooks": false, "static_parser": true, "use_colors": true, "profiles_dir": "/dbt", "require_batched_execution_for_custom_microbatch_strategy": false, "log_level": "info", "strict_mode": false, "cache_selected_only": false, "skip_nodes_if_on_run_start_fails": false, "defer": false, "partial_parse": true, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}}}